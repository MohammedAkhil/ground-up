"use strict";var ie=Object.create;var F=Object.defineProperty;var oe=Object.getOwnPropertyDescriptor;var ce=Object.getOwnPropertyNames;var le=Object.getPrototypeOf,ue=Object.prototype.hasOwnProperty;var fe=(r,n)=>{for(var e in n)F(r,e,{get:n[e],enumerable:!0})},K=(r,n,e,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let a of ce(n))!ue.call(r,a)&&a!==e&&F(r,a,{get:()=>n[a],enumerable:!(t=oe(n,a))||t.enumerable});return r};var N=(r,n,e)=>(e=r!=null?ie(le(r)):{},K(n||!r||!r.__esModule?F(e,"default",{value:r,enumerable:!0}):e,r)),de=r=>K(F({},"__esModule",{value:!0}),r);var Ue={};fe(Ue,{default:()=>ne});module.exports=de(Ue);var l=require("@raycast/api");var s=N(require("react")),d=require("@raycast/api");var H=Object.prototype.hasOwnProperty;function j(r,n){var e,t;if(r===n)return!0;if(r&&n&&(e=r.constructor)===n.constructor){if(e===Date)return r.getTime()===n.getTime();if(e===RegExp)return r.toString()===n.toString();if(e===Array){if((t=r.length)===n.length)for(;t--&&j(r[t],n[t]););return t===-1}if(!e||typeof r=="object"){t=0;for(e in r)if(H.call(r,e)&&++t&&!H.call(n,e)||!(e in n)||!j(r[e],n[e]))return!1;return Object.keys(n).length===t}}return r!==r&&n!==n}var I=N(require("node:fs")),G=N(require("node:path")),q=N(require("node:crypto"));var X=require("react/jsx-runtime");function he(r){let n=(0,s.useRef)(r),e=(0,s.useRef)(0);return j(r,n.current)||(n.current=r,e.current+=1),(0,s.useMemo)(()=>n.current,[e.current])}function x(r){let n=(0,s.useRef)(r);return n.current=r,n}function pe(r,n){let e=r instanceof Error?r.message:String(r);return(0,d.showToast)({style:d.Toast.Style.Failure,title:n?.title??"Something went wrong",message:n?.message??e,primaryAction:n?.primaryAction??J(r),secondaryAction:n?.primaryAction?J(r):void 0})}var J=r=>{let n=!0,e="[Extension Name]...",t="";try{let i=JSON.parse((0,I.readFileSync)((0,G.join)(d.environment.assetsPath,"..","package.json"),"utf8"));e=`[${i.title}]...`,t=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(n=!1)}catch{}let a=d.environment.isDevelopment||n,o=r instanceof Error?r?.stack||r?.message||"":String(r);return{title:a?"Copy Logs":"Report Error",onAction(i){i.hide(),a?d.Clipboard.copy(o):(0,d.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(e)}&extension-url=${encodeURI(t)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${o}
\`\`\`
`)}`)}}};function me(r,n,e){let t=(0,s.useRef)(0),[a,o]=(0,s.useState)({isLoading:!0}),i=x(r),u=x(e?.abortable),c=x(n||[]),b=x(e?.onError),m=x(e?.onData),$=x(e?.onWillExecute),S=x(e?.failureToastOptions),E=x(a.data),k=(0,s.useRef)(null),h=(0,s.useRef)({page:0}),y=(0,s.useRef)(!1),A=(0,s.useRef)(!0),_=(0,s.useRef)(50),w=(0,s.useCallback)(()=>(u.current&&(u.current.current?.abort(),u.current.current=new AbortController),++t.current),[u]),p=(0,s.useCallback)((...P)=>{let v=w();$.current?.(P),o(f=>({...f,isLoading:!0}));let O=ge(i.current)(...P);function D(f){return f.name=="AbortError"||v===t.current&&(b.current?b.current(f):d.environment.launchType!==d.LaunchType.Background&&pe(f,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(C){C.hide(),k.current?.(...c.current||[])}},...S.current}),o({error:f,isLoading:!1})),f}return typeof O=="function"?(y.current=!0,O(h.current).then(({data:f,hasMore:C,cursor:ae})=>(v===t.current&&(h.current&&(h.current.cursor=ae,h.current.lastItem=f?.[f.length-1]),m.current&&m.current(f,h.current),C&&(_.current=f.length),A.current=C,o(se=>h.current.page===0?{data:f,isLoading:!1}:{data:(se.data||[])?.concat(f),isLoading:!1})),f),f=>(A.current=!1,D(f)))):(y.current=!1,O.then(f=>(v===t.current&&(m.current&&m.current(f),o({data:f,isLoading:!1})),f),D))},[m,b,c,i,o,k,$,h,S,w]);k.current=p;let R=(0,s.useCallback)(()=>{h.current={page:0};let P=c.current||[];return p(...P)},[p,c]),T=(0,s.useCallback)(async(P,v)=>{let O;try{if(v?.optimisticUpdate){w(),typeof v?.rollbackOnError!="function"&&v?.rollbackOnError!==!1&&(O=structuredClone(E.current?.value));let D=v.optimisticUpdate;o(f=>({...f,data:D(f.data)}))}return await P}catch(D){if(typeof v?.rollbackOnError=="function"){let f=v.rollbackOnError;o(C=>({...C,data:f(C.data)}))}else v?.optimisticUpdate&&v?.rollbackOnError!==!1&&o(f=>({...f,data:O}));throw D}finally{v?.shouldRevalidateAfter!==!1&&(d.environment.launchType===d.LaunchType.Background||d.environment.commandMode==="menu-bar"?await R():R())}},[R,E,o,w]),U=(0,s.useCallback)(()=>{h.current.page+=1;let P=c.current||[];p(...P)},[h,c,p]);(0,s.useEffect)(()=>{h.current={page:0},e?.execute!==!1?p(...n||[]):w()},[he([n,e?.execute,p]),u,h]),(0,s.useEffect)(()=>()=>{w()},[w]);let L=e?.execute!==!1?a.isLoading:!1,V={...a,isLoading:L},z=y.current?{pageSize:_.current,hasMore:A.current,onLoadMore:U}:void 0;return{...V,revalidate:R,mutate:T,pagination:z}}function ge(r){return r===Promise.all||r===Promise.race||r===Promise.resolve||r===Promise.reject?r.bind(Promise):r}function Z(r){return typeof r!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(r))!==null}function be(r){return r instanceof URLSearchParams?r.toString():r}function Q(r,n=[]){function e(t){return"update"in r?r.update(t,"utf8"):r.write(t)}return{dispatch:function(t){t=be(t),t===null?this._null():this["_"+typeof t](t)},_object:function(t){let a=/\[object (.*)\]/i,o=Object.prototype.toString.call(t),i=a.exec(o)?.[1]??"unknown:["+o+"]";i=i.toLowerCase();let u=null;if((u=n.indexOf(t))>=0){this.dispatch("[CIRCULAR:"+u+"]");return}else n.push(t);if(Buffer.isBuffer(t))return e("buffer:"),e(t.toString("utf8"));if(i!=="object"&&i!=="function"&&i!=="asyncfunction")if(this["_"+i])this["_"+i](t);else throw new Error('Unknown object type "'+i+'"');else{let c=Object.keys(t);c=c.sort(),Z(t)||c.splice(0,0,"prototype","__proto__","constructor"),e("object:"+c.length+":");let b=this;return c.forEach(function(m){b.dispatch(m),e(":"),b.dispatch(t[m]),e(",")})}},_array:function(t,a){a=typeof a<"u"?a:!1;let o=this;if(e("array:"+t.length+":"),!a||t.length<=1){t.forEach(function(c){o.dispatch(c)});return}let i=[],u=t.map(function(c){let b=$e(),m=n.slice();return Q(b,m).dispatch(c),i=i.concat(m.slice(n.length)),b.read().toString()});n=n.concat(i),u.sort(),this._array(u,!1)},_date:function(t){e("date:"+t.toJSON())},_symbol:function(t){e("symbol:"+t.toString())},_error:function(t){e("error:"+t.toString())},_boolean:function(t){e("bool:"+t.toString())},_string:function(t){e("string:"+t.length+":"),e(t.toString())},_function:function(t){e("fn:"),Z(t)?this.dispatch("[native]"):this.dispatch(t.toString()),this.dispatch("function-name:"+String(t.name)),this._object(t)},_number:function(t){e("number:"+t.toString())},_xml:function(t){e("xml:"+t.toString())},_null:function(){e("Null")},_undefined:function(){e("Undefined")},_regexp:function(t){e("regex:"+t.toString())},_uint8array:function(t){e("uint8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint8clampedarray:function(t){e("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(t))},_int8array:function(t){e("int8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint16array:function(t){e("uint16array:"),this.dispatch(Array.prototype.slice.call(t))},_int16array:function(t){e("int16array:"),this.dispatch(Array.prototype.slice.call(t))},_uint32array:function(t){e("uint32array:"),this.dispatch(Array.prototype.slice.call(t))},_int32array:function(t){e("int32array:"),this.dispatch(Array.prototype.slice.call(t))},_float32array:function(t){e("float32array:"),this.dispatch(Array.prototype.slice.call(t))},_float64array:function(t){e("float64array:"),this.dispatch(Array.prototype.slice.call(t))},_arraybuffer:function(t){e("arraybuffer:"),this.dispatch(new Uint8Array(t))},_url:function(t){e("url:"+t.toString())},_map:function(t){e("map:");let a=Array.from(t);this._array(a,!0)},_set:function(t){e("set:");let a=Array.from(t);this._array(a,!0)},_file:function(t){e("file:"),this.dispatch([t.name,t.size,t.type,t.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){e("domwindow")},_bigint:function(t){e("bigint:"+t.toString())},_process:function(){e("process")},_timer:function(){e("timer")},_pipe:function(){e("pipe")},_tcp:function(){e("tcp")},_udp:function(){e("udp")},_tty:function(){e("tty")},_statwatcher:function(){e("statwatcher")},_securecontext:function(){e("securecontext")},_connection:function(){e("connection")},_zlib:function(){e("zlib")},_context:function(){e("context")},_nodescript:function(){e("nodescript")},_httpparser:function(){e("httpparser")},_dataview:function(){e("dataview")},_signal:function(){e("signal")},_fsevent:function(){e("fsevent")},_tlswrap:function(){e("tlswrap")}}}function $e(){return{buf:"",write:function(r){this.buf+=r},end:function(r){this.buf+=r},read:function(){return this.buf}}}function ye(r,n){let e=this[r];return e instanceof Date?`__raycast_cached_date__${e.toString()}`:Buffer.isBuffer(e)?`__raycast_cached_buffer__${e.toString("base64")}`:n}function we(r,n){return typeof n=="string"&&n.startsWith("__raycast_cached_date__")?new Date(n.replace("__raycast_cached_date__","")):typeof n=="string"&&n.startsWith("__raycast_cached_buffer__")?Buffer.from(n.replace("__raycast_cached_buffer__",""),"base64"):n}function B(r){let n=q.default.createHash("sha1");return Q(n).dispatch(r),n.digest("hex")}var ke=Symbol("cache without namespace"),Y=new Map;function xe(r,n,e){let t=e?.cacheNamespace||ke,a=Y.get(t)||Y.set(t,new d.Cache({namespace:e?.cacheNamespace})).get(t);if(!a)throw new Error("Missing cache");let o=x(r),i=x(n),u=(0,s.useSyncExternalStore)(a.subscribe,()=>{try{return a.get(o.current)}catch($){console.error("Could not get Cache data:",$);return}}),c=(0,s.useMemo)(()=>{if(typeof u<"u"){if(u==="undefined")return;try{return JSON.parse(u,we)}catch($){return console.warn("The cached data is corrupted",$),i.current}}else return i.current},[u,i]),b=x(c),m=(0,s.useCallback)($=>{let S=typeof $=="function"?$(b.current):$;if(typeof S>"u")a.set(o.current,"undefined");else{let E=JSON.stringify(S,ye);a.set(o.current,E)}return S},[a,o,b]);return[c,m]}var M=Symbol();function ve(r,n,e){let{initialData:t,keepPreviousData:a,internal_cacheKeySuffix:o,...i}=e||{},u=(0,s.useRef)(null),[c,b]=xe(B(n||[])+o,M,{cacheNamespace:B(r)}),m=(0,s.useRef)(c!==M?c:t),$=(0,s.useRef)(void 0),{mutate:S,revalidate:E,...k}=me(r,n||[],{...i,onData(w,p){$.current=p,i.onData&&i.onData(w,p),!(p&&p.page>0)&&(u.current="promise",m.current=w,b(w))}}),h,y=k.pagination;$.current&&$.current.page>0&&k.data?h=k.data:u.current==="promise"?h=m.current:a&&c!==M?(h=c,y&&(y.hasMore=!0,y.pageSize=c.length)):a&&c===M?h=m.current:c!==M?(h=c,y&&(y.hasMore=!0,y.pageSize=c.length)):h=t;let A=x(h),_=(0,s.useCallback)(async(w,p)=>{let R;try{if(p?.optimisticUpdate){typeof p?.rollbackOnError!="function"&&p?.rollbackOnError!==!1&&(R=structuredClone(A.current));let T=p.optimisticUpdate(A.current);u.current="cache",m.current=T,b(T)}return await S(w,{shouldRevalidateAfter:p?.shouldRevalidateAfter})}catch(T){if(typeof p?.rollbackOnError=="function"){let U=p.rollbackOnError(A.current);u.current="cache",m.current=U,b(U)}else p?.optimisticUpdate&&p?.rollbackOnError!==!1&&(u.current="cache",m.current=R,b(R));throw T}},[b,S,A,m,u]);return(0,s.useEffect)(()=>{c!==M&&(u.current="cache",m.current=c)},[c]),{data:h,isLoading:k.isLoading,error:k.error,mutate:$.current&&$.current.page>0?S:_,pagination:y,revalidate:E}}function Se(r){if(r){let n=Ae(r);if(!n)return!1;if(n.subtype==="json"||n.suffix==="json"||n.suffix&&/\bjson\b/i.test(n.suffix)||n.subtype&&/\bjson\b/i.test(n.subtype))return!0}return!1}var Ee=/^([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126});?$/;function Ae(r){let n=r.indexOf(";"),e=n!==-1?r.slice(0,n).trim():r.trim(),t=Ee.exec(e.toLowerCase().toLowerCase());if(!t)return;let a=t[1],o=t[2],i,u=o.lastIndexOf("+");return u!==-1&&(i=o.substring(u+1),o=o.substring(0,u)),{type:a,subtype:o,suffix:i}}async function Re(r){if(!r.ok)throw new Error(r.statusText);let n=r.headers.get("content-type");return n&&Se(n)?await r.json():await r.text()}function Te(r){return{data:r,hasMore:!1}}function ee(r,n){let{parseResponse:e,mapResult:t,initialData:a,execute:o,keepPreviousData:i,onError:u,onData:c,onWillExecute:b,failureToastOptions:m,...$}=n||{},S={initialData:a,execute:o,keepPreviousData:i,onError:u,onData:c,onWillExecute:b,failureToastOptions:m},E=x(e||Re),k=x(t||Te),h=(0,s.useRef)(null),y=(0,s.useRef)(null),A=typeof r=="function"?r({page:0}):void 0;(!h.current||typeof y.current>"u"||y.current!==A)&&(h.current=r),y.current=A;let _=(0,s.useRef)(null),w=(0,s.useCallback)((T,U)=>async L=>{let V=await fetch(T(L),{signal:_.current?.signal,...U}),z=await E.current(V);return k.current?.(z)},[E,k]),p=(0,s.useCallback)(async(T,U)=>{let L=await fetch(T,{signal:_.current?.signal,...U}),V=await E.current(L);return k.current(V)?.data},[E,k]),R=(0,s.useMemo)(()=>y.current?w:p,[y,p,w]);return ve(R,[h.current,$],{...S,internal_cacheKeySuffix:y.current+B(k.current)+B(E.current),abortable:_})}function te(r){return Buffer.from(r,"utf8").toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}var g=require("react/jsx-runtime"),W={title:"Untitled%201",background:"true",darkMode:"true",padding:"16",language:"auto",snippet:"",color:"candy"},_e="Untitled%201";function ne(){let{data:r}=ee("https://ray.so/api/config"),n=async e=>{if(!e.snippet){await(0,l.showToast)({style:l.Toast.Style.Failure,title:"Missing Code",message:"Code cannot be empty"});return}let t=e.title?e.title.replace(/ /g,"%20"):_e,a=te(e.snippet),o=`https://ray.so/#theme=${e.color}&background=${e.background}&darkMode=${e.darkMode}&padding=${e.padding}&title=${t}&code=${a}&language=${e.language}`;await(0,l.open)(o),(0,l.closeMainWindow)()};return(0,g.jsxs)(l.Form,{actions:(0,g.jsx)(l.ActionPanel,{children:(0,g.jsx)(l.Action.SubmitForm,{title:"Create Snippet",onSubmit:n})}),children:[(0,g.jsx)(l.Form.TextField,{id:"title",title:"Title",placeholder:"Untitled 1"}),(0,g.jsx)(l.Form.TextArea,{id:"snippet",title:"Code",placeholder:"Paste your code here"}),(0,g.jsx)(l.Form.Separator,{}),(0,g.jsxs)(l.Form.Dropdown,{id:"color",title:"Color",storeValue:!0,defaultValue:r?W.color:void 0,isLoading:!r,children:[(0,g.jsx)(l.Form.Dropdown.Section,{title:"Partners",children:r?.themes.map(e=>e.partner&&(0,g.jsx)(l.Form.Dropdown.Item,{icon:{source:`${e.iconUrl}`,tintColor:["vercel","rabbit"].includes(e.id)?l.Color.PrimaryText:void 0,fallback:re(e.background)},value:e.id,title:e.name},e.id))}),r?.themes.map(e=>!e.partner&&(0,g.jsx)(l.Form.Dropdown.Item,{icon:{source:re(e.background)},value:e.id,title:e.name},e.id))]}),(0,g.jsxs)(l.Form.Dropdown,{id:"language",title:"Language",storeValue:!0,defaultValue:W.language,isLoading:!r,children:[(0,g.jsx)(l.Form.Dropdown.Item,{value:"auto",title:"Auto-Detect"}),r?.languages.map((e,t)=>(0,g.jsx)(l.Form.Dropdown.Item,{value:e.id,title:e.name},t))]}),(0,g.jsxs)(l.Form.Dropdown,{id:"background",title:"Background",storeValue:!0,defaultValue:W.background,children:[(0,g.jsx)(l.Form.Dropdown.Item,{value:"true",title:"Yes"}),(0,g.jsx)(l.Form.Dropdown.Item,{value:"false",title:"No"})]}),(0,g.jsxs)(l.Form.Dropdown,{id:"darkMode",title:"Dark Mode",storeValue:!0,defaultValue:W.darkMode,children:[(0,g.jsx)(l.Form.Dropdown.Item,{value:"true",title:"Yes"}),(0,g.jsx)(l.Form.Dropdown.Item,{value:"false",title:"No"})]}),(0,g.jsx)(l.Form.Dropdown,{id:"padding",title:"Padding",storeValue:!0,defaultValue:W.padding,isLoading:!r,children:r?.padding.map((e,t)=>(0,g.jsx)(l.Form.Dropdown.Item,{value:e.toString(),title:e.toString()},t))})]})}function re({from:r,to:n}){let e=`
<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1" viewBox="0 0 24 24" >
  <defs>
    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:${r};" />
      <stop offset="100%" style="stop-color:${n};" />
    </linearGradient>
  </defs>
  <circle cx="12" cy="12" r="12" fill="url(#gradient)" />
</svg>`;return`data:image/svg+xml;base64,${Buffer.from(e,"utf8").toString("base64")}`}
