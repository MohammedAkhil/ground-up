"use strict";var eh=Object.create;var vi=Object.defineProperty;var th=Object.getOwnPropertyDescriptor;var rh=Object.getOwnPropertyNames;var ah=Object.getPrototypeOf,nh=Object.prototype.hasOwnProperty;var ln=(e,t)=>()=>(e&&(t=e(e=0)),t);var ne=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ml=(e,t)=>{for(var a in t)vi(e,a,{get:t[a],enumerable:!0})},vl=(e,t,a,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of rh(t))!nh.call(e,n)&&n!==a&&vi(e,n,{get:()=>t[n],enumerable:!(r=th(t,n))||r.enumerable});return e};var ft=(e,t,a)=>(a=e!=null?eh(ah(e)):{},vl(t||!e||!e.__esModule?vi(a,"default",{value:e,enumerable:!0}):a,e)),ih=e=>vl(vi({},"__esModule",{value:!0}),e);var El=ne((Ci,Sl)=>{(function(e,t){typeof Ci=="object"&&typeof Sl<"u"?t(Ci):typeof define=="function"&&define.amd?define(["exports"],t):(e=typeof globalThis<"u"?globalThis:e||self,t(e.WebStreamsPolyfill={}))})(Ci,function(e){"use strict";let t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:o=>`Symbol(${o})`;function a(){}function r(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let n=r();function i(o){return typeof o=="object"&&o!==null||typeof o=="function"}let s=a,u=Promise,c=Promise.prototype.then,f=Promise.resolve.bind(u),d=Promise.reject.bind(u);function h(o){return new u(o)}function C(o){return f(o)}function E(o){return d(o)}function g(o,l,p){return c.call(o,l,p)}function _(o,l,p){g(g(o,l,p),void 0,s)}function S(o,l){_(o,l)}function b(o,l){_(o,void 0,l)}function A(o,l,p){return g(o,l,p)}function w(o){g(o,void 0,s)}let D=(()=>{let o=n&&n.queueMicrotask;if(typeof o=="function")return o;let l=C(void 0);return p=>g(l,p)})();function k(o,l,p){if(typeof o!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(o,l,p)}function R(o,l,p){try{return C(k(o,l,p))}catch(x){return E(x)}}let G=16384;class q{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(l){let p=this._back,x=p;p._elements.length===G-1&&(x={_elements:[],_next:void 0}),p._elements.push(l),x!==p&&(this._back=x,p._next=x),++this._size}shift(){let l=this._front,p=l,x=this._cursor,N=x+1,U=l._elements,O=U[x];return N===G&&(p=l._next,N=0),--this._size,this._cursor=N,l!==p&&(this._front=p),U[x]=void 0,O}forEach(l){let p=this._cursor,x=this._front,N=x._elements;for(;(p!==N.length||x._next!==void 0)&&!(p===N.length&&(x=x._next,N=x._elements,p=0,N.length===0));)l(N[p]),++p}peek(){let l=this._front,p=this._cursor;return l._elements[p]}}function Y(o,l){o._ownerReadableStream=l,l._reader=o,l._state==="readable"?xe(o):l._state==="closed"?Te(o):De(o,l._storedError)}function H(o,l){let p=o._ownerReadableStream;return Ht(p,l)}function ae(o){o._ownerReadableStream._state==="readable"?Ue(o,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):Z(o,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),o._ownerReadableStream._reader=void 0,o._ownerReadableStream=void 0}function K(o){return new TypeError("Cannot "+o+" a stream using a released reader")}function xe(o){o._closedPromise=h((l,p)=>{o._closedPromise_resolve=l,o._closedPromise_reject=p})}function De(o,l){xe(o),Ue(o,l)}function Te(o){xe(o),$t(o)}function Ue(o,l){o._closedPromise_reject!==void 0&&(w(o._closedPromise),o._closedPromise_reject(l),o._closedPromise_resolve=void 0,o._closedPromise_reject=void 0)}function Z(o,l){De(o,l)}function $t(o){o._closedPromise_resolve!==void 0&&(o._closedPromise_resolve(void 0),o._closedPromise_resolve=void 0,o._closedPromise_reject=void 0)}let fr=t("[[AbortSteps]]"),Ve=t("[[ErrorSteps]]"),Oe=t("[[CancelSteps]]"),qe=t("[[PullSteps]]"),Ge=Number.isFinite||function(o){return typeof o=="number"&&isFinite(o)},Ye=Math.trunc||function(o){return o<0?Math.ceil(o):Math.floor(o)};function Xe(o){return typeof o=="object"||typeof o=="function"}function Ie(o,l){if(o!==void 0&&!Xe(o))throw new TypeError(`${l} is not an object.`)}function Ae(o,l){if(typeof o!="function")throw new TypeError(`${l} is not a function.`)}function Ze(o){return typeof o=="object"&&o!==null||typeof o=="function"}function Qe(o,l){if(!Ze(o))throw new TypeError(`${l} is not an object.`)}function Be(o,l,p){if(o===void 0)throw new TypeError(`Parameter ${l} is required in '${p}'.`)}function Ke(o,l,p){if(o===void 0)throw new TypeError(`${l} is required in '${p}'.`)}function He(o){return Number(o)}function je(o){return o===0?0:o}function Je(o){return je(Ye(o))}function $e(o,l){let x=Number.MAX_SAFE_INTEGER,N=Number(o);if(N=je(N),!Ge(N))throw new TypeError(`${l} is not a finite number`);if(N=Je(N),N<0||N>x)throw new TypeError(`${l} is outside the accepted range of ${0} to ${x}, inclusive`);return!Ge(N)||N===0?0:N}function ms(o,l){if(!Br(o))throw new TypeError(`${l} is not a ReadableStream.`)}function pa(o){return new Qa(o)}function cu(o,l){o._reader._readRequests.push(l)}function vs(o,l,p){let N=o._reader._readRequests.shift();p?N._closeSteps():N._chunkSteps(l)}function qn(o){return o._reader._readRequests.length}function du(o){let l=o._reader;return!(l===void 0||!Tr(l))}class Qa{constructor(l){if(Be(l,1,"ReadableStreamDefaultReader"),ms(l,"First parameter"),wr(l))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Y(this,l),this._readRequests=new q}get closed(){return Tr(this)?this._closedPromise:E(Mn("closed"))}cancel(l=void 0){return Tr(this)?this._ownerReadableStream===void 0?E(K("cancel")):H(this,l):E(Mn("cancel"))}read(){if(!Tr(this))return E(Mn("read"));if(this._ownerReadableStream===void 0)return E(K("read from"));let l,p,x=h((U,O)=>{l=U,p=O});return ja(this,{_chunkSteps:U=>l({value:U,done:!1}),_closeSteps:()=>l({value:void 0,done:!0}),_errorSteps:U=>p(U)}),x}releaseLock(){if(!Tr(this))throw Mn("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ae(this)}}}Object.defineProperties(Qa.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Qa.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function Tr(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_readRequests")?!1:o instanceof Qa}function ja(o,l){let p=o._ownerReadableStream;p._disturbed=!0,p._state==="closed"?l._closeSteps():p._state==="errored"?l._errorSteps(p._storedError):p._readableStreamController[qe](l)}function Mn(o){return new TypeError(`ReadableStreamDefaultReader.prototype.${o} can only be used on a ReadableStreamDefaultReader`)}let hu=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class pu{constructor(l,p){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=l,this._preventCancel=p}next(){let l=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?A(this._ongoingPromise,l,l):l(),this._ongoingPromise}return(l){let p=()=>this._returnSteps(l);return this._ongoingPromise?A(this._ongoingPromise,p,p):p()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let l=this._reader;if(l._ownerReadableStream===void 0)return E(K("iterate"));let p,x,N=h((O,X)=>{p=O,x=X});return ja(l,{_chunkSteps:O=>{this._ongoingPromise=void 0,D(()=>p({value:O,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,ae(l),p({value:void 0,done:!0})},_errorSteps:O=>{this._ongoingPromise=void 0,this._isFinished=!0,ae(l),x(O)}}),N}_returnSteps(l){if(this._isFinished)return Promise.resolve({value:l,done:!0});this._isFinished=!0;let p=this._reader;if(p._ownerReadableStream===void 0)return E(K("finish iterating"));if(!this._preventCancel){let x=H(p,l);return ae(p),A(x,()=>({value:l,done:!0}))}return ae(p),C({value:l,done:!0})}}let yu={next(){return gu(this)?this._asyncIteratorImpl.next():E(mu("next"))},return(o){return gu(this)?this._asyncIteratorImpl.return(o):E(mu("return"))}};hu!==void 0&&Object.setPrototypeOf(yu,hu);function P0(o,l){let p=pa(o),x=new pu(p,l),N=Object.create(yu);return N._asyncIteratorImpl=x,N}function gu(o){if(!i(o)||!Object.prototype.hasOwnProperty.call(o,"_asyncIteratorImpl"))return!1;try{return o._asyncIteratorImpl instanceof pu}catch{return!1}}function mu(o){return new TypeError(`ReadableStreamAsyncIterator.${o} can only be used on a ReadableSteamAsyncIterator`)}let vu=Number.isNaN||function(o){return o!==o};function $a(o){return o.slice()}function Cu(o,l,p,x,N){new Uint8Array(o).set(new Uint8Array(p,x,N),l)}function _m(o){return o}function Kn(o){return!1}function Su(o,l,p){if(o.slice)return o.slice(l,p);let x=p-l,N=new ArrayBuffer(x);return Cu(N,0,o,l,x),N}function U0(o){return!(typeof o!="number"||vu(o)||o<0)}function Eu(o){let l=Su(o.buffer,o.byteOffset,o.byteOffset+o.byteLength);return new Uint8Array(l)}function Cs(o){let l=o._queue.shift();return o._queueTotalSize-=l.size,o._queueTotalSize<0&&(o._queueTotalSize=0),l.value}function Ss(o,l,p){if(!U0(p)||p===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");o._queue.push({value:l,size:p}),o._queueTotalSize+=p}function O0(o){return o._queue.peek().value}function Ar(o){o._queue=new q,o._queueTotalSize=0}class Ya{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Es(this))throw As("view");return this._view}respond(l){if(!Es(this))throw As("respond");if(Be(l,1,"respond"),l=$e(l,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Kn(this._view.buffer),Qn(this._associatedReadableByteStreamController,l)}respondWithNewView(l){if(!Es(this))throw As("respondWithNewView");if(Be(l,1,"respondWithNewView"),!ArrayBuffer.isView(l))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Kn(l.buffer),jn(this._associatedReadableByteStreamController,l)}}Object.defineProperties(Ya.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ya.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class ya{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Gr(this))throw Za("byobRequest");return Ts(this)}get desiredSize(){if(!Gr(this))throw Za("desiredSize");return wu(this)}close(){if(!Gr(this))throw Za("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let l=this._controlledReadableByteStream._state;if(l!=="readable")throw new TypeError(`The stream (in ${l} state) is not in the readable state and cannot be closed`);Xa(this)}enqueue(l){if(!Gr(this))throw Za("enqueue");if(Be(l,1,"enqueue"),!ArrayBuffer.isView(l))throw new TypeError("chunk must be an array buffer view");if(l.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(l.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let p=this._controlledReadableByteStream._state;if(p!=="readable")throw new TypeError(`The stream (in ${p} state) is not in the readable state and cannot be enqueued to`);Gn(this,l)}error(l=void 0){if(!Gr(this))throw Za("error");Kt(this,l)}[Oe](l){bu(this),Ar(this);let p=this._cancelAlgorithm(l);return Wn(this),p}[qe](l){let p=this._controlledReadableByteStream;if(this._queueTotalSize>0){let N=this._queue.shift();this._queueTotalSize-=N.byteLength,_u(this);let U=new Uint8Array(N.buffer,N.byteOffset,N.byteLength);l._chunkSteps(U);return}let x=this._autoAllocateChunkSize;if(x!==void 0){let N;try{N=new ArrayBuffer(x)}catch(O){l._errorSteps(O);return}let U={buffer:N,bufferByteLength:x,byteOffset:0,byteLength:x,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(U)}cu(p,l),Qr(this)}}Object.defineProperties(ya.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(ya.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Gr(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_controlledReadableByteStream")?!1:o instanceof ya}function Es(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_associatedReadableByteStreamController")?!1:o instanceof Ya}function Qr(o){if(!M0(o))return;if(o._pulling){o._pullAgain=!0;return}o._pulling=!0;let p=o._pullAlgorithm();_(p,()=>{o._pulling=!1,o._pullAgain&&(o._pullAgain=!1,Qr(o))},x=>{Kt(o,x)})}function bu(o){xs(o),o._pendingPullIntos=new q}function bs(o,l){let p=!1;o._state==="closed"&&(p=!0);let x=xu(l);l.readerType==="default"?vs(o,x,p):z0(o,x,p)}function xu(o){let l=o.bytesFilled,p=o.elementSize;return new o.viewConstructor(o.buffer,o.byteOffset,l/p)}function Hn(o,l,p,x){o._queue.push({buffer:l,byteOffset:p,byteLength:x}),o._queueTotalSize+=x}function Tu(o,l){let p=l.elementSize,x=l.bytesFilled-l.bytesFilled%p,N=Math.min(o._queueTotalSize,l.byteLength-l.bytesFilled),U=l.bytesFilled+N,O=U-U%p,X=N,oe=!1;O>x&&(X=O-l.bytesFilled,oe=!0);let pe=o._queue;for(;X>0;){let Ce=pe.peek(),Se=Math.min(X,Ce.byteLength),ze=l.byteOffset+l.bytesFilled;Cu(l.buffer,ze,Ce.buffer,Ce.byteOffset,Se),Ce.byteLength===Se?pe.shift():(Ce.byteOffset+=Se,Ce.byteLength-=Se),o._queueTotalSize-=Se,Au(o,Se,l),X-=Se}return oe}function Au(o,l,p){p.bytesFilled+=l}function _u(o){o._queueTotalSize===0&&o._closeRequested?(Wn(o),on(o._controlledReadableByteStream)):Qr(o)}function xs(o){o._byobRequest!==null&&(o._byobRequest._associatedReadableByteStreamController=void 0,o._byobRequest._view=null,o._byobRequest=null)}function Iu(o){for(;o._pendingPullIntos.length>0;){if(o._queueTotalSize===0)return;let l=o._pendingPullIntos.peek();Tu(o,l)&&(zn(o),bs(o._controlledReadableByteStream,l))}}function F0(o,l,p){let x=o._controlledReadableByteStream,N=1;l.constructor!==DataView&&(N=l.constructor.BYTES_PER_ELEMENT);let U=l.constructor,O=l.buffer,X={buffer:O,bufferByteLength:O.byteLength,byteOffset:l.byteOffset,byteLength:l.byteLength,bytesFilled:0,elementSize:N,viewConstructor:U,readerType:"byob"};if(o._pendingPullIntos.length>0){o._pendingPullIntos.push(X),Lu(x,p);return}if(x._state==="closed"){let oe=new U(X.buffer,X.byteOffset,0);p._closeSteps(oe);return}if(o._queueTotalSize>0){if(Tu(o,X)){let oe=xu(X);_u(o),p._chunkSteps(oe);return}if(o._closeRequested){let oe=new TypeError("Insufficient bytes to fill elements in the given buffer");Kt(o,oe),p._errorSteps(oe);return}}o._pendingPullIntos.push(X),Lu(x,p),Qr(o)}function V0(o,l){let p=o._controlledReadableByteStream;if(_s(p))for(;Du(p)>0;){let x=zn(o);bs(p,x)}}function q0(o,l,p){if(Au(o,l,p),p.bytesFilled<p.elementSize)return;zn(o);let x=p.bytesFilled%p.elementSize;if(x>0){let N=p.byteOffset+p.bytesFilled,U=Su(p.buffer,N-x,N);Hn(o,U,0,U.byteLength)}p.bytesFilled-=x,bs(o._controlledReadableByteStream,p),Iu(o)}function Bu(o,l){let p=o._pendingPullIntos.peek();xs(o),o._controlledReadableByteStream._state==="closed"?V0(o):q0(o,l,p),Qr(o)}function zn(o){return o._pendingPullIntos.shift()}function M0(o){let l=o._controlledReadableByteStream;return l._state!=="readable"||o._closeRequested||!o._started?!1:!!(du(l)&&qn(l)>0||_s(l)&&Du(l)>0||wu(o)>0)}function Wn(o){o._pullAlgorithm=void 0,o._cancelAlgorithm=void 0}function Xa(o){let l=o._controlledReadableByteStream;if(!(o._closeRequested||l._state!=="readable")){if(o._queueTotalSize>0){o._closeRequested=!0;return}if(o._pendingPullIntos.length>0&&o._pendingPullIntos.peek().bytesFilled>0){let x=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Kt(o,x),x}Wn(o),on(l)}}function Gn(o,l){let p=o._controlledReadableByteStream;if(o._closeRequested||p._state!=="readable")return;let x=l.buffer,N=l.byteOffset,U=l.byteLength,O=x;if(o._pendingPullIntos.length>0){let X=o._pendingPullIntos.peek();Kn(X.buffer),X.buffer=X.buffer}if(xs(o),du(p))if(qn(p)===0)Hn(o,O,N,U);else{o._pendingPullIntos.length>0&&zn(o);let X=new Uint8Array(O,N,U);vs(p,X,!1)}else _s(p)?(Hn(o,O,N,U),Iu(o)):Hn(o,O,N,U);Qr(o)}function Kt(o,l){let p=o._controlledReadableByteStream;p._state==="readable"&&(bu(o),Ar(o),Wn(o),al(p,l))}function Ts(o){if(o._byobRequest===null&&o._pendingPullIntos.length>0){let l=o._pendingPullIntos.peek(),p=new Uint8Array(l.buffer,l.byteOffset+l.bytesFilled,l.byteLength-l.bytesFilled),x=Object.create(Ya.prototype);H0(x,o,p),o._byobRequest=x}return o._byobRequest}function wu(o){let l=o._controlledReadableByteStream._state;return l==="errored"?null:l==="closed"?0:o._strategyHWM-o._queueTotalSize}function Qn(o,l){let p=o._pendingPullIntos.peek();if(o._controlledReadableByteStream._state==="closed"){if(l!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(l===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(p.bytesFilled+l>p.byteLength)throw new RangeError("bytesWritten out of range")}p.buffer=p.buffer,Bu(o,l)}function jn(o,l){let p=o._pendingPullIntos.peek();if(o._controlledReadableByteStream._state==="closed"){if(l.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(l.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(p.byteOffset+p.bytesFilled!==l.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(p.bufferByteLength!==l.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(p.bytesFilled+l.byteLength>p.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let N=l.byteLength;p.buffer=l.buffer,Bu(o,N)}function Ru(o,l,p,x,N,U,O){l._controlledReadableByteStream=o,l._pullAgain=!1,l._pulling=!1,l._byobRequest=null,l._queue=l._queueTotalSize=void 0,Ar(l),l._closeRequested=!1,l._started=!1,l._strategyHWM=U,l._pullAlgorithm=x,l._cancelAlgorithm=N,l._autoAllocateChunkSize=O,l._pendingPullIntos=new q,o._readableStreamController=l;let X=p();_(C(X),()=>{l._started=!0,Qr(l)},oe=>{Kt(l,oe)})}function K0(o,l,p){let x=Object.create(ya.prototype),N=()=>{},U=()=>C(void 0),O=()=>C(void 0);l.start!==void 0&&(N=()=>l.start(x)),l.pull!==void 0&&(U=()=>l.pull(x)),l.cancel!==void 0&&(O=oe=>l.cancel(oe));let X=l.autoAllocateChunkSize;if(X===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");Ru(o,x,N,U,O,p,X)}function H0(o,l,p){o._associatedReadableByteStreamController=l,o._view=p}function As(o){return new TypeError(`ReadableStreamBYOBRequest.prototype.${o} can only be used on a ReadableStreamBYOBRequest`)}function Za(o){return new TypeError(`ReadableByteStreamController.prototype.${o} can only be used on a ReadableByteStreamController`)}function Nu(o){return new Ja(o)}function Lu(o,l){o._reader._readIntoRequests.push(l)}function z0(o,l,p){let N=o._reader._readIntoRequests.shift();p?N._closeSteps(l):N._chunkSteps(l)}function Du(o){return o._reader._readIntoRequests.length}function _s(o){let l=o._reader;return!(l===void 0||!jr(l))}class Ja{constructor(l){if(Be(l,1,"ReadableStreamBYOBReader"),ms(l,"First parameter"),wr(l))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Gr(l._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");Y(this,l),this._readIntoRequests=new q}get closed(){return jr(this)?this._closedPromise:E($n("closed"))}cancel(l=void 0){return jr(this)?this._ownerReadableStream===void 0?E(K("cancel")):H(this,l):E($n("cancel"))}read(l){if(!jr(this))return E($n("read"));if(!ArrayBuffer.isView(l))return E(new TypeError("view must be an array buffer view"));if(l.byteLength===0)return E(new TypeError("view must have non-zero byteLength"));if(l.buffer.byteLength===0)return E(new TypeError("view's buffer must have non-zero byteLength"));if(Kn(l.buffer),this._ownerReadableStream===void 0)return E(K("read from"));let p,x,N=h((O,X)=>{p=O,x=X});return ku(this,l,{_chunkSteps:O=>p({value:O,done:!1}),_closeSteps:O=>p({value:O,done:!0}),_errorSteps:O=>x(O)}),N}releaseLock(){if(!jr(this))throw $n("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ae(this)}}}Object.defineProperties(Ja.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ja.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function jr(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_readIntoRequests")?!1:o instanceof Ja}function ku(o,l,p){let x=o._ownerReadableStream;x._disturbed=!0,x._state==="errored"?p._errorSteps(x._storedError):F0(x._readableStreamController,l,p)}function $n(o){return new TypeError(`ReadableStreamBYOBReader.prototype.${o} can only be used on a ReadableStreamBYOBReader`)}function en(o,l){let{highWaterMark:p}=o;if(p===void 0)return l;if(vu(p)||p<0)throw new RangeError("Invalid highWaterMark");return p}function Yn(o){let{size:l}=o;return l||(()=>1)}function Xn(o,l){Ie(o,l);let p=o?.highWaterMark,x=o?.size;return{highWaterMark:p===void 0?void 0:He(p),size:x===void 0?void 0:W0(x,`${l} has member 'size' that`)}}function W0(o,l){return Ae(o,l),p=>He(o(p))}function G0(o,l){Ie(o,l);let p=o?.abort,x=o?.close,N=o?.start,U=o?.type,O=o?.write;return{abort:p===void 0?void 0:Q0(p,o,`${l} has member 'abort' that`),close:x===void 0?void 0:j0(x,o,`${l} has member 'close' that`),start:N===void 0?void 0:$0(N,o,`${l} has member 'start' that`),write:O===void 0?void 0:Y0(O,o,`${l} has member 'write' that`),type:U}}function Q0(o,l,p){return Ae(o,p),x=>R(o,l,[x])}function j0(o,l,p){return Ae(o,p),()=>R(o,l,[])}function $0(o,l,p){return Ae(o,p),x=>k(o,l,[x])}function Y0(o,l,p){return Ae(o,p),(x,N)=>R(o,l,[x,N])}function Pu(o,l){if(!ga(o))throw new TypeError(`${l} is not a WritableStream.`)}function X0(o){if(typeof o!="object"||o===null)return!1;try{return typeof o.aborted=="boolean"}catch{return!1}}let Z0=typeof AbortController=="function";function J0(){if(Z0)return new AbortController}class tn{constructor(l={},p={}){l===void 0?l=null:Qe(l,"First parameter");let x=Xn(p,"Second parameter"),N=G0(l,"First parameter");if(Ou(this),N.type!==void 0)throw new RangeError("Invalid type is specified");let O=Yn(x),X=en(x,1);hd(this,N,X,O)}get locked(){if(!ga(this))throw ri("locked");return ma(this)}abort(l=void 0){return ga(this)?ma(this)?E(new TypeError("Cannot abort a stream that already has a writer")):Zn(this,l):E(ri("abort"))}close(){return ga(this)?ma(this)?E(new TypeError("Cannot close a stream that already has a writer")):Yt(this)?E(new TypeError("Cannot close an already-closing stream")):Fu(this):E(ri("close"))}getWriter(){if(!ga(this))throw ri("getWriter");return Uu(this)}}Object.defineProperties(tn.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(tn.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});function Uu(o){return new rn(o)}function ed(o,l,p,x,N=1,U=()=>1){let O=Object.create(tn.prototype);Ou(O);let X=Object.create(va.prototype);return zu(O,X,o,l,p,x,N,U),O}function Ou(o){o._state="writable",o._storedError=void 0,o._writer=void 0,o._writableStreamController=void 0,o._writeRequests=new q,o._inFlightWriteRequest=void 0,o._closeRequest=void 0,o._inFlightCloseRequest=void 0,o._pendingAbortRequest=void 0,o._backpressure=!1}function ga(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_writableStreamController")?!1:o instanceof tn}function ma(o){return o._writer!==void 0}function Zn(o,l){var p;if(o._state==="closed"||o._state==="errored")return C(void 0);o._writableStreamController._abortReason=l,(p=o._writableStreamController._abortController)===null||p===void 0||p.abort();let x=o._state;if(x==="closed"||x==="errored")return C(void 0);if(o._pendingAbortRequest!==void 0)return o._pendingAbortRequest._promise;let N=!1;x==="erroring"&&(N=!0,l=void 0);let U=h((O,X)=>{o._pendingAbortRequest={_promise:void 0,_resolve:O,_reject:X,_reason:l,_wasAlreadyErroring:N}});return o._pendingAbortRequest._promise=U,N||Bs(o,l),U}function Fu(o){let l=o._state;if(l==="closed"||l==="errored")return E(new TypeError(`The stream (in ${l} state) is not in the writable state and cannot be closed`));let p=h((N,U)=>{let O={_resolve:N,_reject:U};o._closeRequest=O}),x=o._writer;return x!==void 0&&o._backpressure&&l==="writable"&&Os(x),pd(o._writableStreamController),p}function td(o){return h((p,x)=>{let N={_resolve:p,_reject:x};o._writeRequests.push(N)})}function Is(o,l){if(o._state==="writable"){Bs(o,l);return}ws(o)}function Bs(o,l){let p=o._writableStreamController;o._state="erroring",o._storedError=l;let x=o._writer;x!==void 0&&qu(x,l),!sd(o)&&p._started&&ws(o)}function ws(o){o._state="errored",o._writableStreamController[Ve]();let l=o._storedError;if(o._writeRequests.forEach(N=>{N._reject(l)}),o._writeRequests=new q,o._pendingAbortRequest===void 0){Jn(o);return}let p=o._pendingAbortRequest;if(o._pendingAbortRequest=void 0,p._wasAlreadyErroring){p._reject(l),Jn(o);return}let x=o._writableStreamController[fr](p._reason);_(x,()=>{p._resolve(),Jn(o)},N=>{p._reject(N),Jn(o)})}function rd(o){o._inFlightWriteRequest._resolve(void 0),o._inFlightWriteRequest=void 0}function ad(o,l){o._inFlightWriteRequest._reject(l),o._inFlightWriteRequest=void 0,Is(o,l)}function nd(o){o._inFlightCloseRequest._resolve(void 0),o._inFlightCloseRequest=void 0,o._state==="erroring"&&(o._storedError=void 0,o._pendingAbortRequest!==void 0&&(o._pendingAbortRequest._resolve(),o._pendingAbortRequest=void 0)),o._state="closed";let p=o._writer;p!==void 0&&ju(p)}function id(o,l){o._inFlightCloseRequest._reject(l),o._inFlightCloseRequest=void 0,o._pendingAbortRequest!==void 0&&(o._pendingAbortRequest._reject(l),o._pendingAbortRequest=void 0),Is(o,l)}function Yt(o){return!(o._closeRequest===void 0&&o._inFlightCloseRequest===void 0)}function sd(o){return!(o._inFlightWriteRequest===void 0&&o._inFlightCloseRequest===void 0)}function od(o){o._inFlightCloseRequest=o._closeRequest,o._closeRequest=void 0}function ud(o){o._inFlightWriteRequest=o._writeRequests.shift()}function Jn(o){o._closeRequest!==void 0&&(o._closeRequest._reject(o._storedError),o._closeRequest=void 0);let l=o._writer;l!==void 0&&Ps(l,o._storedError)}function Rs(o,l){let p=o._writer;p!==void 0&&l!==o._backpressure&&(l?Ed(p):Os(p)),o._backpressure=l}class rn{constructor(l){if(Be(l,1,"WritableStreamDefaultWriter"),Pu(l,"First parameter"),ma(l))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=l,l._writer=this;let p=l._state;if(p==="writable")!Yt(l)&&l._backpressure?ni(this):$u(this),ai(this);else if(p==="erroring")Us(this,l._storedError),ai(this);else if(p==="closed")$u(this),Cd(this);else{let x=l._storedError;Us(this,x),Qu(this,x)}}get closed(){return $r(this)?this._closedPromise:E(Yr("closed"))}get desiredSize(){if(!$r(this))throw Yr("desiredSize");if(this._ownerWritableStream===void 0)throw an("desiredSize");return dd(this)}get ready(){return $r(this)?this._readyPromise:E(Yr("ready"))}abort(l=void 0){return $r(this)?this._ownerWritableStream===void 0?E(an("abort")):ld(this,l):E(Yr("abort"))}close(){if(!$r(this))return E(Yr("close"));let l=this._ownerWritableStream;return l===void 0?E(an("close")):Yt(l)?E(new TypeError("Cannot close an already-closing stream")):Vu(this)}releaseLock(){if(!$r(this))throw Yr("releaseLock");this._ownerWritableStream!==void 0&&Mu(this)}write(l=void 0){return $r(this)?this._ownerWritableStream===void 0?E(an("write to")):Ku(this,l):E(Yr("write"))}}Object.defineProperties(rn.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(rn.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function $r(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_ownerWritableStream")?!1:o instanceof rn}function ld(o,l){let p=o._ownerWritableStream;return Zn(p,l)}function Vu(o){let l=o._ownerWritableStream;return Fu(l)}function fd(o){let l=o._ownerWritableStream,p=l._state;return Yt(l)||p==="closed"?C(void 0):p==="errored"?E(l._storedError):Vu(o)}function cd(o,l){o._closedPromiseState==="pending"?Ps(o,l):Sd(o,l)}function qu(o,l){o._readyPromiseState==="pending"?Yu(o,l):bd(o,l)}function dd(o){let l=o._ownerWritableStream,p=l._state;return p==="errored"||p==="erroring"?null:p==="closed"?0:Wu(l._writableStreamController)}function Mu(o){let l=o._ownerWritableStream,p=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");qu(o,p),cd(o,p),l._writer=void 0,o._ownerWritableStream=void 0}function Ku(o,l){let p=o._ownerWritableStream,x=p._writableStreamController,N=yd(x,l);if(p!==o._ownerWritableStream)return E(an("write to"));let U=p._state;if(U==="errored")return E(p._storedError);if(Yt(p)||U==="closed")return E(new TypeError("The stream is closing or closed and cannot be written to"));if(U==="erroring")return E(p._storedError);let O=td(p);return gd(x,l,N),O}let Hu={};class va{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Ns(this))throw ks("abortReason");return this._abortReason}get signal(){if(!Ns(this))throw ks("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(l=void 0){if(!Ns(this))throw ks("error");this._controlledWritableStream._state==="writable"&&Gu(this,l)}[fr](l){let p=this._abortAlgorithm(l);return ei(this),p}[Ve](){Ar(this)}}Object.defineProperties(va.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(va.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function Ns(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_controlledWritableStream")?!1:o instanceof va}function zu(o,l,p,x,N,U,O,X){l._controlledWritableStream=o,o._writableStreamController=l,l._queue=void 0,l._queueTotalSize=void 0,Ar(l),l._abortReason=void 0,l._abortController=J0(),l._started=!1,l._strategySizeAlgorithm=X,l._strategyHWM=O,l._writeAlgorithm=x,l._closeAlgorithm=N,l._abortAlgorithm=U;let oe=Ds(l);Rs(o,oe);let pe=p(),Ce=C(pe);_(Ce,()=>{l._started=!0,ti(l)},Se=>{l._started=!0,Is(o,Se)})}function hd(o,l,p,x){let N=Object.create(va.prototype),U=()=>{},O=()=>C(void 0),X=()=>C(void 0),oe=()=>C(void 0);l.start!==void 0&&(U=()=>l.start(N)),l.write!==void 0&&(O=pe=>l.write(pe,N)),l.close!==void 0&&(X=()=>l.close()),l.abort!==void 0&&(oe=pe=>l.abort(pe)),zu(o,N,U,O,X,oe,p,x)}function ei(o){o._writeAlgorithm=void 0,o._closeAlgorithm=void 0,o._abortAlgorithm=void 0,o._strategySizeAlgorithm=void 0}function pd(o){Ss(o,Hu,0),ti(o)}function yd(o,l){try{return o._strategySizeAlgorithm(l)}catch(p){return Ls(o,p),1}}function Wu(o){return o._strategyHWM-o._queueTotalSize}function gd(o,l,p){try{Ss(o,l,p)}catch(N){Ls(o,N);return}let x=o._controlledWritableStream;if(!Yt(x)&&x._state==="writable"){let N=Ds(o);Rs(x,N)}ti(o)}function ti(o){let l=o._controlledWritableStream;if(!o._started||l._inFlightWriteRequest!==void 0)return;if(l._state==="erroring"){ws(l);return}if(o._queue.length===0)return;let x=O0(o);x===Hu?md(o):vd(o,x)}function Ls(o,l){o._controlledWritableStream._state==="writable"&&Gu(o,l)}function md(o){let l=o._controlledWritableStream;od(l),Cs(o);let p=o._closeAlgorithm();ei(o),_(p,()=>{nd(l)},x=>{id(l,x)})}function vd(o,l){let p=o._controlledWritableStream;ud(p);let x=o._writeAlgorithm(l);_(x,()=>{rd(p);let N=p._state;if(Cs(o),!Yt(p)&&N==="writable"){let U=Ds(o);Rs(p,U)}ti(o)},N=>{p._state==="writable"&&ei(o),ad(p,N)})}function Ds(o){return Wu(o)<=0}function Gu(o,l){let p=o._controlledWritableStream;ei(o),Bs(p,l)}function ri(o){return new TypeError(`WritableStream.prototype.${o} can only be used on a WritableStream`)}function ks(o){return new TypeError(`WritableStreamDefaultController.prototype.${o} can only be used on a WritableStreamDefaultController`)}function Yr(o){return new TypeError(`WritableStreamDefaultWriter.prototype.${o} can only be used on a WritableStreamDefaultWriter`)}function an(o){return new TypeError("Cannot "+o+" a stream using a released writer")}function ai(o){o._closedPromise=h((l,p)=>{o._closedPromise_resolve=l,o._closedPromise_reject=p,o._closedPromiseState="pending"})}function Qu(o,l){ai(o),Ps(o,l)}function Cd(o){ai(o),ju(o)}function Ps(o,l){o._closedPromise_reject!==void 0&&(w(o._closedPromise),o._closedPromise_reject(l),o._closedPromise_resolve=void 0,o._closedPromise_reject=void 0,o._closedPromiseState="rejected")}function Sd(o,l){Qu(o,l)}function ju(o){o._closedPromise_resolve!==void 0&&(o._closedPromise_resolve(void 0),o._closedPromise_resolve=void 0,o._closedPromise_reject=void 0,o._closedPromiseState="resolved")}function ni(o){o._readyPromise=h((l,p)=>{o._readyPromise_resolve=l,o._readyPromise_reject=p}),o._readyPromiseState="pending"}function Us(o,l){ni(o),Yu(o,l)}function $u(o){ni(o),Os(o)}function Yu(o,l){o._readyPromise_reject!==void 0&&(w(o._readyPromise),o._readyPromise_reject(l),o._readyPromise_resolve=void 0,o._readyPromise_reject=void 0,o._readyPromiseState="rejected")}function Ed(o){ni(o)}function bd(o,l){Us(o,l)}function Os(o){o._readyPromise_resolve!==void 0&&(o._readyPromise_resolve(void 0),o._readyPromise_resolve=void 0,o._readyPromise_reject=void 0,o._readyPromiseState="fulfilled")}let Xu=typeof DOMException<"u"?DOMException:void 0;function xd(o){if(!(typeof o=="function"||typeof o=="object"))return!1;try{return new o,!0}catch{return!1}}function Td(){let o=function(p,x){this.message=p||"",this.name=x||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return o.prototype=Object.create(Error.prototype),Object.defineProperty(o.prototype,"constructor",{value:o,writable:!0,configurable:!0}),o}let Ad=xd(Xu)?Xu:Td();function Zu(o,l,p,x,N,U){let O=pa(o),X=Uu(l);o._disturbed=!0;let oe=!1,pe=C(void 0);return h((Ce,Se)=>{let ze;if(U!==void 0){if(ze=()=>{let te=new Ad("Aborted","AbortError"),de=[];x||de.push(()=>l._state==="writable"?Zn(l,te):C(void 0)),N||de.push(()=>o._state==="readable"?Ht(o,te):C(void 0)),vt(()=>Promise.all(de.map(we=>we())),!0,te)},U.aborted){ze();return}U.addEventListener("abort",ze)}function zt(){return h((te,de)=>{function we(At){At?te():g(Ea(),we,de)}we(!1)})}function Ea(){return oe?C(!0):g(X._readyPromise,()=>h((te,de)=>{ja(O,{_chunkSteps:we=>{pe=g(Ku(X,we),void 0,a),te(!1)},_closeSteps:()=>te(!0),_errorSteps:de})}))}if(cr(o,O._closedPromise,te=>{x?Rt(!0,te):vt(()=>Zn(l,te),!0,te)}),cr(l,X._closedPromise,te=>{N?Rt(!0,te):vt(()=>Ht(o,te),!0,te)}),dt(o,O._closedPromise,()=>{p?Rt():vt(()=>fd(X))}),Yt(l)||l._state==="closed"){let te=new TypeError("the destination writable stream closed before all data could be piped to it");N?Rt(!0,te):vt(()=>Ht(o,te),!0,te)}w(zt());function Rr(){let te=pe;return g(pe,()=>te!==pe?Rr():void 0)}function cr(te,de,we){te._state==="errored"?we(te._storedError):b(de,we)}function dt(te,de,we){te._state==="closed"?we():S(de,we)}function vt(te,de,we){if(oe)return;oe=!0,l._state==="writable"&&!Yt(l)?S(Rr(),At):At();function At(){_(te(),()=>dr(de,we),ba=>dr(!0,ba))}}function Rt(te,de){oe||(oe=!0,l._state==="writable"&&!Yt(l)?S(Rr(),()=>dr(te,de)):dr(te,de))}function dr(te,de){Mu(X),ae(O),U!==void 0&&U.removeEventListener("abort",ze),te?Se(de):Ce(void 0)}})}class Ca{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!ii(this))throw ui("desiredSize");return Fs(this)}close(){if(!ii(this))throw ui("close");if(!Sa(this))throw new TypeError("The stream is not in a state that permits close");sn(this)}enqueue(l=void 0){if(!ii(this))throw ui("enqueue");if(!Sa(this))throw new TypeError("The stream is not in a state that permits enqueue");return oi(this,l)}error(l=void 0){if(!ii(this))throw ui("error");_r(this,l)}[Oe](l){Ar(this);let p=this._cancelAlgorithm(l);return si(this),p}[qe](l){let p=this._controlledReadableStream;if(this._queue.length>0){let x=Cs(this);this._closeRequested&&this._queue.length===0?(si(this),on(p)):nn(this),l._chunkSteps(x)}else cu(p,l),nn(this)}}Object.defineProperties(Ca.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ca.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function ii(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_controlledReadableStream")?!1:o instanceof Ca}function nn(o){if(!Ju(o))return;if(o._pulling){o._pullAgain=!0;return}o._pulling=!0;let p=o._pullAlgorithm();_(p,()=>{o._pulling=!1,o._pullAgain&&(o._pullAgain=!1,nn(o))},x=>{_r(o,x)})}function Ju(o){let l=o._controlledReadableStream;return!Sa(o)||!o._started?!1:!!(wr(l)&&qn(l)>0||Fs(o)>0)}function si(o){o._pullAlgorithm=void 0,o._cancelAlgorithm=void 0,o._strategySizeAlgorithm=void 0}function sn(o){if(!Sa(o))return;let l=o._controlledReadableStream;o._closeRequested=!0,o._queue.length===0&&(si(o),on(l))}function oi(o,l){if(!Sa(o))return;let p=o._controlledReadableStream;if(wr(p)&&qn(p)>0)vs(p,l,!1);else{let x;try{x=o._strategySizeAlgorithm(l)}catch(N){throw _r(o,N),N}try{Ss(o,l,x)}catch(N){throw _r(o,N),N}}nn(o)}function _r(o,l){let p=o._controlledReadableStream;p._state==="readable"&&(Ar(o),si(o),al(p,l))}function Fs(o){let l=o._controlledReadableStream._state;return l==="errored"?null:l==="closed"?0:o._strategyHWM-o._queueTotalSize}function _d(o){return!Ju(o)}function Sa(o){let l=o._controlledReadableStream._state;return!o._closeRequested&&l==="readable"}function el(o,l,p,x,N,U,O){l._controlledReadableStream=o,l._queue=void 0,l._queueTotalSize=void 0,Ar(l),l._started=!1,l._closeRequested=!1,l._pullAgain=!1,l._pulling=!1,l._strategySizeAlgorithm=O,l._strategyHWM=U,l._pullAlgorithm=x,l._cancelAlgorithm=N,o._readableStreamController=l;let X=p();_(C(X),()=>{l._started=!0,nn(l)},oe=>{_r(l,oe)})}function Id(o,l,p,x){let N=Object.create(Ca.prototype),U=()=>{},O=()=>C(void 0),X=()=>C(void 0);l.start!==void 0&&(U=()=>l.start(N)),l.pull!==void 0&&(O=()=>l.pull(N)),l.cancel!==void 0&&(X=oe=>l.cancel(oe)),el(o,N,U,O,X,p,x)}function ui(o){return new TypeError(`ReadableStreamDefaultController.prototype.${o} can only be used on a ReadableStreamDefaultController`)}function Bd(o,l){return Gr(o._readableStreamController)?Rd(o):wd(o)}function wd(o,l){let p=pa(o),x=!1,N=!1,U=!1,O=!1,X,oe,pe,Ce,Se,ze=h(dt=>{Se=dt});function zt(){return x?(N=!0,C(void 0)):(x=!0,ja(p,{_chunkSteps:vt=>{D(()=>{N=!1;let Rt=vt,dr=vt;U||oi(pe._readableStreamController,Rt),O||oi(Ce._readableStreamController,dr),x=!1,N&&zt()})},_closeSteps:()=>{x=!1,U||sn(pe._readableStreamController),O||sn(Ce._readableStreamController),(!U||!O)&&Se(void 0)},_errorSteps:()=>{x=!1}}),C(void 0))}function Ea(dt){if(U=!0,X=dt,O){let vt=$a([X,oe]),Rt=Ht(o,vt);Se(Rt)}return ze}function Rr(dt){if(O=!0,oe=dt,U){let vt=$a([X,oe]),Rt=Ht(o,vt);Se(Rt)}return ze}function cr(){}return pe=Vs(cr,zt,Ea),Ce=Vs(cr,zt,Rr),b(p._closedPromise,dt=>{_r(pe._readableStreamController,dt),_r(Ce._readableStreamController,dt),(!U||!O)&&Se(void 0)}),[pe,Ce]}function Rd(o){let l=pa(o),p=!1,x=!1,N=!1,U=!1,O=!1,X,oe,pe,Ce,Se,ze=h(te=>{Se=te});function zt(te){b(te._closedPromise,de=>{te===l&&(Kt(pe._readableStreamController,de),Kt(Ce._readableStreamController,de),(!U||!O)&&Se(void 0))})}function Ea(){jr(l)&&(ae(l),l=pa(o),zt(l)),ja(l,{_chunkSteps:de=>{D(()=>{x=!1,N=!1;let we=de,At=de;if(!U&&!O)try{At=Eu(de)}catch(ba){Kt(pe._readableStreamController,ba),Kt(Ce._readableStreamController,ba),Se(Ht(o,ba));return}U||Gn(pe._readableStreamController,we),O||Gn(Ce._readableStreamController,At),p=!1,x?cr():N&&dt()})},_closeSteps:()=>{p=!1,U||Xa(pe._readableStreamController),O||Xa(Ce._readableStreamController),pe._readableStreamController._pendingPullIntos.length>0&&Qn(pe._readableStreamController,0),Ce._readableStreamController._pendingPullIntos.length>0&&Qn(Ce._readableStreamController,0),(!U||!O)&&Se(void 0)},_errorSteps:()=>{p=!1}})}function Rr(te,de){Tr(l)&&(ae(l),l=Nu(o),zt(l));let we=de?Ce:pe,At=de?pe:Ce;ku(l,te,{_chunkSteps:xa=>{D(()=>{x=!1,N=!1;let Ta=de?O:U;if(de?U:O)Ta||jn(we._readableStreamController,xa);else{let gl;try{gl=Eu(xa)}catch(Ms){Kt(we._readableStreamController,Ms),Kt(At._readableStreamController,Ms),Se(Ht(o,Ms));return}Ta||jn(we._readableStreamController,xa),Gn(At._readableStreamController,gl)}p=!1,x?cr():N&&dt()})},_closeSteps:xa=>{p=!1;let Ta=de?O:U,mi=de?U:O;Ta||Xa(we._readableStreamController),mi||Xa(At._readableStreamController),xa!==void 0&&(Ta||jn(we._readableStreamController,xa),!mi&&At._readableStreamController._pendingPullIntos.length>0&&Qn(At._readableStreamController,0)),(!Ta||!mi)&&Se(void 0)},_errorSteps:()=>{p=!1}})}function cr(){if(p)return x=!0,C(void 0);p=!0;let te=Ts(pe._readableStreamController);return te===null?Ea():Rr(te._view,!1),C(void 0)}function dt(){if(p)return N=!0,C(void 0);p=!0;let te=Ts(Ce._readableStreamController);return te===null?Ea():Rr(te._view,!0),C(void 0)}function vt(te){if(U=!0,X=te,O){let de=$a([X,oe]),we=Ht(o,de);Se(we)}return ze}function Rt(te){if(O=!0,oe=te,U){let de=$a([X,oe]),we=Ht(o,de);Se(we)}return ze}function dr(){}return pe=rl(dr,cr,vt),Ce=rl(dr,dt,Rt),zt(l),[pe,Ce]}function Nd(o,l){Ie(o,l);let p=o,x=p?.autoAllocateChunkSize,N=p?.cancel,U=p?.pull,O=p?.start,X=p?.type;return{autoAllocateChunkSize:x===void 0?void 0:$e(x,`${l} has member 'autoAllocateChunkSize' that`),cancel:N===void 0?void 0:Ld(N,p,`${l} has member 'cancel' that`),pull:U===void 0?void 0:Dd(U,p,`${l} has member 'pull' that`),start:O===void 0?void 0:kd(O,p,`${l} has member 'start' that`),type:X===void 0?void 0:Pd(X,`${l} has member 'type' that`)}}function Ld(o,l,p){return Ae(o,p),x=>R(o,l,[x])}function Dd(o,l,p){return Ae(o,p),x=>R(o,l,[x])}function kd(o,l,p){return Ae(o,p),x=>k(o,l,[x])}function Pd(o,l){if(o=`${o}`,o!=="bytes")throw new TypeError(`${l} '${o}' is not a valid enumeration value for ReadableStreamType`);return o}function Ud(o,l){Ie(o,l);let p=o?.mode;return{mode:p===void 0?void 0:Od(p,`${l} has member 'mode' that`)}}function Od(o,l){if(o=`${o}`,o!=="byob")throw new TypeError(`${l} '${o}' is not a valid enumeration value for ReadableStreamReaderMode`);return o}function Fd(o,l){Ie(o,l);let p=o?.preventCancel;return{preventCancel:Boolean(p)}}function tl(o,l){Ie(o,l);let p=o?.preventAbort,x=o?.preventCancel,N=o?.preventClose,U=o?.signal;return U!==void 0&&Vd(U,`${l} has member 'signal' that`),{preventAbort:Boolean(p),preventCancel:Boolean(x),preventClose:Boolean(N),signal:U}}function Vd(o,l){if(!X0(o))throw new TypeError(`${l} is not an AbortSignal.`)}function qd(o,l){Ie(o,l);let p=o?.readable;Ke(p,"readable","ReadableWritablePair"),ms(p,`${l} has member 'readable' that`);let x=o?.writable;return Ke(x,"writable","ReadableWritablePair"),Pu(x,`${l} has member 'writable' that`),{readable:p,writable:x}}class Ir{constructor(l={},p={}){l===void 0?l=null:Qe(l,"First parameter");let x=Xn(p,"Second parameter"),N=Nd(l,"First parameter");if(qs(this),N.type==="bytes"){if(x.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let U=en(x,0);K0(this,N,U)}else{let U=Yn(x),O=en(x,1);Id(this,N,O,U)}}get locked(){if(!Br(this))throw Xr("locked");return wr(this)}cancel(l=void 0){return Br(this)?wr(this)?E(new TypeError("Cannot cancel a stream that already has a reader")):Ht(this,l):E(Xr("cancel"))}getReader(l=void 0){if(!Br(this))throw Xr("getReader");return Ud(l,"First parameter").mode===void 0?pa(this):Nu(this)}pipeThrough(l,p={}){if(!Br(this))throw Xr("pipeThrough");Be(l,1,"pipeThrough");let x=qd(l,"First parameter"),N=tl(p,"Second parameter");if(wr(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(ma(x.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let U=Zu(this,x.writable,N.preventClose,N.preventAbort,N.preventCancel,N.signal);return w(U),x.readable}pipeTo(l,p={}){if(!Br(this))return E(Xr("pipeTo"));if(l===void 0)return E("Parameter 1 is required in 'pipeTo'.");if(!ga(l))return E(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let x;try{x=tl(p,"Second parameter")}catch(N){return E(N)}return wr(this)?E(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):ma(l)?E(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Zu(this,l,x.preventClose,x.preventAbort,x.preventCancel,x.signal)}tee(){if(!Br(this))throw Xr("tee");let l=Bd(this);return $a(l)}values(l=void 0){if(!Br(this))throw Xr("values");let p=Fd(l,"First parameter");return P0(this,p.preventCancel)}}Object.defineProperties(Ir.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ir.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),typeof t.asyncIterator=="symbol"&&Object.defineProperty(Ir.prototype,t.asyncIterator,{value:Ir.prototype.values,writable:!0,configurable:!0});function Vs(o,l,p,x=1,N=()=>1){let U=Object.create(Ir.prototype);qs(U);let O=Object.create(Ca.prototype);return el(U,O,o,l,p,x,N),U}function rl(o,l,p){let x=Object.create(Ir.prototype);qs(x);let N=Object.create(ya.prototype);return Ru(x,N,o,l,p,0,void 0),x}function qs(o){o._state="readable",o._reader=void 0,o._storedError=void 0,o._disturbed=!1}function Br(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_readableStreamController")?!1:o instanceof Ir}function wr(o){return o._reader!==void 0}function Ht(o,l){if(o._disturbed=!0,o._state==="closed")return C(void 0);if(o._state==="errored")return E(o._storedError);on(o);let p=o._reader;p!==void 0&&jr(p)&&(p._readIntoRequests.forEach(N=>{N._closeSteps(void 0)}),p._readIntoRequests=new q);let x=o._readableStreamController[Oe](l);return A(x,a)}function on(o){o._state="closed";let l=o._reader;l!==void 0&&($t(l),Tr(l)&&(l._readRequests.forEach(p=>{p._closeSteps()}),l._readRequests=new q))}function al(o,l){o._state="errored",o._storedError=l;let p=o._reader;p!==void 0&&(Ue(p,l),Tr(p)?(p._readRequests.forEach(x=>{x._errorSteps(l)}),p._readRequests=new q):(p._readIntoRequests.forEach(x=>{x._errorSteps(l)}),p._readIntoRequests=new q))}function Xr(o){return new TypeError(`ReadableStream.prototype.${o} can only be used on a ReadableStream`)}function nl(o,l){Ie(o,l);let p=o?.highWaterMark;return Ke(p,"highWaterMark","QueuingStrategyInit"),{highWaterMark:He(p)}}let il=o=>o.byteLength;Object.defineProperty(il,"name",{value:"size",configurable:!0});class li{constructor(l){Be(l,1,"ByteLengthQueuingStrategy"),l=nl(l,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=l.highWaterMark}get highWaterMark(){if(!ol(this))throw sl("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!ol(this))throw sl("size");return il}}Object.defineProperties(li.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(li.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function sl(o){return new TypeError(`ByteLengthQueuingStrategy.prototype.${o} can only be used on a ByteLengthQueuingStrategy`)}function ol(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_byteLengthQueuingStrategyHighWaterMark")?!1:o instanceof li}let ul=()=>1;Object.defineProperty(ul,"name",{value:"size",configurable:!0});class fi{constructor(l){Be(l,1,"CountQueuingStrategy"),l=nl(l,"First parameter"),this._countQueuingStrategyHighWaterMark=l.highWaterMark}get highWaterMark(){if(!fl(this))throw ll("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!fl(this))throw ll("size");return ul}}Object.defineProperties(fi.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(fi.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function ll(o){return new TypeError(`CountQueuingStrategy.prototype.${o} can only be used on a CountQueuingStrategy`)}function fl(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_countQueuingStrategyHighWaterMark")?!1:o instanceof fi}function Md(o,l){Ie(o,l);let p=o?.flush,x=o?.readableType,N=o?.start,U=o?.transform,O=o?.writableType;return{flush:p===void 0?void 0:Kd(p,o,`${l} has member 'flush' that`),readableType:x,start:N===void 0?void 0:Hd(N,o,`${l} has member 'start' that`),transform:U===void 0?void 0:zd(U,o,`${l} has member 'transform' that`),writableType:O}}function Kd(o,l,p){return Ae(o,p),x=>R(o,l,[x])}function Hd(o,l,p){return Ae(o,p),x=>k(o,l,[x])}function zd(o,l,p){return Ae(o,p),(x,N)=>R(o,l,[x,N])}class ci{constructor(l={},p={},x={}){l===void 0&&(l=null);let N=Xn(p,"Second parameter"),U=Xn(x,"Third parameter"),O=Md(l,"First parameter");if(O.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(O.writableType!==void 0)throw new RangeError("Invalid writableType specified");let X=en(U,0),oe=Yn(U),pe=en(N,1),Ce=Yn(N),Se,ze=h(zt=>{Se=zt});Wd(this,ze,pe,Ce,X,oe),Qd(this,O),O.start!==void 0?Se(O.start(this._transformStreamController)):Se(void 0)}get readable(){if(!cl(this))throw yl("readable");return this._readable}get writable(){if(!cl(this))throw yl("writable");return this._writable}}Object.defineProperties(ci.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(ci.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});function Wd(o,l,p,x,N,U){function O(){return l}function X(ze){return Yd(o,ze)}function oe(ze){return Xd(o,ze)}function pe(){return Zd(o)}o._writable=ed(O,X,pe,oe,p,x);function Ce(){return Jd(o)}function Se(ze){return hi(o,ze),C(void 0)}o._readable=Vs(O,Ce,Se,N,U),o._backpressure=void 0,o._backpressureChangePromise=void 0,o._backpressureChangePromise_resolve=void 0,pi(o,!0),o._transformStreamController=void 0}function cl(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_transformStreamController")?!1:o instanceof ci}function di(o,l){_r(o._readable._readableStreamController,l),hi(o,l)}function hi(o,l){dl(o._transformStreamController),Ls(o._writable._writableStreamController,l),o._backpressure&&pi(o,!1)}function pi(o,l){o._backpressureChangePromise!==void 0&&o._backpressureChangePromise_resolve(),o._backpressureChangePromise=h(p=>{o._backpressureChangePromise_resolve=p}),o._backpressure=l}class un{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!yi(this))throw gi("desiredSize");let l=this._controlledTransformStream._readable._readableStreamController;return Fs(l)}enqueue(l=void 0){if(!yi(this))throw gi("enqueue");hl(this,l)}error(l=void 0){if(!yi(this))throw gi("error");jd(this,l)}terminate(){if(!yi(this))throw gi("terminate");$d(this)}}Object.defineProperties(un.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(un.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function yi(o){return!i(o)||!Object.prototype.hasOwnProperty.call(o,"_controlledTransformStream")?!1:o instanceof un}function Gd(o,l,p,x){l._controlledTransformStream=o,o._transformStreamController=l,l._transformAlgorithm=p,l._flushAlgorithm=x}function Qd(o,l){let p=Object.create(un.prototype),x=U=>{try{return hl(p,U),C(void 0)}catch(O){return E(O)}},N=()=>C(void 0);l.transform!==void 0&&(x=U=>l.transform(U,p)),l.flush!==void 0&&(N=()=>l.flush(p)),Gd(o,p,x,N)}function dl(o){o._transformAlgorithm=void 0,o._flushAlgorithm=void 0}function hl(o,l){let p=o._controlledTransformStream,x=p._readable._readableStreamController;if(!Sa(x))throw new TypeError("Readable side is not in a state that permits enqueue");try{oi(x,l)}catch(U){throw hi(p,U),p._readable._storedError}_d(x)!==p._backpressure&&pi(p,!0)}function jd(o,l){di(o._controlledTransformStream,l)}function pl(o,l){let p=o._transformAlgorithm(l);return A(p,void 0,x=>{throw di(o._controlledTransformStream,x),x})}function $d(o){let l=o._controlledTransformStream,p=l._readable._readableStreamController;sn(p);let x=new TypeError("TransformStream terminated");hi(l,x)}function Yd(o,l){let p=o._transformStreamController;if(o._backpressure){let x=o._backpressureChangePromise;return A(x,()=>{let N=o._writable;if(N._state==="erroring")throw N._storedError;return pl(p,l)})}return pl(p,l)}function Xd(o,l){return di(o,l),C(void 0)}function Zd(o){let l=o._readable,p=o._transformStreamController,x=p._flushAlgorithm();return dl(p),A(x,()=>{if(l._state==="errored")throw l._storedError;sn(l._readableStreamController)},N=>{throw di(o,N),l._storedError})}function Jd(o){return pi(o,!1),o._backpressureChangePromise}function gi(o){return new TypeError(`TransformStreamDefaultController.prototype.${o} can only be used on a TransformStreamDefaultController`)}function yl(o){return new TypeError(`TransformStream.prototype.${o} can only be used on a TransformStream`)}e.ByteLengthQueuingStrategy=li,e.CountQueuingStrategy=fi,e.ReadableByteStreamController=ya,e.ReadableStream=Ir,e.ReadableStreamBYOBReader=Ja,e.ReadableStreamBYOBRequest=Ya,e.ReadableStreamDefaultController=Ca,e.ReadableStreamDefaultReader=Qa,e.TransformStream=ci,e.TransformStreamDefaultController=un,e.WritableStream=tn,e.WritableStreamDefaultController=va,e.WritableStreamDefaultWriter=rn,Object.defineProperty(e,"__esModule",{value:!0})})});var bl=ne(()=>{if(!globalThis.ReadableStream)try{let e=require("node:process"),{emitWarning:t}=e;try{e.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),e.emitWarning=t}catch(a){throw e.emitWarning=t,a}}catch{Object.assign(globalThis,El())}try{let{Blob:e}=require("buffer");e&&!e.prototype.stream&&(e.prototype.stream=function(a){let r=0,n=this;return new ReadableStream({type:"bytes",async pull(i){let u=await n.slice(r,Math.min(n.size,r+65536)).arrayBuffer();r+=u.byteLength,i.enqueue(new Uint8Array(u)),r===n.size&&i.close()}})})}catch{}});async function*Ks(e,t=!0){for(let a of e)if("stream"in a)yield*a.stream();else if(ArrayBuffer.isView(a))if(t){let r=a.byteOffset,n=a.byteOffset+a.byteLength;for(;r!==n;){let i=Math.min(n-r,xl),s=a.buffer.slice(r,r+i);r+=s.byteLength,yield new Uint8Array(s)}}else yield a;else{let r=0,n=a;for(;r!==n.size;){let s=await n.slice(r,Math.min(n.size,r+xl)).arrayBuffer();r+=s.byteLength,yield new Uint8Array(s)}}}var Lm,xl,Tl,oh,gr,dn=ln(()=>{Lm=ft(bl(),1);xl=65536;Tl=class Hs{#e=[];#t="";#r=0;#a="transparent";constructor(t=[],a={}){if(typeof t!="object"||t===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof t[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof a!="object"&&typeof a!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");a===null&&(a={});let r=new TextEncoder;for(let i of t){let s;ArrayBuffer.isView(i)?s=new Uint8Array(i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength)):i instanceof ArrayBuffer?s=new Uint8Array(i.slice(0)):i instanceof Hs?s=i:s=r.encode(`${i}`);let u=ArrayBuffer.isView(s)?s.byteLength:s.size;u&&(this.#r+=u,this.#e.push(s))}this.#a=`${a.endings===void 0?"transparent":a.endings}`;let n=a.type===void 0?"":String(a.type);this.#t=/^[\x20-\x7E]*$/.test(n)?n:""}get size(){return this.#r}get type(){return this.#t}async text(){let t=new TextDecoder,a="";for await(let r of Ks(this.#e,!1))a+=t.decode(r,{stream:!0});return a+=t.decode(),a}async arrayBuffer(){let t=new Uint8Array(this.size),a=0;for await(let r of Ks(this.#e,!1))t.set(r,a),a+=r.length;return t.buffer}stream(){let t=Ks(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(a){let r=await t.next();r.done?a.close():a.enqueue(r.value)},async cancel(){await t.return()}})}slice(t=0,a=this.size,r=""){let{size:n}=this,i=t<0?Math.max(n+t,0):Math.min(t,n),s=a<0?Math.max(n+a,0):Math.min(a,n),u=Math.max(s-i,0),c=this.#e,f=[],d=0;for(let C of c){if(d>=u)break;let E=ArrayBuffer.isView(C)?C.byteLength:C.size;if(i&&E<=i)i-=E,s-=E;else{let g;ArrayBuffer.isView(C)?(g=C.subarray(i,Math.min(E,s)),d+=g.byteLength):(g=C.slice(i,Math.min(E,s)),d+=g.size),s-=E,f.push(g),i=0}}let h=new Hs([],{type:String(r).toLowerCase()});return h.#r=u,h.#e=f,h}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](t){return t&&typeof t=="object"&&typeof t.constructor=="function"&&(typeof t.stream=="function"||typeof t.arrayBuffer=="function")&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}};Object.defineProperties(Tl.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});oh=Tl,gr=oh});var uh,lh,Aa,zs=ln(()=>{dn();uh=class extends gr{#e=0;#t="";constructor(t,a,r={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(t,r),r===null&&(r={});let n=r.lastModified===void 0?Date.now():Number(r.lastModified);Number.isNaN(n)||(this.#e=n),this.#t=String(a)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](t){return!!t&&t instanceof gr&&/^(File)$/.test(t[Symbol.toStringTag])}},lh=uh,Aa=lh});function Il(e,t=gr){var a=`${Al()}${Al()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),r=[],n=`--${a}\r
Content-Disposition: form-data; name="`;return e.forEach((i,s)=>typeof i=="string"?r.push(n+Ws(s)+`"\r
\r
${i.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):r.push(n+Ws(s)+`"; filename="${Ws(i.name,1)}"\r
Content-Type: ${i.type||"application/octet-stream"}\r
\r
`,i,`\r
`)),r.push(`--${a}--`),new t(r,{type:"multipart/form-data; boundary="+a})}var hn,fh,ch,Al,dh,_l,Ws,Jr,ea,Si=ln(()=>{dn();zs();({toStringTag:hn,iterator:fh,hasInstance:ch}=Symbol),Al=Math.random,dh="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),_l=(e,t,a)=>(e+="",/^(Blob|File)$/.test(t&&t[hn])?[(a=a!==void 0?a+"":t[hn]=="File"?t.name:"blob",e),t.name!==a||t[hn]=="blob"?new Aa([t],a,t):t]:[e,t+""]),Ws=(e,t)=>(t?e:e.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),Jr=(e,t,a)=>{if(t.length<a)throw new TypeError(`Failed to execute '${e}' on 'FormData': ${a} arguments required, but only ${t.length} present.`)},ea=class{#e=[];constructor(...t){if(t.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[hn](){return"FormData"}[fh](){return this.entries()}static[ch](t){return t&&typeof t=="object"&&t[hn]==="FormData"&&!dh.some(a=>typeof t[a]!="function")}append(...t){Jr("append",arguments,2),this.#e.push(_l(...t))}delete(t){Jr("delete",arguments,1),t+="",this.#e=this.#e.filter(([a])=>a!==t)}get(t){Jr("get",arguments,1),t+="";for(var a=this.#e,r=a.length,n=0;n<r;n++)if(a[n][0]===t)return a[n][1];return null}getAll(t,a){return Jr("getAll",arguments,1),a=[],t+="",this.#e.forEach(r=>r[0]===t&&a.push(r[1])),a}has(t){return Jr("has",arguments,1),t+="",this.#e.some(a=>a[0]===t)}forEach(t,a){Jr("forEach",arguments,1);for(var[r,n]of this)t.call(a,n,r,this)}set(...t){Jr("set",arguments,2);var a=[],r=!0;t=_l(...t),this.#e.forEach(n=>{n[0]===t[0]?r&&(r=!a.push(t)):a.push(n)}),r&&a.push(t),this.#e=a}*entries(){yield*this.#e}*keys(){for(var[t]of this)yield t}*values(){for(var[,t]of this)yield t}}});var Ll=ne((Wm,Nl)=>{if(!globalThis.DOMException)try{let{MessageChannel:e}=require("worker_threads"),t=new e().port1,a=new ArrayBuffer;t.postMessage(a,[a,a])}catch(e){e.constructor.name==="DOMException"&&(globalThis.DOMException=e.constructor)}Nl.exports=globalThis.DOMException});var yn,Dl,hh,bi,Qs=ln(()=>{yn=require("node:fs"),Dl=ft(Ll(),1);zs();dn();({stat:hh}=yn.promises),bi=class{#e;#t;constructor(t){this.#e=t.path,this.#t=t.start,this.size=t.size,this.lastModified=t.lastModified,this.originalSize=t.originalSize===void 0?t.size:t.originalSize}slice(t,a){return new bi({path:this.#e,lastModified:this.lastModified,originalSize:this.originalSize,size:a-t,start:this.#t+t})}async*stream(){let{mtimeMs:t,size:a}=await hh(this.#e);if(t>this.lastModified||this.originalSize!==a)throw new Dl.default("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*(0,yn.createReadStream)(this.#e,{start:this.#t,end:this.#t+this.size-1})}get[Symbol.toStringTag](){return"Blob"}}});var Pl={};ml(Pl,{toFormData:()=>Sh});function Ch(e){let t=e.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;let a=t[2]||t[3]||"",r=a.slice(a.lastIndexOf("\\")+1);return r=r.replace(/%22/g,'"'),r=r.replace(/&#(\d{4});/g,(n,i)=>String.fromCharCode(i)),r}async function Sh(e,t){if(!/multipart/i.test(t))throw new TypeError("Failed to fetch");let a=t.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!a)throw new TypeError("no or bad content-type header, no multipart boundary");let r=new js(a[1]||a[2]),n,i,s,u,c,f,d=[],h=new ea,C=b=>{s+=S.decode(b,{stream:!0})},E=b=>{d.push(b)},g=()=>{let b=new Aa(d,f,{type:c});h.append(u,b)},_=()=>{h.append(u,s)},S=new TextDecoder("utf-8");S.decode(),r.onPartBegin=function(){r.onPartData=C,r.onPartEnd=_,n="",i="",s="",u="",c="",f=null,d.length=0},r.onHeaderField=function(b){n+=S.decode(b,{stream:!0})},r.onHeaderValue=function(b){i+=S.decode(b,{stream:!0})},r.onHeaderEnd=function(){if(i+=S.decode(),n=n.toLowerCase(),n==="content-disposition"){let b=i.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);b&&(u=b[2]||b[3]||""),f=Ch(i),f&&(r.onPartData=E,r.onPartEnd=g)}else n==="content-type"&&(c=i);i="",n=""};for await(let b of e)r.write(b);return r.end(),h}var Xt,Re,kl,Dr,xi,Ti,ph,gn,yh,gh,mh,vh,ta,js,Ul=ln(()=>{Qs();Si();Xt=0,Re={START_BOUNDARY:Xt++,HEADER_FIELD_START:Xt++,HEADER_FIELD:Xt++,HEADER_VALUE_START:Xt++,HEADER_VALUE:Xt++,HEADER_VALUE_ALMOST_DONE:Xt++,HEADERS_ALMOST_DONE:Xt++,PART_DATA_START:Xt++,PART_DATA:Xt++,END:Xt++},kl=1,Dr={PART_BOUNDARY:kl,LAST_BOUNDARY:kl*=2},xi=10,Ti=13,ph=32,gn=45,yh=58,gh=97,mh=122,vh=e=>e|32,ta=()=>{},js=class{constructor(t){this.index=0,this.flags=0,this.onHeaderEnd=ta,this.onHeaderField=ta,this.onHeadersEnd=ta,this.onHeaderValue=ta,this.onPartBegin=ta,this.onPartData=ta,this.onPartEnd=ta,this.boundaryChars={},t=`\r
--`+t;let a=new Uint8Array(t.length);for(let r=0;r<t.length;r++)a[r]=t.charCodeAt(r),this.boundaryChars[a[r]]=!0;this.boundary=a,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=Re.START_BOUNDARY}write(t){let a=0,r=t.length,n=this.index,{lookbehind:i,boundary:s,boundaryChars:u,index:c,state:f,flags:d}=this,h=this.boundary.length,C=h-1,E=t.length,g,_,S=D=>{this[D+"Mark"]=a},b=D=>{delete this[D+"Mark"]},A=(D,k,R,G)=>{(k===void 0||k!==R)&&this[D](G&&G.subarray(k,R))},w=(D,k)=>{let R=D+"Mark";R in this&&(k?(A(D,this[R],a,t),delete this[R]):(A(D,this[R],t.length,t),this[R]=0))};for(a=0;a<r;a++)switch(g=t[a],f){case Re.START_BOUNDARY:if(c===s.length-2){if(g===gn)d|=Dr.LAST_BOUNDARY;else if(g!==Ti)return;c++;break}else if(c-1===s.length-2){if(d&Dr.LAST_BOUNDARY&&g===gn)f=Re.END,d=0;else if(!(d&Dr.LAST_BOUNDARY)&&g===xi)c=0,A("onPartBegin"),f=Re.HEADER_FIELD_START;else return;break}g!==s[c+2]&&(c=-2),g===s[c+2]&&c++;break;case Re.HEADER_FIELD_START:f=Re.HEADER_FIELD,S("onHeaderField"),c=0;case Re.HEADER_FIELD:if(g===Ti){b("onHeaderField"),f=Re.HEADERS_ALMOST_DONE;break}if(c++,g===gn)break;if(g===yh){if(c===1)return;w("onHeaderField",!0),f=Re.HEADER_VALUE_START;break}if(_=vh(g),_<gh||_>mh)return;break;case Re.HEADER_VALUE_START:if(g===ph)break;S("onHeaderValue"),f=Re.HEADER_VALUE;case Re.HEADER_VALUE:g===Ti&&(w("onHeaderValue",!0),A("onHeaderEnd"),f=Re.HEADER_VALUE_ALMOST_DONE);break;case Re.HEADER_VALUE_ALMOST_DONE:if(g!==xi)return;f=Re.HEADER_FIELD_START;break;case Re.HEADERS_ALMOST_DONE:if(g!==xi)return;A("onHeadersEnd"),f=Re.PART_DATA_START;break;case Re.PART_DATA_START:f=Re.PART_DATA,S("onPartData");case Re.PART_DATA:if(n=c,c===0){for(a+=C;a<E&&!(t[a]in u);)a+=h;a-=C,g=t[a]}if(c<s.length)s[c]===g?(c===0&&w("onPartData",!0),c++):c=0;else if(c===s.length)c++,g===Ti?d|=Dr.PART_BOUNDARY:g===gn?d|=Dr.LAST_BOUNDARY:c=0;else if(c-1===s.length)if(d&Dr.PART_BOUNDARY){if(c=0,g===xi){d&=~Dr.PART_BOUNDARY,A("onPartEnd"),A("onPartBegin"),f=Re.HEADER_FIELD_START;break}}else d&Dr.LAST_BOUNDARY&&g===gn?(A("onPartEnd"),f=Re.END,d=0):c=0;if(c>0)i[c-1]=g;else if(n>0){let D=new Uint8Array(i.buffer,i.byteOffset,i.byteLength);A("onPartData",0,n,D),n=0,S("onPartData"),a--}break;case Re.END:break;default:throw new Error(`Unexpected state entered: ${f}`)}w("onHeaderField"),w("onHeaderValue"),w("onPartData"),this.index=c,this.state=f,this.flags=d}end(){if(this.state===Re.HEADER_FIELD_START&&this.index===0||this.state===Re.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==Re.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var Li=ne((Fv,Ni)=>{(function(){"use strict";var e=typeof window=="object"?window:{},t=!e.HI_BASE32_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;t&&(e=global);var a=!e.HI_BASE32_NO_COMMON_JS&&typeof Ni=="object"&&Ni.exports,r=typeof define=="function"&&define.amd,n="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".split(""),i={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,2:26,3:27,4:28,5:29,6:30,7:31},s=[0,0,0,0,0,0,0,0],u=function(S,b){b.length>10&&(b="..."+b.substr(-10));var A=new Error("Decoded data is not valid UTF-8. Maybe try base32.decode.asBytes()? Partial data after reading "+S+" bytes: "+b+" <-");throw A.position=S,A},c=function(S){for(var b="",A=S.length,w=0,D=0,k,R;w<A;){if(k=S[w++],k<=127){b+=String.fromCharCode(k);continue}else k>191&&k<=223?(R=k&31,D=1):k<=239?(R=k&15,D=2):k<=247?(R=k&7,D=3):u(w,b);for(var G=0;G<D;++G)k=S[w++],(k<128||k>191)&&u(w,b),R<<=6,R+=k&63;R>=55296&&R<=57343&&u(w,b),R>1114111&&u(w,b),R<=65535?b+=String.fromCharCode(R):(R-=65536,b+=String.fromCharCode((R>>10)+55296),b+=String.fromCharCode((R&1023)+56320))}return b},f=function(S){if(S==="")return[];if(!/^[A-Z2-7=]+$/.test(S))throw new Error("Invalid base32 characters");S=S.replace(/=/g,"");for(var b,A,w,D,k,R,G,q,Y=[],H=0,ae=S.length,K=0,xe=ae>>3<<3;K<xe;)b=i[S.charAt(K++)],A=i[S.charAt(K++)],w=i[S.charAt(K++)],D=i[S.charAt(K++)],k=i[S.charAt(K++)],R=i[S.charAt(K++)],G=i[S.charAt(K++)],q=i[S.charAt(K++)],Y[H++]=(b<<3|A>>>2)&255,Y[H++]=(A<<6|w<<1|D>>>4)&255,Y[H++]=(D<<4|k>>>1)&255,Y[H++]=(k<<7|R<<2|G>>>3)&255,Y[H++]=(G<<5|q)&255;var De=ae-xe;return De===2?(b=i[S.charAt(K++)],A=i[S.charAt(K++)],Y[H++]=(b<<3|A>>>2)&255):De===4?(b=i[S.charAt(K++)],A=i[S.charAt(K++)],w=i[S.charAt(K++)],D=i[S.charAt(K++)],Y[H++]=(b<<3|A>>>2)&255,Y[H++]=(A<<6|w<<1|D>>>4)&255):De===5?(b=i[S.charAt(K++)],A=i[S.charAt(K++)],w=i[S.charAt(K++)],D=i[S.charAt(K++)],k=i[S.charAt(K++)],Y[H++]=(b<<3|A>>>2)&255,Y[H++]=(A<<6|w<<1|D>>>4)&255,Y[H++]=(D<<4|k>>>1)&255):De===7&&(b=i[S.charAt(K++)],A=i[S.charAt(K++)],w=i[S.charAt(K++)],D=i[S.charAt(K++)],k=i[S.charAt(K++)],R=i[S.charAt(K++)],G=i[S.charAt(K++)],Y[H++]=(b<<3|A>>>2)&255,Y[H++]=(A<<6|w<<1|D>>>4)&255,Y[H++]=(D<<4|k>>>1)&255,Y[H++]=(k<<7|R<<2|G>>>3)&255),Y},d=function(S){for(var b,A,w,D,k,R="",G=S.length,q=0,Y=parseInt(G/5)*5;q<Y;)b=S.charCodeAt(q++),A=S.charCodeAt(q++),w=S.charCodeAt(q++),D=S.charCodeAt(q++),k=S.charCodeAt(q++),R+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[(w<<1|D>>>7)&31]+n[D>>>2&31]+n[(D<<3|k>>>5)&31]+n[k&31];var H=G-Y;return H===1?(b=S.charCodeAt(q),R+=n[b>>>3]+n[b<<2&31]+"======"):H===2?(b=S.charCodeAt(q++),A=S.charCodeAt(q),R+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[A<<4&31]+"===="):H===3?(b=S.charCodeAt(q++),A=S.charCodeAt(q++),w=S.charCodeAt(q),R+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[w<<1&31]+"==="):H===4&&(b=S.charCodeAt(q++),A=S.charCodeAt(q++),w=S.charCodeAt(q++),D=S.charCodeAt(q),R+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[(w<<1|D>>>7)&31]+n[D>>>2&31]+n[D<<3&31]+"="),R},h=function(S){var b,A,w,D,k,R,G=!1,q="",Y=0,H,ae=0,K=0,xe=S.length;if(S==="")return q;do{for(s[0]=s[5],s[1]=s[6],s[2]=s[7],H=ae;Y<xe&&H<5;++Y)R=S.charCodeAt(Y),R<128?s[H++]=R:R<2048?(s[H++]=192|R>>6,s[H++]=128|R&63):R<55296||R>=57344?(s[H++]=224|R>>12,s[H++]=128|R>>6&63,s[H++]=128|R&63):(R=65536+((R&1023)<<10|S.charCodeAt(++Y)&1023),s[H++]=240|R>>18,s[H++]=128|R>>12&63,s[H++]=128|R>>6&63,s[H++]=128|R&63);K+=H-ae,ae=H-5,Y===xe&&++Y,Y>xe&&H<6&&(G=!0),b=s[0],H>4?(A=s[1],w=s[2],D=s[3],k=s[4],q+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[(w<<1|D>>>7)&31]+n[D>>>2&31]+n[(D<<3|k>>>5)&31]+n[k&31]):H===1?q+=n[b>>>3]+n[b<<2&31]+"======":H===2?(A=s[1],q+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[A<<4&31]+"===="):H===3?(A=s[1],w=s[2],q+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[w<<1&31]+"==="):(A=s[1],w=s[2],D=s[3],q+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[(w<<1|D>>>7)&31]+n[D>>>2&31]+n[D<<3&31]+"=")}while(!G);return q},C=function(S){for(var b,A,w,D,k,R="",G=S.length,q=0,Y=parseInt(G/5)*5;q<Y;)b=S[q++],A=S[q++],w=S[q++],D=S[q++],k=S[q++],R+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[(w<<1|D>>>7)&31]+n[D>>>2&31]+n[(D<<3|k>>>5)&31]+n[k&31];var H=G-Y;return H===1?(b=S[q],R+=n[b>>>3]+n[b<<2&31]+"======"):H===2?(b=S[q++],A=S[q],R+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[A<<4&31]+"===="):H===3?(b=S[q++],A=S[q++],w=S[q],R+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[w<<1&31]+"==="):H===4&&(b=S[q++],A=S[q++],w=S[q++],D=S[q],R+=n[b>>>3]+n[(b<<2|A>>>6)&31]+n[A>>>1&31]+n[(A<<4|w>>>4)&31]+n[(w<<1|D>>>7)&31]+n[D>>>2&31]+n[D<<3&31]+"="),R},E=function(S,b){var A=typeof S!="string";return A&&S.constructor===ArrayBuffer&&(S=new Uint8Array(S)),A?C(S):b?d(S):h(S)},g=function(S,b){if(!b)return c(f(S));if(S==="")return"";if(!/^[A-Z2-7=]+$/.test(S))throw new Error("Invalid base32 characters");var A,w,D,k,R,G,q,Y,H="",ae=S.indexOf("=");ae===-1&&(ae=S.length);for(var K=0,xe=ae>>3<<3;K<xe;)A=i[S.charAt(K++)],w=i[S.charAt(K++)],D=i[S.charAt(K++)],k=i[S.charAt(K++)],R=i[S.charAt(K++)],G=i[S.charAt(K++)],q=i[S.charAt(K++)],Y=i[S.charAt(K++)],H+=String.fromCharCode((A<<3|w>>>2)&255)+String.fromCharCode((w<<6|D<<1|k>>>4)&255)+String.fromCharCode((k<<4|R>>>1)&255)+String.fromCharCode((R<<7|G<<2|q>>>3)&255)+String.fromCharCode((q<<5|Y)&255);var De=ae-xe;return De===2?(A=i[S.charAt(K++)],w=i[S.charAt(K++)],H+=String.fromCharCode((A<<3|w>>>2)&255)):De===4?(A=i[S.charAt(K++)],w=i[S.charAt(K++)],D=i[S.charAt(K++)],k=i[S.charAt(K++)],H+=String.fromCharCode((A<<3|w>>>2)&255)+String.fromCharCode((w<<6|D<<1|k>>>4)&255)):De===5?(A=i[S.charAt(K++)],w=i[S.charAt(K++)],D=i[S.charAt(K++)],k=i[S.charAt(K++)],R=i[S.charAt(K++)],H+=String.fromCharCode((A<<3|w>>>2)&255)+String.fromCharCode((w<<6|D<<1|k>>>4)&255)+String.fromCharCode((k<<4|R>>>1)&255)):De===7&&(A=i[S.charAt(K++)],w=i[S.charAt(K++)],D=i[S.charAt(K++)],k=i[S.charAt(K++)],R=i[S.charAt(K++)],G=i[S.charAt(K++)],q=i[S.charAt(K++)],H+=String.fromCharCode((A<<3|w>>>2)&255)+String.fromCharCode((w<<6|D<<1|k>>>4)&255)+String.fromCharCode((k<<4|R>>>1)&255)+String.fromCharCode((R<<7|G<<2|q>>>3)&255)),H},_={encode:E,decode:g};g.asBytes=f,a?Ni.exports=_:(e.base32=_,r&&define(function(){return _}))})()});var ue=ne((Vv,af)=>{af.exports={options:{usePureJavaScript:!1}}});var of=ne((qv,sf)=>{var Js={};sf.exports=Js;var nf={};Js.encode=function(e,t,a){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(a!==void 0&&typeof a!="number")throw new TypeError('"maxline" must be a number.');var r="";if(!(e instanceof Uint8Array))r=Bh(e,t);else{var n=0,i=t.length,s=t.charAt(0),u=[0];for(n=0;n<e.length;++n){for(var c=0,f=e[n];c<u.length;++c)f+=u[c]<<8,u[c]=f%i,f=f/i|0;for(;f>0;)u.push(f%i),f=f/i|0}for(n=0;e[n]===0&&n<e.length-1;++n)r+=s;for(n=u.length-1;n>=0;--n)r+=t[u[n]]}if(a){var d=new RegExp(".{1,"+a+"}","g");r=r.match(d).join(`\r
`)}return r};Js.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var a=nf[t];if(!a){a=nf[t]=[];for(var r=0;r<t.length;++r)a[t.charCodeAt(r)]=r}e=e.replace(/\s/g,"");for(var n=t.length,i=t.charAt(0),s=[0],r=0;r<e.length;r++){var u=a[e.charCodeAt(r)];if(u===void 0)return;for(var c=0,f=u;c<s.length;++c)f+=s[c]*n,s[c]=f&255,f>>=8;for(;f>0;)s.push(f&255),f>>=8}for(var d=0;e[d]===i&&d<e.length-1;++d)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function Bh(e,t){var a=0,r=t.length,n=t.charAt(0),i=[0];for(a=0;a<e.length();++a){for(var s=0,u=e.at(a);s<i.length;++s)u+=i[s]<<8,i[s]=u%r,u=u/r|0;for(;u>0;)i.push(u%r),u=u/r|0}var c="";for(a=0;e.at(a)===0&&a<e.length()-1;++a)c+=n;for(a=i.length-1;a>=0;--a)c+=t[i[a]];return c}});var me=ne((Mv,cf)=>{var uf=ue(),lf=of(),B=cf.exports=uf.util=uf.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){B.nextTick=process.nextTick,typeof setImmediate=="function"?B.setImmediate=setImmediate:B.setImmediate=B.nextTick;return}if(typeof setImmediate=="function"){B.setImmediate=function(){return setImmediate.apply(void 0,arguments)},B.nextTick=function(u){return setImmediate(u)};return}if(B.setImmediate=function(u){setTimeout(u,0)},typeof window<"u"&&typeof window.postMessage=="function"){let u=function(c){if(c.source===window&&c.data===e){c.stopPropagation();var f=t.slice();t.length=0,f.forEach(function(d){d()})}};var s=u,e="forge.setImmediate",t=[];B.setImmediate=function(c){t.push(c),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",u,!0)}if(typeof MutationObserver<"u"){var a=Date.now(),r=!0,n=document.createElement("div"),t=[];new MutationObserver(function(){var c=t.slice();t.length=0,c.forEach(function(f){f()})}).observe(n,{attributes:!0});var i=B.setImmediate;B.setImmediate=function(c){Date.now()-a>15?(a=Date.now(),i(c)):(t.push(c),t.length===1&&n.setAttribute("a",r=!r))}}B.nextTick=B.setImmediate})();B.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;B.globalScope=function(){return B.isNodejs?global:typeof self>"u"?window:self}();B.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};B.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};B.isArrayBufferView=function(e){return e&&B.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function xn(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}B.ByteBuffer=eo;function eo(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(B.isArrayBuffer(e)||B.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var a=0;a<t.length;++a)this.putByte(t[a])}}else(e instanceof eo||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}B.ByteStringBuffer=eo;var wh=4096;B.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>wh&&(this.data.substr(0,1),this._constructedStringLength=0)};B.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};B.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};B.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};B.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var a=this.data;t>0;)t&1&&(a+=e),t>>>=1,t>0&&(e+=e);return this.data=a,this._optimizeConstructedString(t),this};B.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};B.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(B.encodeUtf8(e))};B.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};B.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};B.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};B.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};B.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};B.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};B.ByteStringBuffer.prototype.putInt=function(e,t){xn(t);var a="";do t-=8,a+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(a)};B.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};B.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};B.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};B.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};B.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};B.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};B.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};B.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};B.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};B.ByteStringBuffer.prototype.getInt=function(e){xn(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};B.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),a=2<<e-2;return t>=a&&(t-=a<<1),t};B.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};B.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};B.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};B.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};B.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};B.ByteStringBuffer.prototype.copy=function(){var e=B.createBuffer(this.data);return e.read=this.read,e};B.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};B.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};B.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};B.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var a=this.data.charCodeAt(t);a<16&&(e+="0"),e+=a.toString(16)}return e};B.ByteStringBuffer.prototype.toString=function(){return B.decodeUtf8(this.bytes())};function Rh(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var a=B.isArrayBuffer(e),r=B.isArrayBufferView(e);if(a||r){a?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}B.DataBuffer=Rh;B.DataBuffer.prototype.length=function(){return this.write-this.read};B.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};B.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var a=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),r=new Uint8Array(this.length()+t);return r.set(a),this.data=new DataView(r.buffer),this};B.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};B.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var a=0;a<t;++a)this.data.setUint8(e);return this};B.DataBuffer.prototype.putBytes=function(e,t){if(B.isArrayBufferView(e)){var a=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),r=a.byteLength-a.byteOffset;this.accommodate(r);var n=new Uint8Array(this.data.buffer,this.write);return n.set(a),this.write+=r,this}if(B.isArrayBuffer(e)){var a=new Uint8Array(e);this.accommodate(a.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(a,this.write),this.write+=a.byteLength,this}if(e instanceof B.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&B.isArrayBufferView(e.data)){var a=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(a.byteLength);var n=new Uint8Array(e.data.byteLength,this.write);return n.set(a),this.write+=a.byteLength,this}if(e instanceof B.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var i;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=B.binary.hex.decode(e,i,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),i=new Uint8Array(this.data.buffer,this.write),this.write+=B.binary.base64.decode(e,i,this.write),this;if(t==="utf8"&&(e=B.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=B.binary.raw.decode(i),this;if(t==="utf16")return this.accommodate(e.length*2),i=new Uint16Array(this.data.buffer,this.write),this.write+=B.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};B.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};B.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};B.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};B.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};B.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};B.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};B.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};B.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};B.DataBuffer.prototype.putInt=function(e,t){xn(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};B.DataBuffer.prototype.putSignedInt=function(e,t){return xn(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};B.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};B.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};B.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};B.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};B.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};B.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};B.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};B.DataBuffer.prototype.getInt=function(e){xn(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};B.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),a=2<<e-2;return t>=a&&(t-=a<<1),t};B.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};B.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};B.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};B.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};B.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};B.DataBuffer.prototype.copy=function(){return new B.DataBuffer(this)};B.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};B.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};B.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};B.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var a=this.data.getUint8(t);a<16&&(e+="0"),e+=a.toString(16)}return e};B.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return B.binary.raw.encode(t);if(e==="hex")return B.binary.hex.encode(t);if(e==="base64")return B.binary.base64.encode(t);if(e==="utf8")return B.text.utf8.decode(t);if(e==="utf16")return B.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};B.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=B.encodeUtf8(e)),new B.ByteBuffer(e)};B.fillString=function(e,t){for(var a="";t>0;)t&1&&(a+=e),t>>>=1,t>0&&(e+=e);return a};B.xorBytes=function(e,t,a){for(var r="",n="",i="",s=0,u=0;a>0;--a,++s)n=e.charCodeAt(s)^t.charCodeAt(s),u>=10&&(r+=i,i="",u=0),i+=String.fromCharCode(n),++u;return r+=i,r};B.hexToBytes=function(e){var t="",a=0;for(e.length&!0&&(a=1,t+=String.fromCharCode(parseInt(e[0],16)));a<e.length;a+=2)t+=String.fromCharCode(parseInt(e.substr(a,2),16));return t};B.bytesToHex=function(e){return B.createBuffer(e).toHex()};B.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var Pr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ur=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],ff="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";B.encode64=function(e,t){for(var a="",r="",n,i,s,u=0;u<e.length;)n=e.charCodeAt(u++),i=e.charCodeAt(u++),s=e.charCodeAt(u++),a+=Pr.charAt(n>>2),a+=Pr.charAt((n&3)<<4|i>>4),isNaN(i)?a+="==":(a+=Pr.charAt((i&15)<<2|s>>6),a+=isNaN(s)?"=":Pr.charAt(s&63)),t&&a.length>t&&(r+=a.substr(0,t)+`\r
`,a=a.substr(t));return r+=a,r};B.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",a,r,n,i,s=0;s<e.length;)a=Ur[e.charCodeAt(s++)-43],r=Ur[e.charCodeAt(s++)-43],n=Ur[e.charCodeAt(s++)-43],i=Ur[e.charCodeAt(s++)-43],t+=String.fromCharCode(a<<2|r>>4),n!==64&&(t+=String.fromCharCode((r&15)<<4|n>>2),i!==64&&(t+=String.fromCharCode((n&3)<<6|i)));return t};B.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};B.decodeUtf8=function(e){return decodeURIComponent(escape(e))};B.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:lf.encode,decode:lf.decode}};B.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};B.binary.raw.decode=function(e,t,a){var r=t;r||(r=new Uint8Array(e.length)),a=a||0;for(var n=a,i=0;i<e.length;++i)r[n++]=e.charCodeAt(i);return t?n-a:r};B.binary.hex.encode=B.bytesToHex;B.binary.hex.decode=function(e,t,a){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/2))),a=a||0;var n=0,i=a;for(e.length&1&&(n=1,r[i++]=parseInt(e[0],16));n<e.length;n+=2)r[i++]=parseInt(e.substr(n,2),16);return t?i-a:r};B.binary.base64.encode=function(e,t){for(var a="",r="",n,i,s,u=0;u<e.byteLength;)n=e[u++],i=e[u++],s=e[u++],a+=Pr.charAt(n>>2),a+=Pr.charAt((n&3)<<4|i>>4),isNaN(i)?a+="==":(a+=Pr.charAt((i&15)<<2|s>>6),a+=isNaN(s)?"=":Pr.charAt(s&63)),t&&a.length>t&&(r+=a.substr(0,t)+`\r
`,a=a.substr(t));return r+=a,r};B.binary.base64.decode=function(e,t,a){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),a=a||0;for(var n,i,s,u,c=0,f=a;c<e.length;)n=Ur[e.charCodeAt(c++)-43],i=Ur[e.charCodeAt(c++)-43],s=Ur[e.charCodeAt(c++)-43],u=Ur[e.charCodeAt(c++)-43],r[f++]=n<<2|i>>4,s!==64&&(r[f++]=(i&15)<<4|s>>2,u!==64&&(r[f++]=(s&3)<<6|u));return t?f-a:r.subarray(0,f)};B.binary.base58.encode=function(e,t){return B.binary.baseN.encode(e,ff,t)};B.binary.base58.decode=function(e,t){return B.binary.baseN.decode(e,ff,t)};B.text={utf8:{},utf16:{}};B.text.utf8.encode=function(e,t,a){e=B.encodeUtf8(e);var r=t;r||(r=new Uint8Array(e.length)),a=a||0;for(var n=a,i=0;i<e.length;++i)r[n++]=e.charCodeAt(i);return t?n-a:r};B.text.utf8.decode=function(e){return B.decodeUtf8(String.fromCharCode.apply(null,e))};B.text.utf16.encode=function(e,t,a){var r=t;r||(r=new Uint8Array(e.length*2));var n=new Uint16Array(r.buffer);a=a||0;for(var i=a,s=a,u=0;u<e.length;++u)n[s++]=e.charCodeAt(u),i+=2;return t?i-a:r};B.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};B.deflate=function(e,t,a){if(t=B.decode64(e.deflate(B.encode64(t)).rval),a){var r=2,n=t.charCodeAt(1);n&32&&(r=6),t=t.substring(r,t.length-4)}return t};B.inflate=function(e,t,a){var r=e.inflate(B.encode64(t)).rval;return r===null?null:B.decode64(r)};var to=function(e,t,a){if(!e)throw new Error("WebStorage not available.");var r;if(a===null?r=e.removeItem(t):(a=B.encode64(JSON.stringify(a)),r=e.setItem(t,a)),typeof r<"u"&&r.rval!==!0){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}},ro=function(e,t){if(!e)throw new Error("WebStorage not available.");var a=e.getItem(t);if(e.init)if(a.rval===null){if(a.error){var r=new Error(a.error.message);throw r.id=a.error.id,r.name=a.error.name,r}a=null}else a=a.rval;return a!==null&&(a=JSON.parse(B.decode64(a))),a},Nh=function(e,t,a,r){var n=ro(e,t);n===null&&(n={}),n[a]=r,to(e,t,n)},Lh=function(e,t,a){var r=ro(e,t);return r!==null&&(r=a in r?r[a]:null),r},Dh=function(e,t,a){var r=ro(e,t);if(r!==null&&a in r){delete r[a];var n=!0;for(var i in r){n=!1;break}n&&(r=null),to(e,t,r)}},kh=function(e,t){to(e,t,null)},Di=function(e,t,a){var r=null;typeof a>"u"&&(a=["web","flash"]);var n,i=!1,s=null;for(var u in a){n=a[u];try{if(n==="flash"||n==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");r=e.apply(this,t),i=n==="flash"}(n==="web"||n==="both")&&(t[0]=localStorage,r=e.apply(this,t),i=!0)}catch(c){s=c}if(i)break}if(!i)throw s;return r};B.setItem=function(e,t,a,r,n){Di(Nh,arguments,n)};B.getItem=function(e,t,a,r){return Di(Lh,arguments,r)};B.removeItem=function(e,t,a,r){Di(Dh,arguments,r)};B.clearItems=function(e,t,a){Di(kh,arguments,a)};B.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};B.format=function(e){for(var t=/%./g,a,r,n=0,i=[],s=0;a=t.exec(e);){r=e.substring(s,t.lastIndex-2),r.length>0&&i.push(r),s=t.lastIndex;var u=a[0][1];switch(u){case"s":case"o":n<arguments.length?i.push(arguments[n+++1]):i.push("<?>");break;case"%":i.push("%");break;default:i.push("<%"+u+"?>")}}return i.push(e.substring(s)),i.join("")};B.formatNumber=function(e,t,a,r){var n=e,i=isNaN(t=Math.abs(t))?2:t,s=a===void 0?",":a,u=r===void 0?".":r,c=n<0?"-":"",f=parseInt(n=Math.abs(+n||0).toFixed(i),10)+"",d=f.length>3?f.length%3:0;return c+(d?f.substr(0,d)+u:"")+f.substr(d).replace(/(\d{3})(?=\d)/g,"$1"+u)+(i?s+Math.abs(n-f).toFixed(i).slice(2):"")};B.formatSize=function(e){return e>=1073741824?e=B.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=B.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=B.formatNumber(e/1024,0)+" KiB":e=B.formatNumber(e,0)+" bytes",e};B.bytesFromIP=function(e){return e.indexOf(".")!==-1?B.bytesFromIPv4(e):e.indexOf(":")!==-1?B.bytesFromIPv6(e):null};B.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=B.createBuffer(),a=0;a<e.length;++a){var r=parseInt(e[a],10);if(isNaN(r))return null;t.putByte(r)}return t.getBytes()};B.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(s){return s.length===0&&++t,!0});for(var a=(8-e.length+t)*2,r=B.createBuffer(),n=0;n<8;++n){if(!e[n]||e[n].length===0){r.fillWithByte(0,a),a=0;continue}var i=B.hexToBytes(e[n]);i.length<2&&r.putByte(0),r.putBytes(i)}return r.getBytes()};B.bytesToIP=function(e){return e.length===4?B.bytesToIPv4(e):e.length===16?B.bytesToIPv6(e):null};B.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],a=0;a<e.length;++a)t.push(e.charCodeAt(a));return t.join(".")};B.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],a=[],r=0,n=0;n<e.length;n+=2){for(var i=B.bytesToHex(e[n]+e[n+1]);i[0]==="0"&&i!=="0";)i=i.substr(1);if(i==="0"){var s=a[a.length-1],u=t.length;!s||u!==s.end+1?a.push({start:u,end:u}):(s.end=u,s.end-s.start>a[r].end-a[r].start&&(r=a.length-1))}t.push(i)}if(a.length>0){var c=a[r];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),c.start===0&&t.unshift(""),c.end===7&&t.push(""))}return t.join(":")};B.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in B&&!e.update)return t(null,B.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return B.cores=navigator.hardwareConcurrency,t(null,B.cores);if(typeof Worker>"u")return B.cores=1,t(null,B.cores);if(typeof Blob>"u")return B.cores=2,t(null,B.cores);var a=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var u=Date.now(),c=u+4;Date.now()<c;);self.postMessage({st:u,et:c})})}.toString(),")()"],{type:"application/javascript"}));r([],5,16);function r(s,u,c){if(u===0){var f=Math.floor(s.reduce(function(d,h){return d+h},0)/s.length);return B.cores=Math.max(1,f),URL.revokeObjectURL(a),t(null,B.cores)}n(c,function(d,h){s.push(i(c,h)),r(s,u-1,c)})}function n(s,u){for(var c=[],f=[],d=0;d<s;++d){var h=new Worker(a);h.addEventListener("message",function(C){if(f.push(C.data),f.length===s){for(var E=0;E<s;++E)c[E].terminate();u(null,f)}}),c.push(h)}for(var d=0;d<s;++d)c[d].postMessage(d)}function i(s,u){for(var c=[],f=0;f<s;++f)for(var d=u[f],h=c[f]=[],C=0;C<s;++C)if(f!==C){var E=u[C];(d.st>E.st&&d.st<E.et||E.st>d.st&&E.st<d.et)&&h.push(C)}return c.reduce(function(g,_){return Math.max(g,_.length)},0)}}});var ki=ne((Kv,df)=>{var tt=ue();me();df.exports=tt.cipher=tt.cipher||{};tt.cipher.algorithms=tt.cipher.algorithms||{};tt.cipher.createCipher=function(e,t){var a=e;if(typeof a=="string"&&(a=tt.cipher.getAlgorithm(a),a&&(a=a())),!a)throw new Error("Unsupported algorithm: "+e);return new tt.cipher.BlockCipher({algorithm:a,key:t,decrypt:!1})};tt.cipher.createDecipher=function(e,t){var a=e;if(typeof a=="string"&&(a=tt.cipher.getAlgorithm(a),a&&(a=a())),!a)throw new Error("Unsupported algorithm: "+e);return new tt.cipher.BlockCipher({algorithm:a,key:t,decrypt:!0})};tt.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),tt.cipher.algorithms[e]=t};tt.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in tt.cipher.algorithms?tt.cipher.algorithms[e]:null};var ao=tt.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};ao.prototype.start=function(e){e=e||{};var t={};for(var a in e)t[a]=e[a];t.decrypt=this._decrypt,this._finish=!1,this._input=tt.util.createBuffer(),this.output=e.output||tt.util.createBuffer(),this.mode.start(t)};ao.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};ao.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(a){return e(this.blockSize,a,!1)},this.mode.unpad=function(a){return e(this.blockSize,a,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var io=ne((Hv,hf)=>{var rt=ue();me();rt.cipher=rt.cipher||{};var le=hf.exports=rt.cipher.modes=rt.cipher.modes||{};le.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};le.ecb.prototype.start=function(e){};le.ecb.prototype.encrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])};le.ecb.prototype.decrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])};le.ecb.prototype.pad=function(e,t){var a=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(a,a),!0};le.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var a=e.length(),r=e.at(a-1);return r>this.blockSize<<2?!1:(e.truncate(r),!0)};le.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};le.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=Pi(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};le.cbc.prototype.encrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=this._prev[r]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._outBlock[r]);this._prev=this._outBlock};le.cbc.prototype.decrypt=function(e,t,a){if(e.length()<this.blockSize&&!(a&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var r=0;r<this._ints;++r)t.putInt32(this._prev[r]^this._outBlock[r]);this._prev=this._inBlock.slice(0)};le.cbc.prototype.pad=function(e,t){var a=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(a,a),!0};le.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var a=e.length(),r=e.at(a-1);return r>this.blockSize<<2?!1:(e.truncate(r),!0)};le.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=rt.util.createBuffer(),this._partialBytes=0};le.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Pi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};le.cfb.prototype.encrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32()^this._outBlock[n],t.putInt32(this._inBlock[n]);return}var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=e.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(i>0)e.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};le.cfb.prototype.decrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32(),t.putInt32(this._inBlock[n]^this._outBlock[n]);return}var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(i>0)e.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};le.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=rt.util.createBuffer(),this._partialBytes=0};le.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Pi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};le.ofb.prototype.encrypt=function(e,t,a){var r=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var n=0;n<this._ints;++n)t.putInt32(e.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(e.getInt32()^this._outBlock[n]);if(i>0)e.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0};le.ofb.prototype.decrypt=le.ofb.prototype.encrypt;le.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=rt.util.createBuffer(),this._partialBytes=0};le.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Pi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};le.ctr.prototype.encrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize)for(var n=0;n<this._ints;++n)t.putInt32(e.getInt32()^this._outBlock[n]);else{var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(e.getInt32()^this._outBlock[n]);if(i>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}Ui(this._inBlock)};le.ctr.prototype.decrypt=le.ctr.prototype.encrypt;le.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=rt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};le.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=rt.util.createBuffer(e.iv);this._cipherLength=0;var a;if("additionalData"in e?a=rt.util.createBuffer(e.additionalData):a=rt.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=rt.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var r=t.length();if(r===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(no(r*8)))}this._inBlock=this._j0.slice(0),Ui(this._inBlock),this._partialBytes=0,a=rt.util.createBuffer(a),this._aDataLength=no(a.length()*8);var n=a.length()%this.blockSize;for(n&&a.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];a.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[a.getInt32(),a.getInt32(),a.getInt32(),a.getInt32()])};le.gcm.prototype.encrypt=function(e,t,a){var r=e.length();if(r===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&r>=this.blockSize){for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]^=e.getInt32());this._cipherLength+=this.blockSize}else{var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(e.getInt32()^this._outBlock[n]);if(i<=0||a){if(a){var s=r%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!a)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Ui(this._inBlock)};le.gcm.prototype.decrypt=function(e,t,a){var r=e.length();if(r<this.blockSize&&!(a&&r>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Ui(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]^this._hashBlock[n]);r<this.blockSize?this._cipherLength+=r%this.blockSize:this._cipherLength+=this.blockSize};le.gcm.prototype.afterFinish=function(e,t){var a=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=rt.util.createBuffer();var r=this._aDataLength.concat(no(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,r);var n=[];this.cipher.encrypt(this._j0,n);for(var i=0;i<this._ints;++i)this.tag.putInt32(this._s[i]^n[i]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(a=!1),a};le.gcm.prototype.multiply=function(e,t){for(var a=[0,0,0,0],r=t.slice(0),n=0;n<128;++n){var i=e[n/32|0]&1<<31-n%32;i&&(a[0]^=r[0],a[1]^=r[1],a[2]^=r[2],a[3]^=r[3]),this.pow(r,r)}return a};le.gcm.prototype.pow=function(e,t){for(var a=e[3]&1,r=3;r>0;--r)t[r]=e[r]>>>1|(e[r-1]&1)<<31;t[0]=e[0]>>>1,a&&(t[0]^=this._R)};le.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],a=0;a<32;++a){var r=a/8|0,n=e[r]>>>(7-a%8)*4&15,i=this._m[a][n];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t};le.gcm.prototype.ghash=function(e,t,a){return t[0]^=a[0],t[1]^=a[1],t[2]^=a[2],t[3]^=a[3],this.tableMultiply(t)};le.gcm.prototype.generateHashTable=function(e,t){for(var a=8/t,r=4*a,n=16*a,i=new Array(n),s=0;s<n;++s){var u=[0,0,0,0],c=s/r|0,f=(r-1-s%r)*t;u[c]=1<<t-1<<f,i[s]=this.generateSubHashTable(this.multiply(u,e),t)}return i};le.gcm.prototype.generateSubHashTable=function(e,t){var a=1<<t,r=a>>>1,n=new Array(a);n[r]=e.slice(0);for(var i=r>>>1;i>0;)this.pow(n[2*i],n[i]=[]),i>>=1;for(i=2;i<r;){for(var s=1;s<i;++s){var u=n[i],c=n[s];n[i+s]=[u[0]^c[0],u[1]^c[1],u[2]^c[2],u[3]^c[3]]}i*=2}for(n[0]=[0,0,0,0],i=r+1;i<a;++i){var f=n[i^r];n[i]=[e[0]^f[0],e[1]^f[1],e[2]^f[2],e[3]^f[3]]}return n};function Pi(e,t){if(typeof e=="string"&&(e=rt.util.createBuffer(e)),rt.util.isArray(e)&&e.length>4){var a=e;e=rt.util.createBuffer();for(var r=0;r<a.length;++r)e.putByte(a[r])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!rt.util.isArray(e)){for(var n=[],i=t/4,r=0;r<i;++r)n.push(e.getInt32());e=n}return e}function Ui(e){e[e.length-1]=e[e.length-1]+1&4294967295}function no(e){return[e/4294967296|0,e&4294967295]}});var Or=ne((zv,mf)=>{var Ne=ue();ki();io();me();mf.exports=Ne.aes=Ne.aes||{};Ne.aes.startEncrypting=function(e,t,a,r){var n=Oi({key:e,output:a,decrypt:!1,mode:r});return n.start(t),n};Ne.aes.createEncryptionCipher=function(e,t){return Oi({key:e,output:null,decrypt:!1,mode:t})};Ne.aes.startDecrypting=function(e,t,a,r){var n=Oi({key:e,output:a,decrypt:!0,mode:r});return n.start(t),n};Ne.aes.createDecryptionCipher=function(e,t){return Oi({key:e,output:null,decrypt:!0,mode:t})};Ne.aes.Algorithm=function(e,t){uo||yf();var a=this;a.name=e,a.mode=new t({blockSize:16,cipher:{encrypt:function(r,n){return oo(a._w,r,n,!1)},decrypt:function(r,n){return oo(a._w,r,n,!0)}}}),a._init=!1};Ne.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,a;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=Ne.util.createBuffer(t);else if(Ne.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){a=t,t=Ne.util.createBuffer();for(var r=0;r<a.length;++r)t.putByte(a[r])}if(!Ne.util.isArray(t)){a=t,t=[];var n=a.length();if(n===16||n===24||n===32){n=n>>>2;for(var r=0;r<n;++r)t.push(a.getInt32())}}if(!Ne.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var i=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(i)!==-1;this._w=gf(t,e.decrypt&&!s),this._init=!0}};Ne.aes._expandKey=function(e,t){return uo||yf(),gf(e,t)};Ne.aes._updateBlock=oo;Ra("AES-ECB",Ne.cipher.modes.ecb);Ra("AES-CBC",Ne.cipher.modes.cbc);Ra("AES-CFB",Ne.cipher.modes.cfb);Ra("AES-OFB",Ne.cipher.modes.ofb);Ra("AES-CTR",Ne.cipher.modes.ctr);Ra("AES-GCM",Ne.cipher.modes.gcm);function Ra(e,t){var a=function(){return new Ne.aes.Algorithm(e,t)};Ne.cipher.registerAlgorithm(e,a)}var uo=!1,wa=4,pt,so,pf,aa,Gt;function yf(){uo=!0,pf=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;pt=new Array(256),so=new Array(256),aa=new Array(4),Gt=new Array(4);for(var t=0;t<4;++t)aa[t]=new Array(256),Gt[t]=new Array(256);for(var a=0,r=0,n,i,s,u,c,f,d,t=0;t<256;++t){u=r^r<<1^r<<2^r<<3^r<<4,u=u>>8^u&255^99,pt[a]=u,so[u]=a,c=e[u],n=e[a],i=e[n],s=e[i],f=c<<24^u<<16^u<<8^(u^c),d=(n^i^s)<<24^(a^s)<<16^(a^i^s)<<8^(a^n^s);for(var h=0;h<4;++h)aa[h][a]=f,Gt[h][u]=d,f=f<<24|f>>>8,d=d<<24|d>>>8;a===0?a=r=1:(a=n^e[e[e[n^s]]],r^=e[e[r]])}}function gf(e,t){for(var a=e.slice(0),r,n=1,i=a.length,s=i+6+1,u=wa*s,c=i;c<u;++c)r=a[c-1],c%i===0?(r=pt[r>>>16&255]<<24^pt[r>>>8&255]<<16^pt[r&255]<<8^pt[r>>>24]^pf[n]<<24,n++):i>6&&c%i===4&&(r=pt[r>>>24]<<24^pt[r>>>16&255]<<16^pt[r>>>8&255]<<8^pt[r&255]),a[c]=a[c-i]^r;if(t){var f,d=Gt[0],h=Gt[1],C=Gt[2],E=Gt[3],g=a.slice(0);u=a.length;for(var c=0,_=u-wa;c<u;c+=wa,_-=wa)if(c===0||c===u-wa)g[c]=a[_],g[c+1]=a[_+3],g[c+2]=a[_+2],g[c+3]=a[_+1];else for(var S=0;S<wa;++S)f=a[_+S],g[c+(3&-S)]=d[pt[f>>>24]]^h[pt[f>>>16&255]]^C[pt[f>>>8&255]]^E[pt[f&255]];a=g}return a}function oo(e,t,a,r){var n=e.length/4-1,i,s,u,c,f;r?(i=Gt[0],s=Gt[1],u=Gt[2],c=Gt[3],f=so):(i=aa[0],s=aa[1],u=aa[2],c=aa[3],f=pt);var d,h,C,E,g,_,S;d=t[0]^e[0],h=t[r?3:1]^e[1],C=t[2]^e[2],E=t[r?1:3]^e[3];for(var b=3,A=1;A<n;++A)g=i[d>>>24]^s[h>>>16&255]^u[C>>>8&255]^c[E&255]^e[++b],_=i[h>>>24]^s[C>>>16&255]^u[E>>>8&255]^c[d&255]^e[++b],S=i[C>>>24]^s[E>>>16&255]^u[d>>>8&255]^c[h&255]^e[++b],E=i[E>>>24]^s[d>>>16&255]^u[h>>>8&255]^c[C&255]^e[++b],d=g,h=_,C=S;a[0]=f[d>>>24]<<24^f[h>>>16&255]<<16^f[C>>>8&255]<<8^f[E&255]^e[++b],a[r?3:1]=f[h>>>24]<<24^f[C>>>16&255]<<16^f[E>>>8&255]<<8^f[d&255]^e[++b],a[2]=f[C>>>24]<<24^f[E>>>16&255]<<16^f[d>>>8&255]<<8^f[h&255]^e[++b],a[r?1:3]=f[E>>>24]<<24^f[d>>>16&255]<<16^f[h>>>8&255]<<8^f[C&255]^e[++b]}function Oi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),a="AES-"+t,r;e.decrypt?r=Ne.cipher.createDecipher(a,e.key):r=Ne.cipher.createCipher(a,e.key);var n=r.start;return r.start=function(i,s){var u=null;s instanceof Ne.util.ByteBuffer&&(u=s,s={}),s=s||{},s.output=u,s.iv=i,n.call(r,s)},r}});var Fr=ne((Wv,vf)=>{var Tn=ue();Tn.pki=Tn.pki||{};var lo=vf.exports=Tn.pki.oids=Tn.oids=Tn.oids||{};function M(e,t){lo[e]=t,lo[t]=e}function be(e,t){lo[e]=t}M("1.2.840.113549.1.1.1","rsaEncryption");M("1.2.840.113549.1.1.4","md5WithRSAEncryption");M("1.2.840.113549.1.1.5","sha1WithRSAEncryption");M("1.2.840.113549.1.1.7","RSAES-OAEP");M("1.2.840.113549.1.1.8","mgf1");M("1.2.840.113549.1.1.9","pSpecified");M("1.2.840.113549.1.1.10","RSASSA-PSS");M("1.2.840.113549.1.1.11","sha256WithRSAEncryption");M("1.2.840.113549.1.1.12","sha384WithRSAEncryption");M("1.2.840.113549.1.1.13","sha512WithRSAEncryption");M("1.3.101.112","EdDSA25519");M("1.2.840.10040.4.3","dsa-with-sha1");M("1.3.14.3.2.7","desCBC");M("1.3.14.3.2.26","sha1");M("1.3.14.3.2.29","sha1WithRSASignature");M("2.16.840.1.101.3.4.2.1","sha256");M("2.16.840.1.101.3.4.2.2","sha384");M("2.16.840.1.101.3.4.2.3","sha512");M("2.16.840.1.101.3.4.2.4","sha224");M("2.16.840.1.101.3.4.2.5","sha512-224");M("2.16.840.1.101.3.4.2.6","sha512-256");M("1.2.840.113549.2.2","md2");M("1.2.840.113549.2.5","md5");M("1.2.840.113549.1.7.1","data");M("1.2.840.113549.1.7.2","signedData");M("1.2.840.113549.1.7.3","envelopedData");M("1.2.840.113549.1.7.4","signedAndEnvelopedData");M("1.2.840.113549.1.7.5","digestedData");M("1.2.840.113549.1.7.6","encryptedData");M("1.2.840.113549.1.9.1","emailAddress");M("1.2.840.113549.1.9.2","unstructuredName");M("1.2.840.113549.1.9.3","contentType");M("1.2.840.113549.1.9.4","messageDigest");M("1.2.840.113549.1.9.5","signingTime");M("1.2.840.113549.1.9.6","counterSignature");M("1.2.840.113549.1.9.7","challengePassword");M("1.2.840.113549.1.9.8","unstructuredAddress");M("1.2.840.113549.1.9.14","extensionRequest");M("1.2.840.113549.1.9.20","friendlyName");M("1.2.840.113549.1.9.21","localKeyId");M("1.2.840.113549.1.9.22.1","x509Certificate");M("1.2.840.113549.1.12.10.1.1","keyBag");M("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");M("1.2.840.113549.1.12.10.1.3","certBag");M("1.2.840.113549.1.12.10.1.4","crlBag");M("1.2.840.113549.1.12.10.1.5","secretBag");M("1.2.840.113549.1.12.10.1.6","safeContentsBag");M("1.2.840.113549.1.5.13","pkcs5PBES2");M("1.2.840.113549.1.5.12","pkcs5PBKDF2");M("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");M("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");M("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");M("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");M("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");M("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");M("1.2.840.113549.2.7","hmacWithSHA1");M("1.2.840.113549.2.8","hmacWithSHA224");M("1.2.840.113549.2.9","hmacWithSHA256");M("1.2.840.113549.2.10","hmacWithSHA384");M("1.2.840.113549.2.11","hmacWithSHA512");M("1.2.840.113549.3.7","des-EDE3-CBC");M("2.16.840.1.101.3.4.1.2","aes128-CBC");M("2.16.840.1.101.3.4.1.22","aes192-CBC");M("2.16.840.1.101.3.4.1.42","aes256-CBC");M("2.5.4.3","commonName");M("2.5.4.4","surname");M("2.5.4.5","serialNumber");M("2.5.4.6","countryName");M("2.5.4.7","localityName");M("2.5.4.8","stateOrProvinceName");M("2.5.4.9","streetAddress");M("2.5.4.10","organizationName");M("2.5.4.11","organizationalUnitName");M("2.5.4.12","title");M("2.5.4.13","description");M("2.5.4.15","businessCategory");M("2.5.4.17","postalCode");M("2.5.4.42","givenName");M("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");M("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");M("2.16.840.1.113730.1.1","nsCertType");M("2.16.840.1.113730.1.13","nsComment");be("2.5.29.1","authorityKeyIdentifier");be("2.5.29.2","keyAttributes");be("2.5.29.3","certificatePolicies");be("2.5.29.4","keyUsageRestriction");be("2.5.29.5","policyMapping");be("2.5.29.6","subtreesConstraint");be("2.5.29.7","subjectAltName");be("2.5.29.8","issuerAltName");be("2.5.29.9","subjectDirectoryAttributes");be("2.5.29.10","basicConstraints");be("2.5.29.11","nameConstraints");be("2.5.29.12","policyConstraints");be("2.5.29.13","basicConstraints");M("2.5.29.14","subjectKeyIdentifier");M("2.5.29.15","keyUsage");be("2.5.29.16","privateKeyUsagePeriod");M("2.5.29.17","subjectAltName");M("2.5.29.18","issuerAltName");M("2.5.29.19","basicConstraints");be("2.5.29.20","cRLNumber");be("2.5.29.21","cRLReason");be("2.5.29.22","expirationDate");be("2.5.29.23","instructionCode");be("2.5.29.24","invalidityDate");be("2.5.29.25","cRLDistributionPoints");be("2.5.29.26","issuingDistributionPoint");be("2.5.29.27","deltaCRLIndicator");be("2.5.29.28","issuingDistributionPoint");be("2.5.29.29","certificateIssuer");be("2.5.29.30","nameConstraints");M("2.5.29.31","cRLDistributionPoints");M("2.5.29.32","certificatePolicies");be("2.5.29.33","policyMappings");be("2.5.29.34","policyConstraints");M("2.5.29.35","authorityKeyIdentifier");be("2.5.29.36","policyConstraints");M("2.5.29.37","extKeyUsage");be("2.5.29.46","freshestCRL");be("2.5.29.54","inhibitAnyPolicy");M("1.3.6.1.4.1.11129.2.4.2","timestampList");M("1.3.6.1.5.5.7.1.1","authorityInfoAccess");M("1.3.6.1.5.5.7.3.1","serverAuth");M("1.3.6.1.5.5.7.3.2","clientAuth");M("1.3.6.1.5.5.7.3.3","codeSigning");M("1.3.6.1.5.5.7.3.4","emailProtection");M("1.3.6.1.5.5.7.3.8","timeStamping")});var Qt=ne((Gv,Sf)=>{var ke=ue();me();Fr();var Q=Sf.exports=ke.asn1=ke.asn1||{};Q.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Q.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Q.create=function(e,t,a,r,n){if(ke.util.isArray(r)){for(var i=[],s=0;s<r.length;++s)r[s]!==void 0&&i.push(r[s]);r=i}var u={tagClass:e,type:t,constructed:a,composed:a||ke.util.isArray(r),value:r};return n&&"bitStringContents"in n&&(u.bitStringContents=n.bitStringContents,u.original=Q.copy(u)),u};Q.copy=function(e,t){var a;if(ke.util.isArray(e)){a=[];for(var r=0;r<e.length;++r)a.push(Q.copy(e[r],t));return a}return typeof e=="string"?e:(a={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:Q.copy(e.value,t)},t&&!t.excludeBitStringContents&&(a.bitStringContents=e.bitStringContents),a)};Q.equals=function(e,t,a){if(ke.util.isArray(e)){if(!ke.util.isArray(t)||e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!Q.equals(e[r],t[r]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var n=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&Q.equals(e.value,t.value);return a&&a.includeBitStringContents&&(n=n&&e.bitStringContents===t.bitStringContents),n};Q.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var a,r=t&128;return r?a=e.getInt((t&127)<<3):a=t,a}};function An(e,t,a){if(a>t){var r=new Error("Too few bytes to parse DER.");throw r.available=e.length(),r.remaining=t,r.requested=a,r}}var Ph=function(e,t){var a=e.getByte();if(t--,a!==128){var r,n=a&128;if(!n)r=a;else{var i=a&127;An(e,t,i),r=e.getInt(i<<3)}if(r<0)throw new Error("Negative length: "+r);return r}};Q.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=ke.util.createBuffer(e));var a=e.length(),r=Fi(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var n=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw n.byteCount=a,n.remaining=e.length(),n}return r};function Fi(e,t,a,r){var n;An(e,t,2);var i=e.getByte();t--;var s=i&192,u=i&31;n=e.length();var c=Ph(e,t);if(t-=n-e.length(),c!==void 0&&c>t){if(r.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=e.length(),f.remaining=t,f.requested=c,f}c=t}var d,h,C=(i&32)===32;if(C)if(d=[],c===void 0)for(;;){if(An(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}n=e.length(),d.push(Fi(e,t,a+1,r)),t-=n-e.length()}else for(;c>0;)n=e.length(),d.push(Fi(e,c,a+1,r)),t-=n-e.length(),c-=n-e.length();if(d===void 0&&s===Q.Class.UNIVERSAL&&u===Q.Type.BITSTRING&&(h=e.bytes(c)),d===void 0&&r.decodeBitStrings&&s===Q.Class.UNIVERSAL&&u===Q.Type.BITSTRING&&c>1){var E=e.read,g=t,_=0;if(u===Q.Type.BITSTRING&&(An(e,t,1),_=e.getByte(),t--),_===0)try{n=e.length();var S={strict:!0,decodeBitStrings:!0},b=Fi(e,t,a+1,S),A=n-e.length();t-=A,u==Q.Type.BITSTRING&&A++;var w=b.tagClass;A===c&&(w===Q.Class.UNIVERSAL||w===Q.Class.CONTEXT_SPECIFIC)&&(d=[b])}catch{}d===void 0&&(e.read=E,t=g)}if(d===void 0){if(c===void 0){if(r.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=t}if(u===Q.Type.BMPSTRING)for(d="";c>0;c-=2)An(e,t,2),d+=String.fromCharCode(e.getInt16()),t-=2;else d=e.getBytes(c),t-=c}var D=h===void 0?null:{bitStringContents:h};return Q.create(s,u,C,d,D)}Q.toDer=function(e){var t=ke.util.createBuffer(),a=e.tagClass|e.type,r=ke.util.createBuffer(),n=!1;if("bitStringContents"in e&&(n=!0,e.original&&(n=Q.equals(e,e.original))),n)r.putBytes(e.bitStringContents);else if(e.composed){e.constructed?a|=32:r.putByte(0);for(var i=0;i<e.value.length;++i)e.value[i]!==void 0&&r.putBuffer(Q.toDer(e.value[i]))}else if(e.type===Q.Type.BMPSTRING)for(var i=0;i<e.value.length;++i)r.putInt16(e.value.charCodeAt(i));else e.type===Q.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&(e.value.charCodeAt(1)&128)===0||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?r.putBytes(e.value.substr(1)):r.putBytes(e.value);if(t.putByte(a),r.length()<=127)t.putByte(r.length()&127);else{var s=r.length(),u="";do u+=String.fromCharCode(s&255),s=s>>>8;while(s>0);t.putByte(u.length|128);for(var i=u.length-1;i>=0;--i)t.putByte(u.charCodeAt(i))}return t.putBuffer(r),t};Q.oidToDer=function(e){var t=e.split("."),a=ke.util.createBuffer();a.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var r,n,i,s,u=2;u<t.length;++u){r=!0,n=[],i=parseInt(t[u],10);do s=i&127,i=i>>>7,r||(s|=128),n.push(s),r=!1;while(i>0);for(var c=n.length-1;c>=0;--c)a.putByte(n[c])}return a};Q.derToOid=function(e){var t;typeof e=="string"&&(e=ke.util.createBuffer(e));var a=e.getByte();t=Math.floor(a/40)+"."+a%40;for(var r=0;e.length()>0;)a=e.getByte(),r=r<<7,a&128?r+=a&127:(t+="."+(r+a),r=0);return t};Q.utcTimeToDate=function(e){var t=new Date,a=parseInt(e.substr(0,2),10);a=a>=50?1900+a:2e3+a;var r=parseInt(e.substr(2,2),10)-1,n=parseInt(e.substr(4,2),10),i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),u=0;if(e.length>11){var c=e.charAt(10),f=10;c!=="+"&&c!=="-"&&(u=parseInt(e.substr(10,2),10),f+=2)}if(t.setUTCFullYear(a,r,n),t.setUTCHours(i,s,u,0),f&&(c=e.charAt(f),c==="+"||c==="-")){var d=parseInt(e.substr(f+1,2),10),h=parseInt(e.substr(f+4,2),10),C=d*60+h;C*=6e4,c==="+"?t.setTime(+t-C):t.setTime(+t+C)}return t};Q.generalizedTimeToDate=function(e){var t=new Date,a=parseInt(e.substr(0,4),10),r=parseInt(e.substr(4,2),10)-1,n=parseInt(e.substr(6,2),10),i=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),u=parseInt(e.substr(12,2),10),c=0,f=0,d=!1;e.charAt(e.length-1)==="Z"&&(d=!0);var h=e.length-5,C=e.charAt(h);if(C==="+"||C==="-"){var E=parseInt(e.substr(h+1,2),10),g=parseInt(e.substr(h+4,2),10);f=E*60+g,f*=6e4,C==="+"&&(f*=-1),d=!0}return e.charAt(14)==="."&&(c=parseFloat(e.substr(14),10)*1e3),d?(t.setUTCFullYear(a,r,n),t.setUTCHours(i,s,u,c),t.setTime(+t+f)):(t.setFullYear(a,r,n),t.setHours(i,s,u,c)),t};Q.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",a=[];a.push((""+e.getUTCFullYear()).substr(2)),a.push(""+(e.getUTCMonth()+1)),a.push(""+e.getUTCDate()),a.push(""+e.getUTCHours()),a.push(""+e.getUTCMinutes()),a.push(""+e.getUTCSeconds());for(var r=0;r<a.length;++r)a[r].length<2&&(t+="0"),t+=a[r];return t+="Z",t};Q.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",a=[];a.push(""+e.getUTCFullYear()),a.push(""+(e.getUTCMonth()+1)),a.push(""+e.getUTCDate()),a.push(""+e.getUTCHours()),a.push(""+e.getUTCMinutes()),a.push(""+e.getUTCSeconds());for(var r=0;r<a.length;++r)a[r].length<2&&(t+="0"),t+=a[r];return t+="Z",t};Q.integerToDer=function(e){var t=ke.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var a=new Error("Integer too large; max is 32-bits.");throw a.integer=e,a};Q.derToInteger=function(e){typeof e=="string"&&(e=ke.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};Q.validate=function(e,t,a,r){var n=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(n=!0,t.value&&ke.util.isArray(t.value))for(var i=0,s=0;n&&s<t.value.length;++s)n=t.value[s].optional||!1,e.value[i]&&(n=Q.validate(e.value[i],t.value[s],a,r),n?++i:t.value[s].optional&&(n=!0)),!n&&r&&r.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(n&&a&&(t.capture&&(a[t.capture]=e.value),t.captureAsn1&&(a[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(a[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var u;if(e.bitStringContents.length<2)a[t.captureBitStringValue]="";else{var c=e.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");a[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else r&&r.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else r&&(e.tagClass!==t.tagClass&&r.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&r.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return n};var Cf=/[^\\u0000-\\u00ff]/;Q.prettyPrint=function(e,t,a){var r="";t=t||0,a=a||2,t>0&&(r+=`
`);for(var n="",i=0;i<t*a;++i)n+=" ";switch(r+=n+"Tag: ",e.tagClass){case Q.Class.UNIVERSAL:r+="Universal:";break;case Q.Class.APPLICATION:r+="Application:";break;case Q.Class.CONTEXT_SPECIFIC:r+="Context-Specific:";break;case Q.Class.PRIVATE:r+="Private:";break}if(e.tagClass===Q.Class.UNIVERSAL)switch(r+=e.type,e.type){case Q.Type.NONE:r+=" (None)";break;case Q.Type.BOOLEAN:r+=" (Boolean)";break;case Q.Type.INTEGER:r+=" (Integer)";break;case Q.Type.BITSTRING:r+=" (Bit string)";break;case Q.Type.OCTETSTRING:r+=" (Octet string)";break;case Q.Type.NULL:r+=" (Null)";break;case Q.Type.OID:r+=" (Object Identifier)";break;case Q.Type.ODESC:r+=" (Object Descriptor)";break;case Q.Type.EXTERNAL:r+=" (External or Instance of)";break;case Q.Type.REAL:r+=" (Real)";break;case Q.Type.ENUMERATED:r+=" (Enumerated)";break;case Q.Type.EMBEDDED:r+=" (Embedded PDV)";break;case Q.Type.UTF8:r+=" (UTF8)";break;case Q.Type.ROID:r+=" (Relative Object Identifier)";break;case Q.Type.SEQUENCE:r+=" (Sequence)";break;case Q.Type.SET:r+=" (Set)";break;case Q.Type.PRINTABLESTRING:r+=" (Printable String)";break;case Q.Type.IA5String:r+=" (IA5String (ASCII))";break;case Q.Type.UTCTIME:r+=" (UTC time)";break;case Q.Type.GENERALIZEDTIME:r+=" (Generalized time)";break;case Q.Type.BMPSTRING:r+=" (BMP String)";break}else r+=e.type;if(r+=`
`,r+=n+"Constructed: "+e.constructed+`
`,e.composed){for(var s=0,u="",i=0;i<e.value.length;++i)e.value[i]!==void 0&&(s+=1,u+=Q.prettyPrint(e.value[i],t+1,a),i+1<e.value.length&&(u+=","));r+=n+"Sub values: "+s+u}else{if(r+=n+"Value: ",e.type===Q.Type.OID){var c=Q.derToOid(e.value);r+=c,ke.pki&&ke.pki.oids&&c in ke.pki.oids&&(r+=" ("+ke.pki.oids[c]+") ")}if(e.type===Q.Type.INTEGER)try{r+=Q.derToInteger(e.value)}catch{r+="0x"+ke.util.bytesToHex(e.value)}else if(e.type===Q.Type.BITSTRING){if(e.value.length>1?r+="0x"+ke.util.bytesToHex(e.value.slice(1)):r+="(none)",e.value.length>0){var f=e.value.charCodeAt(0);f==1?r+=" (1 unused bit shown)":f>1&&(r+=" ("+f+" unused bits shown)")}}else if(e.type===Q.Type.OCTETSTRING)Cf.test(e.value)||(r+="("+e.value+") "),r+="0x"+ke.util.bytesToHex(e.value);else if(e.type===Q.Type.UTF8)try{r+=ke.util.decodeUtf8(e.value)}catch(d){if(d.message==="URI malformed")r+="0x"+ke.util.bytesToHex(e.value)+" (malformed UTF8)";else throw d}else e.type===Q.Type.PRINTABLESTRING||e.type===Q.Type.IA5String?r+=e.value:Cf.test(e.value)?r+="0x"+ke.util.bytesToHex(e.value):e.value.length===0?r+="[null]":r+=e.value}return r}});var Jt=ne((Qv,Ef)=>{var Vi=ue();Ef.exports=Vi.md=Vi.md||{};Vi.md.algorithms=Vi.md.algorithms||{}});var Na=ne((jv,bf)=>{var Sr=ue();Jt();me();var Uh=bf.exports=Sr.hmac=Sr.hmac||{};Uh.create=function(){var e=null,t=null,a=null,r=null,n={};return n.start=function(i,s){if(i!==null)if(typeof i=="string")if(i=i.toLowerCase(),i in Sr.md.algorithms)t=Sr.md.algorithms[i].create();else throw new Error('Unknown hash algorithm "'+i+'"');else t=i;if(s===null)s=e;else{if(typeof s=="string")s=Sr.util.createBuffer(s);else if(Sr.util.isArray(s)){var u=s;s=Sr.util.createBuffer();for(var c=0;c<u.length;++c)s.putByte(u[c])}var f=s.length();f>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),a=Sr.util.createBuffer(),r=Sr.util.createBuffer(),f=s.length();for(var c=0;c<f;++c){var u=s.at(c);a.putByte(54^u),r.putByte(92^u)}if(f<t.blockLength)for(var u=t.blockLength-f,c=0;c<u;++c)a.putByte(54),r.putByte(92);e=s,a=a.bytes(),r=r.bytes()}t.start(),t.update(a)},n.update=function(i){t.update(i)},n.getMac=function(){var i=t.digest().bytes();return t.start(),t.update(r),t.update(i),t.digest()},n.digest=n.getMac,n}});var Mi=ne(($v,_f)=>{var er=ue();Jt();me();var Tf=_f.exports=er.md5=er.md5||{};er.md.md5=er.md.algorithms.md5=Tf;Tf.create=function(){Af||Oh();var e=null,t=er.util.createBuffer(),a=new Array(16),r={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var n=r.messageLengthSize/4,i=0;i<n;++i)r.fullMessageLength.push(0);return t=er.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},r},r.start(),r.update=function(n,i){i==="utf8"&&(n=er.util.encodeUtf8(n));var s=n.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var u=r.fullMessageLength.length-1;u>=0;--u)r.fullMessageLength[u]+=s[1],s[1]=s[0]+(r.fullMessageLength[u]/4294967296>>>0),r.fullMessageLength[u]=r.fullMessageLength[u]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(n),xf(e,a,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var n=er.util.createBuffer();n.putBytes(t.bytes());var i=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=i&r.blockLength-1;n.putBytes(fo.substr(0,r.blockLength-s));for(var u,c=0,f=r.fullMessageLength.length-1;f>=0;--f)u=r.fullMessageLength[f]*8+c,c=u/4294967296>>>0,n.putInt32Le(u>>>0);var d={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};xf(d,a,n);var h=er.util.createBuffer();return h.putInt32Le(d.h0),h.putInt32Le(d.h1),h.putInt32Le(d.h2),h.putInt32Le(d.h3),h},r};var fo=null,qi=null,_n=null,La=null,Af=!1;function Oh(){fo=String.fromCharCode(128),fo+=er.util.fillString(String.fromCharCode(0),64),qi=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],_n=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],La=new Array(64);for(var e=0;e<64;++e)La[e]=Math.floor(Math.abs(Math.sin(e+1))*4294967296);Af=!0}function xf(e,t,a){for(var r,n,i,s,u,c,f,d,h=a.length();h>=64;){for(n=e.h0,i=e.h1,s=e.h2,u=e.h3,d=0;d<16;++d)t[d]=a.getInt32Le(),c=u^i&(s^u),r=n+c+La[d]+t[d],f=_n[d],n=u,u=s,s=i,i+=r<<f|r>>>32-f;for(;d<32;++d)c=s^u&(i^s),r=n+c+La[d]+t[qi[d]],f=_n[d],n=u,u=s,s=i,i+=r<<f|r>>>32-f;for(;d<48;++d)c=i^s^u,r=n+c+La[d]+t[qi[d]],f=_n[d],n=u,u=s,s=i,i+=r<<f|r>>>32-f;for(;d<64;++d)c=s^(i|~u),r=n+c+La[d]+t[qi[d]],f=_n[d],n=u,u=s,s=i,i+=r<<f|r>>>32-f;e.h0=e.h0+n|0,e.h1=e.h1+i|0,e.h2=e.h2+s|0,e.h3=e.h3+u|0,h-=64}}});var na=ne((Yv,Bf)=>{var Hi=ue();me();var If=Bf.exports=Hi.pem=Hi.pem||{};If.encode=function(e,t){t=t||{};var a="-----BEGIN "+e.type+`-----\r
`,r;if(e.procType&&(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},a+=Ki(r)),e.contentDomain&&(r={name:"Content-Domain",values:[e.contentDomain]},a+=Ki(r)),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),a+=Ki(r)),e.headers)for(var n=0;n<e.headers.length;++n)a+=Ki(e.headers[n]);return e.procType&&(a+=`\r
`),a+=Hi.util.encode64(e.body,t.maxline||64)+`\r
`,a+="-----END "+e.type+`-----\r
`,a};If.decode=function(e){for(var t=[],a=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,r=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,i;i=a.exec(e),!!i;){var s=i[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var u={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Hi.util.decode64(i[3])};if(t.push(u),!!i[2]){for(var c=i[2].split(n),f=0;i&&f<c.length;){for(var d=c[f].replace(/\s+$/,""),h=f+1;h<c.length;++h){var C=c[h];if(!/\s/.test(C[0]))break;d+=C,f=h}if(i=d.match(r),i){for(var E={name:i[1],values:[]},g=i[2].split(","),_=0;_<g.length;++_)E.values.push(Fh(g[_]));if(u.procType)if(!u.contentDomain&&E.name==="Content-Domain")u.contentDomain=g[0]||"";else if(!u.dekInfo&&E.name==="DEK-Info"){if(E.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');u.dekInfo={algorithm:g[0],parameters:g[1]||null}}else u.headers.push(E);else{if(E.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(E.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');u.procType={version:g[0],type:g[1]}}}++f}if(u.procType==="ENCRYPTED"&&!u.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function Ki(e){for(var t=e.name+": ",a=[],r=function(c,f){return" "+f},n=0;n<e.values.length;++n)a.push(e.values[n].replace(/^(\S+\r\n)/,r));t+=a.join(",")+`\r
`;for(var i=0,s=-1,n=0;n<t.length;++n,++i)if(i>65&&s!==-1){var u=t[s];u===","?(++s,t=t.substr(0,s)+`\r
 `+t.substr(s)):t=t.substr(0,s)+`\r
`+u+t.substr(s+1),i=n-s-1,s=-1,++n}else(t[n]===" "||t[n]==="	"||t[n]===",")&&(s=n);return t}function Fh(e){return e.replace(/^\s+/,"")}});var In=ne((Xv,Rf)=>{var Fe=ue();ki();io();me();Rf.exports=Fe.des=Fe.des||{};Fe.des.startEncrypting=function(e,t,a,r){var n=zi({key:e,output:a,decrypt:!1,mode:r||(t===null?"ECB":"CBC")});return n.start(t),n};Fe.des.createEncryptionCipher=function(e,t){return zi({key:e,output:null,decrypt:!1,mode:t})};Fe.des.startDecrypting=function(e,t,a,r){var n=zi({key:e,output:a,decrypt:!0,mode:r||(t===null?"ECB":"CBC")});return n.start(t),n};Fe.des.createDecryptionCipher=function(e,t){return zi({key:e,output:null,decrypt:!0,mode:t})};Fe.des.Algorithm=function(e,t){var a=this;a.name=e,a.mode=new t({blockSize:8,cipher:{encrypt:function(r,n){return wf(a._keys,r,n,!1)},decrypt:function(r,n){return wf(a._keys,r,n,!0)}}}),a._init=!1};Fe.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=Fe.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=Qh(t),this._init=!0}};tr("DES-ECB",Fe.cipher.modes.ecb);tr("DES-CBC",Fe.cipher.modes.cbc);tr("DES-CFB",Fe.cipher.modes.cfb);tr("DES-OFB",Fe.cipher.modes.ofb);tr("DES-CTR",Fe.cipher.modes.ctr);tr("3DES-ECB",Fe.cipher.modes.ecb);tr("3DES-CBC",Fe.cipher.modes.cbc);tr("3DES-CFB",Fe.cipher.modes.cfb);tr("3DES-OFB",Fe.cipher.modes.ofb);tr("3DES-CTR",Fe.cipher.modes.ctr);function tr(e,t){var a=function(){return new Fe.des.Algorithm(e,t)};Fe.cipher.registerAlgorithm(e,a)}var Vh=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],qh=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Mh=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Kh=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Hh=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],zh=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Wh=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Gh=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Qh(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],a=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],r=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],i=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],u=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],d=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],C=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],E=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],_=e.length()>8?3:1,S=[],b=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],A=0,w,D=0;D<_;D++){var k=e.getInt32(),R=e.getInt32();w=(k>>>4^R)&252645135,R^=w,k^=w<<4,w=(R>>>-16^k)&65535,k^=w,R^=w<<-16,w=(k>>>2^R)&858993459,R^=w,k^=w<<2,w=(R>>>-16^k)&65535,k^=w,R^=w<<-16,w=(k>>>1^R)&1431655765,R^=w,k^=w<<1,w=(R>>>8^k)&16711935,k^=w,R^=w<<8,w=(k>>>1^R)&1431655765,R^=w,k^=w<<1,w=k<<8|R>>>20&240,k=R<<24|R<<8&16711680|R>>>8&65280|R>>>24&240,R=w;for(var G=0;G<b.length;++G){b[G]?(k=k<<2|k>>>26,R=R<<2|R>>>26):(k=k<<1|k>>>27,R=R<<1|R>>>27),k&=-15,R&=-15;var q=t[k>>>28]|a[k>>>24&15]|r[k>>>20&15]|n[k>>>16&15]|i[k>>>12&15]|s[k>>>8&15]|u[k>>>4&15],Y=c[R>>>28]|f[R>>>24&15]|d[R>>>20&15]|h[R>>>16&15]|C[R>>>12&15]|E[R>>>8&15]|g[R>>>4&15];w=(Y>>>16^q)&65535,S[A++]=q^w,S[A++]=Y^w<<16}}return S}function wf(e,t,a,r){var n=e.length===32?3:9,i;n===3?i=r?[30,-2,-2]:[0,32,2]:i=r?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,u=t[0],c=t[1];s=(u>>>4^c)&252645135,c^=s,u^=s<<4,s=(u>>>16^c)&65535,c^=s,u^=s<<16,s=(c>>>2^u)&858993459,u^=s,c^=s<<2,s=(c>>>8^u)&16711935,u^=s,c^=s<<8,s=(u>>>1^c)&1431655765,c^=s,u^=s<<1,u=u<<1|u>>>31,c=c<<1|c>>>31;for(var f=0;f<n;f+=3){for(var d=i[f+1],h=i[f+2],C=i[f];C!=d;C+=h){var E=c^e[C],g=(c>>>4|c<<28)^e[C+1];s=u,u=c,c=s^(qh[E>>>24&63]|Kh[E>>>16&63]|zh[E>>>8&63]|Gh[E&63]|Vh[g>>>24&63]|Mh[g>>>16&63]|Hh[g>>>8&63]|Wh[g&63])}s=u,u=c,c=s}u=u>>>1|u<<31,c=c>>>1|c<<31,s=(u>>>1^c)&1431655765,c^=s,u^=s<<1,s=(c>>>8^u)&16711935,u^=s,c^=s<<8,s=(c>>>2^u)&858993459,u^=s,c^=s<<2,s=(u>>>16^c)&65535,c^=s,u^=s<<16,s=(u>>>4^c)&252645135,c^=s,u^=s<<4,a[0]=u,a[1]=c}function zi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),a="DES-"+t,r;e.decrypt?r=Fe.cipher.createDecipher(a,e.key):r=Fe.cipher.createCipher(a,e.key);var n=r.start;return r.start=function(i,s){var u=null;s instanceof Fe.util.ByteBuffer&&(u=s,s={}),s=s||{},s.output=u,s.iv=i,n.call(r,s)},r}});var Wi=ne((Zv,Nf)=>{var yt=ue();Na();Jt();me();var jh=yt.pkcs5=yt.pkcs5||{},Er;yt.util.isNodejs&&!yt.options.usePureJavaScript&&(Er=require("crypto"));Nf.exports=yt.pbkdf2=jh.pbkdf2=function(e,t,a,r,n,i){if(typeof n=="function"&&(i=n,n=null),yt.util.isNodejs&&!yt.options.usePureJavaScript&&Er.pbkdf2&&(n===null||typeof n!="object")&&(Er.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),i?Er.pbkdf2Sync.length===4?Er.pbkdf2(e,t,a,r,function(w,D){if(w)return i(w);i(null,D.toString("binary"))}):Er.pbkdf2(e,t,a,r,n,function(w,D){if(w)return i(w);i(null,D.toString("binary"))}):Er.pbkdf2Sync.length===4?Er.pbkdf2Sync(e,t,a,r).toString("binary"):Er.pbkdf2Sync(e,t,a,r,n).toString("binary");if((typeof n>"u"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in yt.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=yt.md[n].create()}var s=n.digestLength;if(r>4294967295*s){var u=new Error("Derived key is too long.");if(i)return i(u);throw u}var c=Math.ceil(r/s),f=r-(c-1)*s,d=yt.hmac.create();d.start(n,e);var h="",C,E,g;if(!i){for(var _=1;_<=c;++_){d.start(null,null),d.update(t),d.update(yt.util.int32ToBytes(_)),C=g=d.digest().getBytes();for(var S=2;S<=a;++S)d.start(null,null),d.update(g),E=d.digest().getBytes(),C=yt.util.xorBytes(C,E,s),g=E;h+=_<c?C:C.substr(0,f)}return h}var _=1,S;function b(){if(_>c)return i(null,h);d.start(null,null),d.update(t),d.update(yt.util.int32ToBytes(_)),C=g=d.digest().getBytes(),S=2,A()}function A(){if(S<=a)return d.start(null,null),d.update(g),E=d.digest().getBytes(),C=yt.util.xorBytes(C,E,s),g=E,++S,yt.util.setImmediate(A);h+=_<c?C:C.substr(0,f),++_,b()}b()}});var ho=ne((Jv,Uf)=>{var rr=ue();Jt();me();var Df=Uf.exports=rr.sha256=rr.sha256||{};rr.md.sha256=rr.md.algorithms.sha256=Df;Df.create=function(){kf||$h();var e=null,t=rr.util.createBuffer(),a=new Array(64),r={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var n=r.messageLengthSize/4,i=0;i<n;++i)r.fullMessageLength.push(0);return t=rr.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},r},r.start(),r.update=function(n,i){i==="utf8"&&(n=rr.util.encodeUtf8(n));var s=n.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var u=r.fullMessageLength.length-1;u>=0;--u)r.fullMessageLength[u]+=s[1],s[1]=s[0]+(r.fullMessageLength[u]/4294967296>>>0),r.fullMessageLength[u]=r.fullMessageLength[u]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(n),Lf(e,a,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var n=rr.util.createBuffer();n.putBytes(t.bytes());var i=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=i&r.blockLength-1;n.putBytes(co.substr(0,r.blockLength-s));for(var u,c,f=r.fullMessageLength[0]*8,d=0;d<r.fullMessageLength.length-1;++d)u=r.fullMessageLength[d+1]*8,c=u/4294967296>>>0,f+=c,n.putInt32(f>>>0),f=u>>>0;n.putInt32(f);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};Lf(h,a,n);var C=rr.util.createBuffer();return C.putInt32(h.h0),C.putInt32(h.h1),C.putInt32(h.h2),C.putInt32(h.h3),C.putInt32(h.h4),C.putInt32(h.h5),C.putInt32(h.h6),C.putInt32(h.h7),C},r};var co=null,kf=!1,Pf=null;function $h(){co=String.fromCharCode(128),co+=rr.util.fillString(String.fromCharCode(0),64),Pf=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],kf=!0}function Lf(e,t,a){for(var r,n,i,s,u,c,f,d,h,C,E,g,_,S,b,A=a.length();A>=64;){for(f=0;f<16;++f)t[f]=a.getInt32();for(;f<64;++f)r=t[f-2],r=(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,n=t[f-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,t[f]=r+t[f-7]+n+t[f-16]|0;for(d=e.h0,h=e.h1,C=e.h2,E=e.h3,g=e.h4,_=e.h5,S=e.h6,b=e.h7,f=0;f<64;++f)s=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7),u=S^g&(_^S),i=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),c=d&h|C&(d^h),r=b+s+u+Pf[f]+t[f],n=i+c,b=S,S=_,_=g,g=E+r>>>0,E=C,C=h,h=d,d=r+n>>>0;e.h0=e.h0+d|0,e.h1=e.h1+h|0,e.h2=e.h2+C|0,e.h3=e.h3+E|0,e.h4=e.h4+g|0,e.h5=e.h5+_|0,e.h6=e.h6+S|0,e.h7=e.h7+b|0,A-=64}}});var po=ne((e1,Of)=>{var ar=ue();me();var Gi=null;ar.util.isNodejs&&!ar.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Gi=require("crypto"));var Yh=Of.exports=ar.prng=ar.prng||{};Yh.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},a=e.md,r=new Array(32),n=0;n<32;++n)r[n]=a.create();t.pools=r,t.pool=0,t.generate=function(f,d){if(!d)return t.generateSync(f);var h=t.plugin.cipher,C=t.plugin.increment,E=t.plugin.formatKey,g=t.plugin.formatSeed,_=ar.util.createBuffer();t.key=null,S();function S(b){if(b)return d(b);if(_.length()>=f)return d(null,_.getBytes(f));if(t.generated>1048575&&(t.key=null),t.key===null)return ar.util.nextTick(function(){i(S)});var A=h(t.key,t.seed);t.generated+=A.length,_.putBytes(A),t.key=E(h(t.key,C(t.seed))),t.seed=g(h(t.key,t.seed)),ar.util.setImmediate(S)}},t.generateSync=function(f){var d=t.plugin.cipher,h=t.plugin.increment,C=t.plugin.formatKey,E=t.plugin.formatSeed;t.key=null;for(var g=ar.util.createBuffer();g.length()<f;){t.generated>1048575&&(t.key=null),t.key===null&&s();var _=d(t.key,t.seed);t.generated+=_.length,g.putBytes(_),t.key=C(d(t.key,h(t.seed))),t.seed=E(d(t.key,t.seed))}return g.getBytes(f)};function i(f){if(t.pools[0].messageLength>=32)return u(),f();var d=32-t.pools[0].messageLength<<5;t.seedFile(d,function(h,C){if(h)return f(h);t.collect(C),u(),f()})}function s(){if(t.pools[0].messageLength>=32)return u();var f=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(f)),u()}function u(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var f=t.plugin.md.create();f.update(t.keyBytes);for(var d=1,h=0;h<32;++h)t.reseeds%d===0&&(f.update(t.pools[h].digest().getBytes()),t.pools[h].start()),d=d<<1;t.keyBytes=f.digest().getBytes(),f.start(),f.update(t.keyBytes);var C=f.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(C),t.generated=0}function c(f){var d=null,h=ar.util.globalScope,C=h.crypto||h.msCrypto;C&&C.getRandomValues&&(d=function(k){return C.getRandomValues(k)});var E=ar.util.createBuffer();if(d)for(;E.length()<f;){var g=Math.max(1,Math.min(f-E.length(),65536)/4),_=new Uint32Array(Math.floor(g));try{d(_);for(var S=0;S<_.length;++S)E.putInt32(_[S])}catch(k){if(!(typeof QuotaExceededError<"u"&&k instanceof QuotaExceededError))throw k}}if(E.length()<f)for(var b,A,w,D=Math.floor(Math.random()*65536);E.length()<f;){A=16807*(D&65535),b=16807*(D>>16),A+=(b&32767)<<16,A+=b>>15,A=(A&2147483647)+(A>>31),D=A&4294967295;for(var S=0;S<3;++S)w=D>>>(S<<3),w^=Math.floor(Math.random()*256),E.putByte(w&255)}return E.getBytes(f)}return Gi?(t.seedFile=function(f,d){Gi.randomBytes(f,function(h,C){if(h)return d(h);d(null,C.toString())})},t.seedFileSync=function(f){return Gi.randomBytes(f).toString()}):(t.seedFile=function(f,d){try{d(null,c(f))}catch(h){d(h)}},t.seedFileSync=c),t.collect=function(f){for(var d=f.length,h=0;h<d;++h)t.pools[t.pool].update(f.substr(h,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(f,d){for(var h="",C=0;C<d;C+=8)h+=String.fromCharCode(f>>C&255);t.collect(h)},t.registerWorker=function(f){if(f===self)t.seedFile=function(h,C){function E(g){var _=g.data;_.forge&&_.forge.prng&&(self.removeEventListener("message",E),C(_.forge.prng.err,_.forge.prng.bytes))}self.addEventListener("message",E),self.postMessage({forge:{prng:{needed:h}}})};else{var d=function(h){var C=h.data;C.forge&&C.forge.prng&&t.seedFile(C.forge.prng.needed,function(E,g){f.postMessage({forge:{prng:{err:E,bytes:g}}})})};f.addEventListener("message",d)}},t}});var Pt=ne((t1,yo)=>{var at=ue();Or();ho();po();me();(function(){if(at.random&&at.random.getBytes){yo.exports=at.random;return}(function(e){var t={},a=new Array(4),r=at.util.createBuffer();t.formatKey=function(h){var C=at.util.createBuffer(h);return h=new Array(4),h[0]=C.getInt32(),h[1]=C.getInt32(),h[2]=C.getInt32(),h[3]=C.getInt32(),at.aes._expandKey(h,!1)},t.formatSeed=function(h){var C=at.util.createBuffer(h);return h=new Array(4),h[0]=C.getInt32(),h[1]=C.getInt32(),h[2]=C.getInt32(),h[3]=C.getInt32(),h},t.cipher=function(h,C){return at.aes._updateBlock(h,C,a,!1),r.putInt32(a[0]),r.putInt32(a[1]),r.putInt32(a[2]),r.putInt32(a[3]),r.getBytes()},t.increment=function(h){return++h[3],h},t.md=at.md.sha256;function n(){var h=at.prng.create(t);return h.getBytes=function(C,E){return h.generate(C,E)},h.getBytesSync=function(C){return h.generate(C)},h}var i=n(),s=null,u=at.util.globalScope,c=u.crypto||u.msCrypto;if(c&&c.getRandomValues&&(s=function(h){return c.getRandomValues(h)}),at.options.usePureJavaScript||!at.util.isNodejs&&!s){if(typeof window>"u"||window.document,i.collectInt(+new Date,32),typeof navigator<"u"){var f="";for(var d in navigator)try{typeof navigator[d]=="string"&&(f+=navigator[d])}catch{}i.collect(f),f=null}e&&(e().mousemove(function(h){i.collectInt(h.clientX,16),i.collectInt(h.clientY,16)}),e().keypress(function(h){i.collectInt(h.charCode,8)}))}if(!at.random)at.random=i;else for(var d in i)at.random[d]=i[d];at.random.createInstance=n,yo.exports=at.random})(typeof jQuery<"u"?jQuery:null)})()});var mo=ne((r1,qf)=>{var bt=ue();me();var go=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Ff=[1,2,3,5],Xh=function(e,t){return e<<t&65535|(e&65535)>>16-t},Zh=function(e,t){return(e&65535)>>t|e<<16-t&65535};qf.exports=bt.rc2=bt.rc2||{};bt.rc2.expandKey=function(e,t){typeof e=="string"&&(e=bt.util.createBuffer(e)),t=t||128;var a=e,r=e.length(),n=t,i=Math.ceil(n/8),s=255>>(n&7),u;for(u=r;u<128;u++)a.putByte(go[a.at(u-1)+a.at(u-r)&255]);for(a.setAt(128-i,go[a.at(128-i)&s]),u=127-i;u>=0;u--)a.setAt(u,go[a.at(u+1)^a.at(u+i)]);return a};var Vf=function(e,t,a){var r=!1,n=null,i=null,s=null,u,c,f,d,h=[];for(e=bt.rc2.expandKey(e,t),f=0;f<64;f++)h.push(e.getInt16Le());a?(u=function(g){for(f=0;f<4;f++)g[f]+=h[d]+(g[(f+3)%4]&g[(f+2)%4])+(~g[(f+3)%4]&g[(f+1)%4]),g[f]=Xh(g[f],Ff[f]),d++},c=function(g){for(f=0;f<4;f++)g[f]+=h[g[(f+3)%4]&63]}):(u=function(g){for(f=3;f>=0;f--)g[f]=Zh(g[f],Ff[f]),g[f]-=h[d]+(g[(f+3)%4]&g[(f+2)%4])+(~g[(f+3)%4]&g[(f+1)%4]),d--},c=function(g){for(f=3;f>=0;f--)g[f]-=h[g[(f+3)%4]&63]});var C=function(g){var _=[];for(f=0;f<4;f++){var S=n.getInt16Le();s!==null&&(a?S^=s.getInt16Le():s.putInt16Le(S)),_.push(S&65535)}d=a?0:63;for(var b=0;b<g.length;b++)for(var A=0;A<g[b][0];A++)g[b][1](_);for(f=0;f<4;f++)s!==null&&(a?s.putInt16Le(_[f]):_[f]^=s.getInt16Le()),i.putInt16Le(_[f])},E=null;return E={start:function(g,_){g&&typeof g=="string"&&(g=bt.util.createBuffer(g)),r=!1,n=bt.util.createBuffer(),i=_||new bt.util.createBuffer,s=g,E.output=i},update:function(g){for(r||n.putBuffer(g);n.length()>=8;)C([[5,u],[1,c],[6,u],[1,c],[5,u]])},finish:function(g){var _=!0;if(a)if(g)_=g(8,n,!a);else{var S=n.length()===8?8:8-n.length();n.fillWithByte(S,S)}if(_&&(r=!0,E.update()),!a&&(_=n.length()===0,_))if(g)_=g(8,i,!a);else{var b=i.length(),A=i.at(b-1);A>b?_=!1:i.truncate(A)}return _}},E};bt.rc2.startEncrypting=function(e,t,a){var r=bt.rc2.createEncryptionCipher(e,128);return r.start(t,a),r};bt.rc2.createEncryptionCipher=function(e,t){return Vf(e,t,!0)};bt.rc2.startDecrypting=function(e,t,a){var r=bt.rc2.createDecryptionCipher(e,128);return r.start(t,a),r};bt.rc2.createDecryptionCipher=function(e,t){return Vf(e,t,!1)}});var wn=ne((a1,jf)=>{var vo=ue();jf.exports=vo.jsbn=vo.jsbn||{};var br,Jh=0xdeadbeefcafe,Mf=(Jh&16777215)==15715070;function F(e,t,a){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,a):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}vo.jsbn.BigInteger=F;function ve(){return new F(null)}function ep(e,t,a,r,n,i){for(;--i>=0;){var s=t*this.data[e++]+a.data[r]+n;n=Math.floor(s/67108864),a.data[r++]=s&67108863}return n}function tp(e,t,a,r,n,i){for(var s=t&32767,u=t>>15;--i>=0;){var c=this.data[e]&32767,f=this.data[e++]>>15,d=u*c+f*s;c=s*c+((d&32767)<<15)+a.data[r]+(n&1073741823),n=(c>>>30)+(d>>>15)+u*f+(n>>>30),a.data[r++]=c&1073741823}return n}function Kf(e,t,a,r,n,i){for(var s=t&16383,u=t>>14;--i>=0;){var c=this.data[e]&16383,f=this.data[e++]>>14,d=u*c+f*s;c=s*c+((d&16383)<<14)+a.data[r]+n,n=(c>>28)+(d>>14)+u*f,a.data[r++]=c&268435455}return n}typeof navigator>"u"?(F.prototype.am=Kf,br=28):Mf&&navigator.appName=="Microsoft Internet Explorer"?(F.prototype.am=tp,br=30):Mf&&navigator.appName!="Netscape"?(F.prototype.am=ep,br=26):(F.prototype.am=Kf,br=28);F.prototype.DB=br;F.prototype.DM=(1<<br)-1;F.prototype.DV=1<<br;var Co=52;F.prototype.FV=Math.pow(2,Co);F.prototype.F1=Co-br;F.prototype.F2=2*br-Co;var rp="0123456789abcdefghijklmnopqrstuvwxyz",Qi=new Array,Da,Ut;Da="0".charCodeAt(0);for(Ut=0;Ut<=9;++Ut)Qi[Da++]=Ut;Da="a".charCodeAt(0);for(Ut=10;Ut<36;++Ut)Qi[Da++]=Ut;Da="A".charCodeAt(0);for(Ut=10;Ut<36;++Ut)Qi[Da++]=Ut;function Hf(e){return rp.charAt(e)}function zf(e,t){var a=Qi[e.charCodeAt(t)];return a??-1}function ap(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function np(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function Vr(e){var t=ve();return t.fromInt(e),t}function ip(e,t){var a;if(t==16)a=4;else if(t==8)a=3;else if(t==256)a=8;else if(t==2)a=1;else if(t==32)a=5;else if(t==4)a=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var r=e.length,n=!1,i=0;--r>=0;){var s=a==8?e[r]&255:zf(e,r);if(s<0){e.charAt(r)=="-"&&(n=!0);continue}n=!1,i==0?this.data[this.t++]=s:i+a>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-i)-1)<<i,this.data[this.t++]=s>>this.DB-i):this.data[this.t-1]|=s<<i,i+=a,i>=this.DB&&(i-=this.DB)}a==8&&(e[0]&128)!=0&&(this.s=-1,i>0&&(this.data[this.t-1]|=(1<<this.DB-i)-1<<i)),this.clamp(),n&&F.ZERO.subTo(this,this)}function sp(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function op(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var a=(1<<t)-1,r,n=!1,i="",s=this.t,u=this.DB-s*this.DB%t;if(s-- >0)for(u<this.DB&&(r=this.data[s]>>u)>0&&(n=!0,i=Hf(r));s>=0;)u<t?(r=(this.data[s]&(1<<u)-1)<<t-u,r|=this.data[--s]>>(u+=this.DB-t)):(r=this.data[s]>>(u-=t)&a,u<=0&&(u+=this.DB,--s)),r>0&&(n=!0),n&&(i+=Hf(r));return n?i:"0"}function up(){var e=ve();return F.ZERO.subTo(this,e),e}function lp(){return this.s<0?this.negate():this}function fp(e){var t=this.s-e.s;if(t!=0)return t;var a=this.t;if(t=a-e.t,t!=0)return this.s<0?-t:t;for(;--a>=0;)if((t=this.data[a]-e.data[a])!=0)return t;return 0}function ji(e){var t=1,a;return(a=e>>>16)!=0&&(e=a,t+=16),(a=e>>8)!=0&&(e=a,t+=8),(a=e>>4)!=0&&(e=a,t+=4),(a=e>>2)!=0&&(e=a,t+=2),(a=e>>1)!=0&&(e=a,t+=1),t}function cp(){return this.t<=0?0:this.DB*(this.t-1)+ji(this.data[this.t-1]^this.s&this.DM)}function dp(e,t){var a;for(a=this.t-1;a>=0;--a)t.data[a+e]=this.data[a];for(a=e-1;a>=0;--a)t.data[a]=0;t.t=this.t+e,t.s=this.s}function hp(e,t){for(var a=e;a<this.t;++a)t.data[a-e]=this.data[a];t.t=Math.max(this.t-e,0),t.s=this.s}function pp(e,t){var a=e%this.DB,r=this.DB-a,n=(1<<r)-1,i=Math.floor(e/this.DB),s=this.s<<a&this.DM,u;for(u=this.t-1;u>=0;--u)t.data[u+i+1]=this.data[u]>>r|s,s=(this.data[u]&n)<<a;for(u=i-1;u>=0;--u)t.data[u]=0;t.data[i]=s,t.t=this.t+i+1,t.s=this.s,t.clamp()}function yp(e,t){t.s=this.s;var a=Math.floor(e/this.DB);if(a>=this.t){t.t=0;return}var r=e%this.DB,n=this.DB-r,i=(1<<r)-1;t.data[0]=this.data[a]>>r;for(var s=a+1;s<this.t;++s)t.data[s-a-1]|=(this.data[s]&i)<<n,t.data[s-a]=this.data[s]>>r;r>0&&(t.data[this.t-a-1]|=(this.s&i)<<n),t.t=this.t-a,t.clamp()}function gp(e,t){for(var a=0,r=0,n=Math.min(e.t,this.t);a<n;)r+=this.data[a]-e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;a<this.t;)r+=this.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;a<e.t;)r-=e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t.data[a++]=this.DV+r:r>0&&(t.data[a++]=r),t.t=a,t.clamp()}function mp(e,t){var a=this.abs(),r=e.abs(),n=a.t;for(t.t=n+r.t;--n>=0;)t.data[n]=0;for(n=0;n<r.t;++n)t.data[n+a.t]=a.am(0,r.data[n],t,n,0,a.t);t.s=0,t.clamp(),this.s!=e.s&&F.ZERO.subTo(t,t)}function vp(e){for(var t=this.abs(),a=e.t=2*t.t;--a>=0;)e.data[a]=0;for(a=0;a<t.t-1;++a){var r=t.am(a,t.data[a],e,2*a,0,1);(e.data[a+t.t]+=t.am(a+1,2*t.data[a],e,2*a+1,r,t.t-a-1))>=t.DV&&(e.data[a+t.t]-=t.DV,e.data[a+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(a,t.data[a],e,2*a,0,1)),e.s=0,e.clamp()}function Cp(e,t,a){var r=e.abs();if(!(r.t<=0)){var n=this.abs();if(n.t<r.t){t?.fromInt(0),a!=null&&this.copyTo(a);return}a==null&&(a=ve());var i=ve(),s=this.s,u=e.s,c=this.DB-ji(r.data[r.t-1]);c>0?(r.lShiftTo(c,i),n.lShiftTo(c,a)):(r.copyTo(i),n.copyTo(a));var f=i.t,d=i.data[f-1];if(d!=0){var h=d*(1<<this.F1)+(f>1?i.data[f-2]>>this.F2:0),C=this.FV/h,E=(1<<this.F1)/h,g=1<<this.F2,_=a.t,S=_-f,b=t??ve();for(i.dlShiftTo(S,b),a.compareTo(b)>=0&&(a.data[a.t++]=1,a.subTo(b,a)),F.ONE.dlShiftTo(f,b),b.subTo(i,i);i.t<f;)i.data[i.t++]=0;for(;--S>=0;){var A=a.data[--_]==d?this.DM:Math.floor(a.data[_]*C+(a.data[_-1]+g)*E);if((a.data[_]+=i.am(0,A,a,S,0,f))<A)for(i.dlShiftTo(S,b),a.subTo(b,a);a.data[_]<--A;)a.subTo(b,a)}t!=null&&(a.drShiftTo(f,t),s!=u&&F.ZERO.subTo(t,t)),a.t=f,a.clamp(),c>0&&a.rShiftTo(c,a),s<0&&F.ZERO.subTo(a,a)}}}function Sp(e){var t=ve();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(F.ZERO)>0&&e.subTo(t,t),t}function ia(e){this.m=e}function Ep(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function bp(e){return e}function xp(e){e.divRemTo(this.m,null,e)}function Tp(e,t,a){e.multiplyTo(t,a),this.reduce(a)}function Ap(e,t){e.squareTo(t),this.reduce(t)}ia.prototype.convert=Ep;ia.prototype.revert=bp;ia.prototype.reduce=xp;ia.prototype.mulTo=Tp;ia.prototype.sqrTo=Ap;function _p(){if(this.t<1)return 0;var e=this.data[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function sa(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Ip(e){var t=ve();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(F.ZERO)>0&&this.m.subTo(t,t),t}function Bp(e){var t=ve();return e.copyTo(t),this.reduce(t),t}function wp(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var a=e.data[t]&32767,r=a*this.mpl+((a*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(a=t+this.m.t,e.data[a]+=this.m.am(0,r,e,t,0,this.m.t);e.data[a]>=e.DV;)e.data[a]-=e.DV,e.data[++a]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Rp(e,t){e.squareTo(t),this.reduce(t)}function Np(e,t,a){e.multiplyTo(t,a),this.reduce(a)}sa.prototype.convert=Ip;sa.prototype.revert=Bp;sa.prototype.reduce=wp;sa.prototype.mulTo=Np;sa.prototype.sqrTo=Rp;function Lp(){return(this.t>0?this.data[0]&1:this.s)==0}function Dp(e,t){if(e>4294967295||e<1)return F.ONE;var a=ve(),r=ve(),n=t.convert(this),i=ji(e)-1;for(n.copyTo(a);--i>=0;)if(t.sqrTo(a,r),(e&1<<i)>0)t.mulTo(r,n,a);else{var s=a;a=r,r=s}return t.revert(a)}function kp(e,t){var a;return e<256||t.isEven()?a=new ia(t):a=new sa(t),this.exp(e,a)}F.prototype.copyTo=ap;F.prototype.fromInt=np;F.prototype.fromString=ip;F.prototype.clamp=sp;F.prototype.dlShiftTo=dp;F.prototype.drShiftTo=hp;F.prototype.lShiftTo=pp;F.prototype.rShiftTo=yp;F.prototype.subTo=gp;F.prototype.multiplyTo=mp;F.prototype.squareTo=vp;F.prototype.divRemTo=Cp;F.prototype.invDigit=_p;F.prototype.isEven=Lp;F.prototype.exp=Dp;F.prototype.toString=op;F.prototype.negate=up;F.prototype.abs=lp;F.prototype.compareTo=fp;F.prototype.bitLength=cp;F.prototype.mod=Sp;F.prototype.modPowInt=kp;F.ZERO=Vr(0);F.ONE=Vr(1);function Pp(){var e=ve();return this.copyTo(e),e}function Up(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Op(){return this.t==0?this.s:this.data[0]<<24>>24}function Fp(){return this.t==0?this.s:this.data[0]<<16>>16}function Vp(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function qp(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Mp(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),a=Math.pow(e,t),r=Vr(a),n=ve(),i=ve(),s="";for(this.divRemTo(r,n,i);n.signum()>0;)s=(a+i.intValue()).toString(e).substr(1)+s,n.divRemTo(r,n,i);return i.intValue().toString(e)+s}function Kp(e,t){this.fromInt(0),t==null&&(t=10);for(var a=this.chunkSize(t),r=Math.pow(t,a),n=!1,i=0,s=0,u=0;u<e.length;++u){var c=zf(e,u);if(c<0){e.charAt(u)=="-"&&this.signum()==0&&(n=!0);continue}s=t*s+c,++i>=a&&(this.dMultiply(r),this.dAddOffset(s,0),i=0,s=0)}i>0&&(this.dMultiply(Math.pow(t,i)),this.dAddOffset(s,0)),n&&F.ZERO.subTo(this,this)}function Hp(e,t,a){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,a),this.testBit(e-1)||this.bitwiseTo(F.ONE.shiftLeft(e-1),So,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(F.ONE.shiftLeft(e-1),this);else{var r=new Array,n=e&7;r.length=(e>>3)+1,t.nextBytes(r),n>0?r[0]&=(1<<n)-1:r[0]=0,this.fromString(r,256)}}function zp(){var e=this.t,t=new Array;t[0]=this.s;var a=this.DB-e*this.DB%8,r,n=0;if(e-- >0)for(a<this.DB&&(r=this.data[e]>>a)!=(this.s&this.DM)>>a&&(t[n++]=r|this.s<<this.DB-a);e>=0;)a<8?(r=(this.data[e]&(1<<a)-1)<<8-a,r|=this.data[--e]>>(a+=this.DB-8)):(r=this.data[e]>>(a-=8)&255,a<=0&&(a+=this.DB,--e)),(r&128)!=0&&(r|=-256),n==0&&(this.s&128)!=(r&128)&&++n,(n>0||r!=this.s)&&(t[n++]=r);return t}function Wp(e){return this.compareTo(e)==0}function Gp(e){return this.compareTo(e)<0?this:e}function Qp(e){return this.compareTo(e)>0?this:e}function jp(e,t,a){var r,n,i=Math.min(e.t,this.t);for(r=0;r<i;++r)a.data[r]=t(this.data[r],e.data[r]);if(e.t<this.t){for(n=e.s&this.DM,r=i;r<this.t;++r)a.data[r]=t(this.data[r],n);a.t=this.t}else{for(n=this.s&this.DM,r=i;r<e.t;++r)a.data[r]=t(n,e.data[r]);a.t=e.t}a.s=t(this.s,e.s),a.clamp()}function $p(e,t){return e&t}function Yp(e){var t=ve();return this.bitwiseTo(e,$p,t),t}function So(e,t){return e|t}function Xp(e){var t=ve();return this.bitwiseTo(e,So,t),t}function Wf(e,t){return e^t}function Zp(e){var t=ve();return this.bitwiseTo(e,Wf,t),t}function Gf(e,t){return e&~t}function Jp(e){var t=ve();return this.bitwiseTo(e,Gf,t),t}function ey(){for(var e=ve(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function ty(e){var t=ve();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function ry(e){var t=ve();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function ay(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function ny(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+ay(this.data[e]);return this.s<0?this.t*this.DB:-1}function iy(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function sy(){for(var e=0,t=this.s&this.DM,a=0;a<this.t;++a)e+=iy(this.data[a]^t);return e}function oy(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function uy(e,t){var a=F.ONE.shiftLeft(e);return this.bitwiseTo(a,t,a),a}function ly(e){return this.changeBit(e,So)}function fy(e){return this.changeBit(e,Gf)}function cy(e){return this.changeBit(e,Wf)}function dy(e,t){for(var a=0,r=0,n=Math.min(e.t,this.t);a<n;)r+=this.data[a]+e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;a<this.t;)r+=this.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;a<e.t;)r+=e.data[a],t.data[a++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t.data[a++]=r:r<-1&&(t.data[a++]=this.DV+r),t.t=a,t.clamp()}function hy(e){var t=ve();return this.addTo(e,t),t}function py(e){var t=ve();return this.subTo(e,t),t}function yy(e){var t=ve();return this.multiplyTo(e,t),t}function gy(e){var t=ve();return this.divRemTo(e,t,null),t}function my(e){var t=ve();return this.divRemTo(e,null,t),t}function vy(e){var t=ve(),a=ve();return this.divRemTo(e,t,a),new Array(t,a)}function Cy(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function Sy(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Bn(){}function Qf(e){return e}function Ey(e,t,a){e.multiplyTo(t,a)}function by(e,t){e.squareTo(t)}Bn.prototype.convert=Qf;Bn.prototype.revert=Qf;Bn.prototype.mulTo=Ey;Bn.prototype.sqrTo=by;function xy(e){return this.exp(e,new Bn)}function Ty(e,t,a){var r=Math.min(this.t+e.t,t);for(a.s=0,a.t=r;r>0;)a.data[--r]=0;var n;for(n=a.t-this.t;r<n;++r)a.data[r+this.t]=this.am(0,e.data[r],a,r,0,this.t);for(n=Math.min(e.t,t);r<n;++r)this.am(0,e.data[r],a,r,0,t-r);a.clamp()}function Ay(e,t,a){--t;var r=a.t=this.t+e.t-t;for(a.s=0;--r>=0;)a.data[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)a.data[this.t+r-t]=this.am(t-r,e.data[r],a,0,0,this.t+r-t);a.clamp(),a.drShiftTo(1,a)}function ka(e){this.r2=ve(),this.q3=ve(),F.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function _y(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=ve();return e.copyTo(t),this.reduce(t),t}function Iy(e){return e}function By(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function wy(e,t){e.squareTo(t),this.reduce(t)}function Ry(e,t,a){e.multiplyTo(t,a),this.reduce(a)}ka.prototype.convert=_y;ka.prototype.revert=Iy;ka.prototype.reduce=By;ka.prototype.mulTo=Ry;ka.prototype.sqrTo=wy;function Ny(e,t){var a=e.bitLength(),r,n=Vr(1),i;if(a<=0)return n;a<18?r=1:a<48?r=3:a<144?r=4:a<768?r=5:r=6,a<8?i=new ia(t):t.isEven()?i=new ka(t):i=new sa(t);var s=new Array,u=3,c=r-1,f=(1<<r)-1;if(s[1]=i.convert(this),r>1){var d=ve();for(i.sqrTo(s[1],d);u<=f;)s[u]=ve(),i.mulTo(d,s[u-2],s[u]),u+=2}var h=e.t-1,C,E=!0,g=ve(),_;for(a=ji(e.data[h])-1;h>=0;){for(a>=c?C=e.data[h]>>a-c&f:(C=(e.data[h]&(1<<a+1)-1)<<c-a,h>0&&(C|=e.data[h-1]>>this.DB+a-c)),u=r;(C&1)==0;)C>>=1,--u;if((a-=u)<0&&(a+=this.DB,--h),E)s[C].copyTo(n),E=!1;else{for(;u>1;)i.sqrTo(n,g),i.sqrTo(g,n),u-=2;u>0?i.sqrTo(n,g):(_=n,n=g,g=_),i.mulTo(g,s[C],n)}for(;h>=0&&(e.data[h]&1<<a)==0;)i.sqrTo(n,g),_=n,n=g,g=_,--a<0&&(a=this.DB-1,--h)}return i.revert(n)}function Ly(e){var t=this.s<0?this.negate():this.clone(),a=e.s<0?e.negate():e.clone();if(t.compareTo(a)<0){var r=t;t=a,a=r}var n=t.getLowestSetBit(),i=a.getLowestSetBit();if(i<0)return t;for(n<i&&(i=n),i>0&&(t.rShiftTo(i,t),a.rShiftTo(i,a));t.signum()>0;)(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),(n=a.getLowestSetBit())>0&&a.rShiftTo(n,a),t.compareTo(a)>=0?(t.subTo(a,t),t.rShiftTo(1,t)):(a.subTo(t,a),a.rShiftTo(1,a));return i>0&&a.lShiftTo(i,a),a}function Dy(e){if(e<=0)return 0;var t=this.DV%e,a=this.s<0?e-1:0;if(this.t>0)if(t==0)a=this.data[0]%e;else for(var r=this.t-1;r>=0;--r)a=(t*a+this.data[r])%e;return a}function ky(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return F.ZERO;for(var a=e.clone(),r=this.clone(),n=Vr(1),i=Vr(0),s=Vr(0),u=Vr(1);a.signum()!=0;){for(;a.isEven();)a.rShiftTo(1,a),t?((!n.isEven()||!i.isEven())&&(n.addTo(this,n),i.subTo(e,i)),n.rShiftTo(1,n)):i.isEven()||i.subTo(e,i),i.rShiftTo(1,i);for(;r.isEven();)r.rShiftTo(1,r),t?((!s.isEven()||!u.isEven())&&(s.addTo(this,s),u.subTo(e,u)),s.rShiftTo(1,s)):u.isEven()||u.subTo(e,u),u.rShiftTo(1,u);a.compareTo(r)>=0?(a.subTo(r,a),t&&n.subTo(s,n),i.subTo(u,i)):(r.subTo(a,r),t&&s.subTo(n,s),u.subTo(i,u))}if(r.compareTo(F.ONE)!=0)return F.ZERO;if(u.compareTo(e)>=0)return u.subtract(e);if(u.signum()<0)u.addTo(e,u);else return u;return u.signum()<0?u.add(e):u}var jt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Py=(1<<26)/jt[jt.length-1];function Uy(e){var t,a=this.abs();if(a.t==1&&a.data[0]<=jt[jt.length-1]){for(t=0;t<jt.length;++t)if(a.data[0]==jt[t])return!0;return!1}if(a.isEven())return!1;for(t=1;t<jt.length;){for(var r=jt[t],n=t+1;n<jt.length&&r<Py;)r*=jt[n++];for(r=a.modInt(r);t<n;)if(r%jt[t++]==0)return!1}return a.millerRabin(e)}function Oy(e){var t=this.subtract(F.ONE),a=t.getLowestSetBit();if(a<=0)return!1;for(var r=t.shiftRight(a),n=Fy(),i,s=0;s<e;++s){do i=new F(this.bitLength(),n);while(i.compareTo(F.ONE)<=0||i.compareTo(t)>=0);var u=i.modPow(r,this);if(u.compareTo(F.ONE)!=0&&u.compareTo(t)!=0){for(var c=1;c++<a&&u.compareTo(t)!=0;)if(u=u.modPowInt(2,this),u.compareTo(F.ONE)==0)return!1;if(u.compareTo(t)!=0)return!1}}return!0}function Fy(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}F.prototype.chunkSize=Vp;F.prototype.toRadix=Mp;F.prototype.fromRadix=Kp;F.prototype.fromNumber=Hp;F.prototype.bitwiseTo=jp;F.prototype.changeBit=uy;F.prototype.addTo=dy;F.prototype.dMultiply=Cy;F.prototype.dAddOffset=Sy;F.prototype.multiplyLowerTo=Ty;F.prototype.multiplyUpperTo=Ay;F.prototype.modInt=Dy;F.prototype.millerRabin=Oy;F.prototype.clone=Pp;F.prototype.intValue=Up;F.prototype.byteValue=Op;F.prototype.shortValue=Fp;F.prototype.signum=qp;F.prototype.toByteArray=zp;F.prototype.equals=Wp;F.prototype.min=Gp;F.prototype.max=Qp;F.prototype.and=Yp;F.prototype.or=Xp;F.prototype.xor=Zp;F.prototype.andNot=Jp;F.prototype.not=ey;F.prototype.shiftLeft=ty;F.prototype.shiftRight=ry;F.prototype.getLowestSetBit=ny;F.prototype.bitCount=sy;F.prototype.testBit=oy;F.prototype.setBit=ly;F.prototype.clearBit=fy;F.prototype.flipBit=cy;F.prototype.add=hy;F.prototype.subtract=py;F.prototype.multiply=yy;F.prototype.divide=gy;F.prototype.remainder=my;F.prototype.divideAndRemainder=vy;F.prototype.modPow=Ny;F.prototype.modInverse=ky;F.prototype.pow=xy;F.prototype.gcd=Ly;F.prototype.isProbablePrime=Uy});var Pa=ne((n1,Zf)=>{var nr=ue();Jt();me();var Yf=Zf.exports=nr.sha1=nr.sha1||{};nr.md.sha1=nr.md.algorithms.sha1=Yf;Yf.create=function(){Xf||Vy();var e=null,t=nr.util.createBuffer(),a=new Array(80),r={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return r.start=function(){r.messageLength=0,r.fullMessageLength=r.messageLength64=[];for(var n=r.messageLengthSize/4,i=0;i<n;++i)r.fullMessageLength.push(0);return t=nr.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},r},r.start(),r.update=function(n,i){i==="utf8"&&(n=nr.util.encodeUtf8(n));var s=n.length;r.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var u=r.fullMessageLength.length-1;u>=0;--u)r.fullMessageLength[u]+=s[1],s[1]=s[0]+(r.fullMessageLength[u]/4294967296>>>0),r.fullMessageLength[u]=r.fullMessageLength[u]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(n),$f(e,a,t),(t.read>2048||t.length()===0)&&t.compact(),r},r.digest=function(){var n=nr.util.createBuffer();n.putBytes(t.bytes());var i=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize,s=i&r.blockLength-1;n.putBytes(Eo.substr(0,r.blockLength-s));for(var u,c,f=r.fullMessageLength[0]*8,d=0;d<r.fullMessageLength.length-1;++d)u=r.fullMessageLength[d+1]*8,c=u/4294967296>>>0,f+=c,n.putInt32(f>>>0),f=u>>>0;n.putInt32(f);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};$f(h,a,n);var C=nr.util.createBuffer();return C.putInt32(h.h0),C.putInt32(h.h1),C.putInt32(h.h2),C.putInt32(h.h3),C.putInt32(h.h4),C},r};var Eo=null,Xf=!1;function Vy(){Eo=String.fromCharCode(128),Eo+=nr.util.fillString(String.fromCharCode(0),64),Xf=!0}function $f(e,t,a){for(var r,n,i,s,u,c,f,d,h=a.length();h>=64;){for(n=e.h0,i=e.h1,s=e.h2,u=e.h3,c=e.h4,d=0;d<16;++d)r=a.getInt32(),t[d]=r,f=u^i&(s^u),r=(n<<5|n>>>27)+f+c+1518500249+r,c=u,u=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;d<20;++d)r=t[d-3]^t[d-8]^t[d-14]^t[d-16],r=r<<1|r>>>31,t[d]=r,f=u^i&(s^u),r=(n<<5|n>>>27)+f+c+1518500249+r,c=u,u=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;d<32;++d)r=t[d-3]^t[d-8]^t[d-14]^t[d-16],r=r<<1|r>>>31,t[d]=r,f=i^s^u,r=(n<<5|n>>>27)+f+c+1859775393+r,c=u,u=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;d<40;++d)r=t[d-6]^t[d-16]^t[d-28]^t[d-32],r=r<<2|r>>>30,t[d]=r,f=i^s^u,r=(n<<5|n>>>27)+f+c+1859775393+r,c=u,u=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;d<60;++d)r=t[d-6]^t[d-16]^t[d-28]^t[d-32],r=r<<2|r>>>30,t[d]=r,f=i&s|u&(i^s),r=(n<<5|n>>>27)+f+c+2400959708+r,c=u,u=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;for(;d<80;++d)r=t[d-6]^t[d-16]^t[d-28]^t[d-32],r=r<<2|r>>>30,t[d]=r,f=i^s^u,r=(n<<5|n>>>27)+f+c+3395469782+r,c=u,u=s,s=(i<<30|i>>>2)>>>0,i=n,n=r;e.h0=e.h0+n|0,e.h1=e.h1+i|0,e.h2=e.h2+s|0,e.h3=e.h3+u|0,e.h4=e.h4+c|0,h-=64}}});var bo=ne((i1,ec)=>{var ir=ue();me();Pt();Pa();var Jf=ec.exports=ir.pkcs1=ir.pkcs1||{};Jf.encode_rsa_oaep=function(e,t,a){var r,n,i,s;typeof a=="string"?(r=a,n=arguments[3]||void 0,i=arguments[4]||void 0):a&&(r=a.label||void 0,n=a.seed||void 0,i=a.md||void 0,a.mgf1&&a.mgf1.md&&(s=a.mgf1.md)),i?i.start():i=ir.md.sha1.create(),s||(s=i);var u=Math.ceil(e.n.bitLength()/8),c=u-2*i.digestLength-2;if(t.length>c){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=t.length,f.maxLength=c,f}r||(r=""),i.update(r,"raw");for(var d=i.digest(),h="",C=c-t.length,E=0;E<C;E++)h+="\0";var g=d.getBytes()+h+""+t;if(!n)n=ir.random.getBytes(i.digestLength);else if(n.length!==i.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=n.length,f.digestLength=i.digestLength,f}var _=$i(n,u-i.digestLength-1,s),S=ir.util.xorBytes(g,_,g.length),b=$i(S,i.digestLength,s),A=ir.util.xorBytes(n,b,n.length);return"\0"+A+S};Jf.decode_rsa_oaep=function(e,t,a){var r,n,i;typeof a=="string"?(r=a,n=arguments[3]||void 0):a&&(r=a.label||void 0,n=a.md||void 0,a.mgf1&&a.mgf1.md&&(i=a.mgf1.md));var s=Math.ceil(e.n.bitLength()/8);if(t.length!==s){var S=new Error("RSAES-OAEP encoded message length is invalid.");throw S.length=t.length,S.expectedLength=s,S}if(n===void 0?n=ir.md.sha1.create():n.start(),i||(i=n),s<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");r||(r=""),n.update(r,"raw");for(var u=n.digest().getBytes(),c=t.charAt(0),f=t.substring(1,n.digestLength+1),d=t.substring(1+n.digestLength),h=$i(d,n.digestLength,i),C=ir.util.xorBytes(f,h,f.length),E=$i(C,s-n.digestLength-1,i),g=ir.util.xorBytes(d,E,d.length),_=g.substring(0,n.digestLength),S=c!=="\0",b=0;b<n.digestLength;++b)S|=u.charAt(b)!==_.charAt(b);for(var A=1,w=n.digestLength,D=n.digestLength;D<g.length;D++){var k=g.charCodeAt(D),R=k&1^1,G=A?65534:0;S|=k&G,A=A&R,w+=A}if(S||g.charCodeAt(w)!==1)throw new Error("Invalid RSAES-OAEP padding.");return g.substring(w+1)};function $i(e,t,a){a||(a=ir.md.sha1.create());for(var r="",n=Math.ceil(t/a.digestLength),i=0;i<n;++i){var s=String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255);a.start(),a.update(e+s),r+=a.digest().getBytes()}return r.substring(0,t)}});var To=ne((s1,xo)=>{var qr=ue();me();wn();Pt();(function(){if(qr.prime){xo.exports=qr.prime;return}var e=xo.exports=qr.prime=qr.prime||{},t=qr.jsbn.BigInteger,a=[6,4,2,4,2,4,6,2],r=new t(null);r.fromInt(30);var n=function(h,C){return h|C};e.generateProbablePrime=function(h,C,E){typeof C=="function"&&(E=C,C={}),C=C||{};var g=C.algorithm||"PRIMEINC";typeof g=="string"&&(g={name:g}),g.options=g.options||{};var _=C.prng||qr.random,S={nextBytes:function(b){for(var A=_.getBytesSync(b.length),w=0;w<b.length;++w)b[w]=A.charCodeAt(w)}};if(g.name==="PRIMEINC")return i(h,S,g.options,E);throw new Error("Invalid prime generation algorithm: "+g.name)};function i(h,C,E,g){return"workers"in E?c(h,C,E,g):s(h,C,E,g)}function s(h,C,E,g){var _=f(h,C),S=0,b=d(_.bitLength());"millerRabinTests"in E&&(b=E.millerRabinTests);var A=10;"maxBlockTime"in E&&(A=E.maxBlockTime),u(_,h,C,S,b,A,g)}function u(h,C,E,g,_,S,b){var A=+new Date;do{if(h.bitLength()>C&&(h=f(C,E)),h.isProbablePrime(_))return b(null,h);h.dAddOffset(a[g++%8],0)}while(S<0||+new Date-A<S);qr.util.setImmediate(function(){u(h,C,E,g,_,S,b)})}function c(h,C,E,g){if(typeof Worker>"u")return s(h,C,E,g);var _=f(h,C),S=E.workers,b=E.workLoad||100,A=b*30/8,w=E.workerScript||"forge/prime.worker.js";if(S===-1)return qr.util.estimateCores(function(k,R){k&&(R=2),S=R-1,D()});D();function D(){S=Math.max(1,S);for(var k=[],R=0;R<S;++R)k[R]=new Worker(w);for(var G=S,R=0;R<S;++R)k[R].addEventListener("message",Y);var q=!1;function Y(H){if(!q){--G;var ae=H.data;if(ae.found){for(var K=0;K<k.length;++K)k[K].terminate();return q=!0,g(null,new t(ae.prime,16))}_.bitLength()>h&&(_=f(h,C));var xe=_.toString(16);H.target.postMessage({hex:xe,workLoad:b}),_.dAddOffset(A,0)}}}}function f(h,C){var E=new t(h,C),g=h-1;return E.testBit(g)||E.bitwiseTo(t.ONE.shiftLeft(g),n,E),E.dAddOffset(31-E.mod(r).byteValue(),0),E}function d(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Rn=ne((o1,oc)=>{var J=ue();Qt();wn();Fr();bo();To();Pt();me();typeof ye>"u"&&(ye=J.jsbn.BigInteger);var ye,Ao=J.util.isNodejs?require("crypto"):null,L=J.asn1,Ot=J.util;J.pki=J.pki||{};oc.exports=J.pki.rsa=J.rsa=J.rsa||{};var ie=J.pki,qy=[6,4,2,4,2,4,6,2],My={name:"PrivateKeyInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Ky={name:"RSAPrivateKey",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Hy={name:"RSAPublicKey",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:L.Class.UNIVERSAL,type:L.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},zy=J.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:L.Class.UNIVERSAL,type:L.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Wy={name:"DigestInfo",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:L.Class.UNIVERSAL,type:L.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:L.Class.UNIVERSAL,type:L.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:L.Class.UNIVERSAL,type:L.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:L.Class.UNIVERSAL,type:L.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Gy=function(e){var t;if(e.algorithm in ie.oids)t=ie.oids[e.algorithm];else{var a=new Error("Unknown message digest algorithm.");throw a.algorithm=e.algorithm,a}var r=L.oidToDer(t).getBytes(),n=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]),i=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[]);i.value.push(L.create(L.Class.UNIVERSAL,L.Type.OID,!1,r)),i.value.push(L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,""));var s=L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,e.digest().getBytes());return n.value.push(i),n.value.push(s),L.toDer(n).getBytes()},ic=function(e,t,a){if(a)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(ye.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(ye.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var r;do r=new ye(J.util.bytesToHex(J.random.getBytes(t.n.bitLength()/8)),16);while(r.compareTo(t.n)>=0||!r.gcd(t.n).equals(ye.ONE));e=e.multiply(r.modPow(t.e,t.n)).mod(t.n);for(var n=e.mod(t.p).modPow(t.dP,t.p),i=e.mod(t.q).modPow(t.dQ,t.q);n.compareTo(i)<0;)n=n.add(t.p);var s=n.subtract(i).multiply(t.qInv).mod(t.p).multiply(t.q).add(i);return s=s.multiply(r.modInverse(t.n)).mod(t.n),s};ie.rsa.encrypt=function(e,t,a){var r=a,n,i=Math.ceil(t.n.bitLength()/8);a!==!1&&a!==!0?(r=a===2,n=sc(e,t,a)):(n=J.util.createBuffer(),n.putBytes(e));for(var s=new ye(n.toHex(),16),u=ic(s,t,r),c=u.toString(16),f=J.util.createBuffer(),d=i-Math.ceil(c.length/2);d>0;)f.putByte(0),--d;return f.putBytes(J.util.hexToBytes(c)),f.getBytes()};ie.rsa.decrypt=function(e,t,a,r){var n=Math.ceil(t.n.bitLength()/8);if(e.length!==n){var i=new Error("Encrypted message length is invalid.");throw i.length=e.length,i.expected=n,i}var s=new ye(J.util.createBuffer(e).toHex(),16);if(s.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var u=ic(s,t,a),c=u.toString(16),f=J.util.createBuffer(),d=n-Math.ceil(c.length/2);d>0;)f.putByte(0),--d;return f.putBytes(J.util.hexToBytes(c)),r!==!1?Yi(f.getBytes(),t,a):f.getBytes()};ie.rsa.createKeyPairGenerationState=function(e,t,a){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,a=a||{};var r=a.prng||J.random,n={nextBytes:function(u){for(var c=r.getBytesSync(u.length),f=0;f<u.length;++f)u[f]=c.charCodeAt(f)}},i=a.algorithm||"PRIMEINC",s;if(i==="PRIMEINC")s={algorithm:i,state:0,bits:e,rng:n,eInt:t||65537,e:new ye(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+i);return s};ie.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var a=new ye(null);a.fromInt(30);for(var r=0,n=function(h,C){return h|C},i=+new Date,s,u=0;e.keys===null&&(t<=0||u<t);){if(e.state===0){var c=e.p===null?e.pBits:e.qBits,f=c-1;e.pqState===0?(e.num=new ye(c,e.rng),e.num.testBit(f)||e.num.bitwiseTo(ye.ONE.shiftLeft(f),n,e.num),e.num.dAddOffset(31-e.num.mod(a).byteValue(),0),r=0,++e.pqState):e.pqState===1?e.num.bitLength()>c?e.pqState=0:e.num.isProbablePrime(jy(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(qy[r++%8],0):e.pqState===2?e.pqState=e.num.subtract(ye.ONE).gcd(e.e).compareTo(ye.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(ye.ONE),e.q1=e.q.subtract(ye.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(ye.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var d=e.e.modInverse(e.phi);e.keys={privateKey:ie.rsa.setPrivateKey(e.n,e.e,d,e.p,e.q,d.mod(e.p1),d.mod(e.q1),e.q.modInverse(e.p)),publicKey:ie.rsa.setPublicKey(e.n,e.e)}}s=+new Date,u+=s-i,i=s}return e.keys!==null};ie.rsa.generateKeyPair=function(e,t,a,r){if(arguments.length===1?typeof e=="object"?(a=e,e=void 0):typeof e=="function"&&(r=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(r=t,t=void 0):typeof t!="number"&&(a=t,t=void 0):(a=e,r=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof a=="function"&&(r=a,a=void 0):(r=a,a=t,t=void 0)),a=a||{},e===void 0&&(e=a.bits||2048),t===void 0&&(t=a.e||65537),!J.options.usePureJavaScript&&!a.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(r){if(tc("generateKeyPair"))return Ao.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(u,c,f){if(u)return r(u);r(null,{privateKey:ie.privateKeyFromPem(f),publicKey:ie.publicKeyFromPem(c)})});if(rc("generateKey")&&rc("exportKey"))return Ot.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:nc(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(u){return Ot.globalScope.crypto.subtle.exportKey("pkcs8",u.privateKey)}).then(void 0,function(u){r(u)}).then(function(u){if(u){var c=ie.privateKeyFromAsn1(L.fromDer(J.util.createBuffer(u)));r(null,{privateKey:c,publicKey:ie.setRsaPublicKey(c.n,c.e)})}});if(ac("generateKey")&&ac("exportKey")){var n=Ot.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:nc(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(u){var c=u.target.result,f=Ot.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);f.oncomplete=function(d){var h=d.target.result,C=ie.privateKeyFromAsn1(L.fromDer(J.util.createBuffer(h)));r(null,{privateKey:C,publicKey:ie.setRsaPublicKey(C.n,C.e)})},f.onerror=function(d){r(d)}},n.onerror=function(u){r(u)};return}}else if(tc("generateKeyPairSync")){var i=Ao.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:ie.privateKeyFromPem(i.privateKey),publicKey:ie.publicKeyFromPem(i.publicKey)}}}var s=ie.rsa.createKeyPairGenerationState(e,t,a);if(!r)return ie.rsa.stepKeyPairGenerationState(s,0),s.keys;Qy(s,a,r)};ie.setRsaPublicKey=ie.rsa.setPublicKey=function(e,t){var a={n:e,e:t};return a.encrypt=function(r,n,i){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(u,c,f){return sc(u,c,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(u,c){return J.pkcs1.encode_rsa_oaep(c,u,i)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(u){return u}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var s=n.encode(r,a,!0);return ie.rsa.encrypt(s,a,!0)},a.verify=function(r,n,i,s){typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),i==="RSASSA-PKCS1-V1_5"?i={verify:function(c,f){f=Yi(f,a,!0);var d=L.fromDer(f,{parseAllBytes:s._parseAllDigestBytes}),h={},C=[];if(!L.validate(d,Wy,h,C)){var E=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw E.errors=C,E}var g=L.derToOid(h.algorithmIdentifier);if(!(g===J.oids.md2||g===J.oids.md5||g===J.oids.sha1||g===J.oids.sha224||g===J.oids.sha256||g===J.oids.sha384||g===J.oids.sha512||g===J.oids["sha512-224"]||g===J.oids["sha512-256"])){var E=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw E.oid=g,E}if((g===J.oids.md2||g===J.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===h.digest}}:(i==="NONE"||i==="NULL"||i===null)&&(i={verify:function(c,f){return f=Yi(f,a,!0),c===f}});var u=ie.rsa.decrypt(n,a,!0,!1);return i.verify(r,u,a.n.bitLength())},a};ie.setRsaPrivateKey=ie.rsa.setPrivateKey=function(e,t,a,r,n,i,s,u){var c={n:e,e:t,d:a,p:r,q:n,dP:i,dQ:s,qInv:u};return c.decrypt=function(f,d,h){typeof d=="string"?d=d.toUpperCase():d===void 0&&(d="RSAES-PKCS1-V1_5");var C=ie.rsa.decrypt(f,c,!1,!1);if(d==="RSAES-PKCS1-V1_5")d={decode:Yi};else if(d==="RSA-OAEP"||d==="RSAES-OAEP")d={decode:function(E,g){return J.pkcs1.decode_rsa_oaep(g,E,h)}};else if(["RAW","NONE","NULL",null].indexOf(d)!==-1)d={decode:function(E){return E}};else throw new Error('Unsupported encryption scheme: "'+d+'".');return d.decode(C,c,!1)},c.sign=function(f,d){var h=!1;typeof d=="string"&&(d=d.toUpperCase()),d===void 0||d==="RSASSA-PKCS1-V1_5"?(d={encode:Gy},h=1):(d==="NONE"||d==="NULL"||d===null)&&(d={encode:function(){return f}},h=1);var C=d.encode(f,c.n.bitLength());return ie.rsa.encrypt(C,c,h)},c};ie.wrapRsaPrivateKey=function(e){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(0).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(ie.oids.rsaEncryption).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")]),L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,L.toDer(e).getBytes())])};ie.privateKeyFromAsn1=function(e){var t={},a=[];if(L.validate(e,My,t,a)&&(e=L.fromDer(J.util.createBuffer(t.privateKey))),t={},a=[],!L.validate(e,Ky,t,a)){var r=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw r.errors=a,r}var n,i,s,u,c,f,d,h;return n=J.util.createBuffer(t.privateKeyModulus).toHex(),i=J.util.createBuffer(t.privateKeyPublicExponent).toHex(),s=J.util.createBuffer(t.privateKeyPrivateExponent).toHex(),u=J.util.createBuffer(t.privateKeyPrime1).toHex(),c=J.util.createBuffer(t.privateKeyPrime2).toHex(),f=J.util.createBuffer(t.privateKeyExponent1).toHex(),d=J.util.createBuffer(t.privateKeyExponent2).toHex(),h=J.util.createBuffer(t.privateKeyCoefficient).toHex(),ie.setRsaPrivateKey(new ye(n,16),new ye(i,16),new ye(s,16),new ye(u,16),new ye(c,16),new ye(f,16),new ye(d,16),new ye(h,16))};ie.privateKeyToAsn1=ie.privateKeyToRSAPrivateKey=function(e){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(0).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.n)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.e)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.d)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.p)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.q)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.dP)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.dQ)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.qInv))])};ie.publicKeyFromAsn1=function(e){var t={},a=[];if(L.validate(e,zy,t,a)){var r=L.derToOid(t.publicKeyOid);if(r!==ie.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=r,n}e=t.rsaPublicKey}if(a=[],!L.validate(e,Hy,t,a)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=a,n}var i=J.util.createBuffer(t.publicKeyModulus).toHex(),s=J.util.createBuffer(t.publicKeyExponent).toHex();return ie.setRsaPublicKey(new ye(i,16),new ye(s,16))};ie.publicKeyToAsn1=ie.publicKeyToSubjectPublicKeyInfo=function(e){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(ie.oids.rsaEncryption).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")]),L.create(L.Class.UNIVERSAL,L.Type.BITSTRING,!1,[ie.publicKeyToRSAPublicKey(e)])])};ie.publicKeyToRSAPublicKey=function(e){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.n)),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,sr(e.e))])};function sc(e,t,a){var r=J.util.createBuffer(),n=Math.ceil(t.n.bitLength()/8);if(e.length>n-11){var i=new Error("Message is too long for PKCS#1 v1.5 padding.");throw i.length=e.length,i.max=n-11,i}r.putByte(0),r.putByte(a);var s=n-3-e.length,u;if(a===0||a===1){u=a===0?0:255;for(var c=0;c<s;++c)r.putByte(u)}else for(;s>0;){for(var f=0,d=J.random.getBytes(s),c=0;c<s;++c)u=d.charCodeAt(c),u===0?++f:r.putByte(u);s=f}return r.putByte(0),r.putBytes(e),r}function Yi(e,t,a,r){var n=Math.ceil(t.n.bitLength()/8),i=J.util.createBuffer(e),s=i.getByte(),u=i.getByte();if(s!==0||a&&u!==0&&u!==1||!a&&u!=2||a&&u===0&&typeof r>"u")throw new Error("Encryption block is invalid.");var c=0;if(u===0){c=n-3-r;for(var f=0;f<c;++f)if(i.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(u===1)for(c=0;i.length()>1;){if(i.getByte()!==255){--i.read;break}++c}else if(u===2)for(c=0;i.length()>1;){if(i.getByte()===0){--i.read;break}++c}var d=i.getByte();if(d!==0||c!==n-3-i.length())throw new Error("Encryption block is invalid.");return i.getBytes()}function Qy(e,t,a){typeof t=="function"&&(a=t,t={}),t=t||{};var r={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(r.prng=t.prng),n();function n(){i(e.pBits,function(u,c){if(u)return a(u);if(e.p=c,e.q!==null)return s(u,e.q);i(e.qBits,s)})}function i(u,c){J.prime.generateProbablePrime(u,r,c)}function s(u,c){if(u)return a(u);if(e.q=c,e.p.compareTo(e.q)<0){var f=e.p;e.p=e.q,e.q=f}if(e.p.subtract(ye.ONE).gcd(e.e).compareTo(ye.ONE)!==0){e.p=null,n();return}if(e.q.subtract(ye.ONE).gcd(e.e).compareTo(ye.ONE)!==0){e.q=null,i(e.qBits,s);return}if(e.p1=e.p.subtract(ye.ONE),e.q1=e.q.subtract(ye.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(ye.ONE)!==0){e.p=e.q=null,n();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,i(e.qBits,s);return}var d=e.e.modInverse(e.phi);e.keys={privateKey:ie.rsa.setPrivateKey(e.n,e.e,d,e.p,e.q,d.mod(e.p1),d.mod(e.q1),e.q.modInverse(e.p)),publicKey:ie.rsa.setPublicKey(e.n,e.e)},a(null,e.keys)}}function sr(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var a=J.util.hexToBytes(t);return a.length>1&&(a.charCodeAt(0)===0&&(a.charCodeAt(1)&128)===0||a.charCodeAt(0)===255&&(a.charCodeAt(1)&128)===128)?a.substr(1):a}function jy(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function tc(e){return J.util.isNodejs&&typeof Ao[e]=="function"}function rc(e){return typeof Ot.globalScope<"u"&&typeof Ot.globalScope.crypto=="object"&&typeof Ot.globalScope.crypto.subtle=="object"&&typeof Ot.globalScope.crypto.subtle[e]=="function"}function ac(e){return typeof Ot.globalScope<"u"&&typeof Ot.globalScope.msCrypto=="object"&&typeof Ot.globalScope.msCrypto.subtle=="object"&&typeof Ot.globalScope.msCrypto.subtle[e]=="function"}function nc(e){for(var t=J.util.hexToBytes(e.toString(16)),a=new Uint8Array(t.length),r=0;r<t.length;++r)a[r]=t.charCodeAt(r);return a}});var _o=ne((u1,dc)=>{var $=ue();Or();Qt();In();Jt();Fr();Wi();na();Pt();mo();Rn();me();typeof uc>"u"&&(uc=$.jsbn.BigInteger);var uc,P=$.asn1,se=$.pki=$.pki||{};dc.exports=se.pbe=$.pbe=$.pbe||{};var oa=se.oids,$y={name:"EncryptedPrivateKeyInfo",tagClass:P.Class.UNIVERSAL,type:P.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:P.Class.UNIVERSAL,type:P.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:P.Class.UNIVERSAL,type:P.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:P.Class.UNIVERSAL,type:P.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:P.Class.UNIVERSAL,type:P.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Yy={name:"PBES2Algorithms",tagClass:P.Class.UNIVERSAL,type:P.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:P.Class.UNIVERSAL,type:P.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:P.Class.UNIVERSAL,type:P.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:P.Class.UNIVERSAL,type:P.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:P.Class.UNIVERSAL,type:P.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:P.Class.UNIVERSAL,type:P.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:P.Class.UNIVERSAL,type:P.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:P.Class.UNIVERSAL,type:P.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:P.Class.UNIVERSAL,type:P.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:P.Class.UNIVERSAL,type:P.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:P.Class.UNIVERSAL,type:P.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:P.Class.UNIVERSAL,type:P.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Xy={name:"pkcs-12PbeParams",tagClass:P.Class.UNIVERSAL,type:P.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:P.Class.UNIVERSAL,type:P.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:P.Class.UNIVERSAL,type:P.Type.INTEGER,constructed:!1,capture:"iterations"}]};se.encryptPrivateKeyInfo=function(e,t,a){a=a||{},a.saltSize=a.saltSize||8,a.count=a.count||2048,a.algorithm=a.algorithm||"aes128",a.prfAlgorithm=a.prfAlgorithm||"sha1";var r=$.random.getBytesSync(a.saltSize),n=a.count,i=P.integerToDer(n),s,u,c;if(a.algorithm.indexOf("aes")===0||a.algorithm==="des"){var f,d,h;switch(a.algorithm){case"aes128":s=16,f=16,d=oa["aes128-CBC"],h=$.aes.createEncryptionCipher;break;case"aes192":s=24,f=16,d=oa["aes192-CBC"],h=$.aes.createEncryptionCipher;break;case"aes256":s=32,f=16,d=oa["aes256-CBC"],h=$.aes.createEncryptionCipher;break;case"des":s=8,f=8,d=oa.desCBC,h=$.des.createEncryptionCipher;break;default:var C=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw C.algorithm=a.algorithm,C}var E="hmacWith"+a.prfAlgorithm.toUpperCase(),g=cc(E),_=$.pkcs5.pbkdf2(t,r,n,s,g),S=$.random.getBytesSync(f),b=h(_);b.start(S),b.update(P.toDer(e)),b.finish(),c=b.output.getBytes();var A=Zy(r,i,s,E);u=P.create(P.Class.UNIVERSAL,P.Type.SEQUENCE,!0,[P.create(P.Class.UNIVERSAL,P.Type.OID,!1,P.oidToDer(oa.pkcs5PBES2).getBytes()),P.create(P.Class.UNIVERSAL,P.Type.SEQUENCE,!0,[P.create(P.Class.UNIVERSAL,P.Type.SEQUENCE,!0,[P.create(P.Class.UNIVERSAL,P.Type.OID,!1,P.oidToDer(oa.pkcs5PBKDF2).getBytes()),A]),P.create(P.Class.UNIVERSAL,P.Type.SEQUENCE,!0,[P.create(P.Class.UNIVERSAL,P.Type.OID,!1,P.oidToDer(d).getBytes()),P.create(P.Class.UNIVERSAL,P.Type.OCTETSTRING,!1,S)])])])}else if(a.algorithm==="3des"){s=24;var w=new $.util.ByteBuffer(r),_=se.pbe.generatePkcs12Key(t,w,1,n,s),S=se.pbe.generatePkcs12Key(t,w,2,n,s),b=$.des.createEncryptionCipher(_);b.start(S),b.update(P.toDer(e)),b.finish(),c=b.output.getBytes(),u=P.create(P.Class.UNIVERSAL,P.Type.SEQUENCE,!0,[P.create(P.Class.UNIVERSAL,P.Type.OID,!1,P.oidToDer(oa["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),P.create(P.Class.UNIVERSAL,P.Type.SEQUENCE,!0,[P.create(P.Class.UNIVERSAL,P.Type.OCTETSTRING,!1,r),P.create(P.Class.UNIVERSAL,P.Type.INTEGER,!1,i.getBytes())])])}else{var C=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw C.algorithm=a.algorithm,C}var D=P.create(P.Class.UNIVERSAL,P.Type.SEQUENCE,!0,[u,P.create(P.Class.UNIVERSAL,P.Type.OCTETSTRING,!1,c)]);return D};se.decryptPrivateKeyInfo=function(e,t){var a=null,r={},n=[];if(!P.validate(e,$y,r,n)){var i=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=n,i}var s=P.derToOid(r.encryptionOid),u=se.pbe.getCipher(s,r.encryptionParams,t),c=$.util.createBuffer(r.encryptedData);return u.update(c),u.finish()&&(a=P.fromDer(u.output)),a};se.encryptedPrivateKeyToPem=function(e,t){var a={type:"ENCRYPTED PRIVATE KEY",body:P.toDer(e).getBytes()};return $.pem.encode(a,{maxline:t})};se.encryptedPrivateKeyFromPem=function(e){var t=$.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var a=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return P.fromDer(t.body)};se.encryptRsaPrivateKey=function(e,t,a){if(a=a||{},!a.legacy){var r=se.wrapRsaPrivateKey(se.privateKeyToAsn1(e));return r=se.encryptPrivateKeyInfo(r,t,a),se.encryptedPrivateKeyToPem(r)}var n,i,s,u;switch(a.algorithm){case"aes128":n="AES-128-CBC",s=16,i=$.random.getBytesSync(16),u=$.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",s=24,i=$.random.getBytesSync(16),u=$.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",s=32,i=$.random.getBytesSync(16),u=$.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",s=24,i=$.random.getBytesSync(8),u=$.des.createEncryptionCipher;break;case"des":n="DES-CBC",s=8,i=$.random.getBytesSync(8),u=$.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+a.algorithm+'".');throw c.algorithm=a.algorithm,c}var f=$.pbe.opensslDeriveBytes(t,i.substr(0,8),s),d=u(f);d.start(i),d.update(P.toDer(se.privateKeyToAsn1(e))),d.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:$.util.bytesToHex(i).toUpperCase()},body:d.output.getBytes()};return $.pem.encode(h)};se.decryptRsaPrivateKey=function(e,t){var a=null,r=$.pem.decode(e)[0];if(r.type!=="ENCRYPTED PRIVATE KEY"&&r.type!=="PRIVATE KEY"&&r.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(r.procType&&r.procType.type==="ENCRYPTED"){var i,s;switch(r.dekInfo.algorithm){case"DES-CBC":i=8,s=$.des.createDecryptionCipher;break;case"DES-EDE3-CBC":i=24,s=$.des.createDecryptionCipher;break;case"AES-128-CBC":i=16,s=$.aes.createDecryptionCipher;break;case"AES-192-CBC":i=24,s=$.aes.createDecryptionCipher;break;case"AES-256-CBC":i=32,s=$.aes.createDecryptionCipher;break;case"RC2-40-CBC":i=5,s=function(h){return $.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":i=8,s=function(h){return $.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":i=16,s=function(h){return $.rc2.createDecryptionCipher(h,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+r.dekInfo.algorithm+'".');throw n.algorithm=r.dekInfo.algorithm,n}var u=$.util.hexToBytes(r.dekInfo.parameters),c=$.pbe.opensslDeriveBytes(t,u.substr(0,8),i),f=s(c);if(f.start(u),f.update($.util.createBuffer(r.body)),f.finish())a=f.output.getBytes();else return a}else a=r.body;return r.type==="ENCRYPTED PRIVATE KEY"?a=se.decryptPrivateKeyInfo(P.fromDer(a),t):a=P.fromDer(a),a!==null&&(a=se.privateKeyFromAsn1(a)),a};se.pbe.generatePkcs12Key=function(e,t,a,r,n,i){var s,u;if(typeof i>"u"||i===null){if(!("sha1"in $.md))throw new Error('"sha1" hash algorithm unavailable.');i=$.md.sha1.create()}var c=i.digestLength,f=i.blockLength,d=new $.util.ByteBuffer,h=new $.util.ByteBuffer;if(e!=null){for(u=0;u<e.length;u++)h.putInt16(e.charCodeAt(u));h.putInt16(0)}var C=h.length(),E=t.length(),g=new $.util.ByteBuffer;g.fillWithByte(a,f);var _=f*Math.ceil(E/f),S=new $.util.ByteBuffer;for(u=0;u<_;u++)S.putByte(t.at(u%E));var b=f*Math.ceil(C/f),A=new $.util.ByteBuffer;for(u=0;u<b;u++)A.putByte(h.at(u%C));var w=S;w.putBuffer(A);for(var D=Math.ceil(n/c),k=1;k<=D;k++){var R=new $.util.ByteBuffer;R.putBytes(g.bytes()),R.putBytes(w.bytes());for(var G=0;G<r;G++)i.start(),i.update(R.getBytes()),R=i.digest();var q=new $.util.ByteBuffer;for(u=0;u<f;u++)q.putByte(R.at(u%c));var Y=Math.ceil(E/f)+Math.ceil(C/f),H=new $.util.ByteBuffer;for(s=0;s<Y;s++){var ae=new $.util.ByteBuffer(w.getBytes(f)),K=511;for(u=q.length()-1;u>=0;u--)K=K>>8,K+=q.at(u)+ae.at(u),ae.setAt(u,K&255);H.putBuffer(ae)}w=H,d.putBuffer(R)}return d.truncate(d.length()-n),d};se.pbe.getCipher=function(e,t,a){switch(e){case se.oids.pkcs5PBES2:return se.pbe.getCipherForPBES2(e,t,a);case se.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case se.oids["pbewithSHAAnd40BitRC2-CBC"]:return se.pbe.getCipherForPKCS12PBE(e,t,a);default:var r=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw r.oid=e,r.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],r}};se.pbe.getCipherForPBES2=function(e,t,a){var r={},n=[];if(!P.validate(t,Yy,r,n)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=n,i}if(e=P.derToOid(r.kdfOid),e!==se.oids.pkcs5PBKDF2){var i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw i.oid=e,i.supportedOids=["pkcs5PBKDF2"],i}if(e=P.derToOid(r.encOid),e!==se.oids["aes128-CBC"]&&e!==se.oids["aes192-CBC"]&&e!==se.oids["aes256-CBC"]&&e!==se.oids["des-EDE3-CBC"]&&e!==se.oids.desCBC){var i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw i.oid=e,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i}var s=r.kdfSalt,u=$.util.createBuffer(r.kdfIterationCount);u=u.getInt(u.length()<<3);var c,f;switch(se.oids[e]){case"aes128-CBC":c=16,f=$.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,f=$.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,f=$.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,f=$.des.createDecryptionCipher;break;case"desCBC":c=8,f=$.des.createDecryptionCipher;break}var d=fc(r.prfOid),h=$.pkcs5.pbkdf2(a,s,u,c,d),C=r.encIv,E=f(h);return E.start(C),E};se.pbe.getCipherForPKCS12PBE=function(e,t,a){var r={},n=[];if(!P.validate(t,Xy,r,n)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=n,i}var s=$.util.createBuffer(r.salt),u=$.util.createBuffer(r.iterations);u=u.getInt(u.length()<<3);var c,f,d;switch(e){case se.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,f=8,d=$.des.startDecrypting;break;case se.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,f=8,d=function(_,S){var b=$.rc2.createDecryptionCipher(_,40);return b.start(S,null),b};break;default:var i=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw i.oid=e,i}var h=fc(r.prfOid),C=se.pbe.generatePkcs12Key(a,s,1,u,c,h);h.start();var E=se.pbe.generatePkcs12Key(a,s,2,u,f,h);return d(C,E)};se.pbe.opensslDeriveBytes=function(e,t,a,r){if(typeof r>"u"||r===null){if(!("md5"in $.md))throw new Error('"md5" hash algorithm unavailable.');r=$.md.md5.create()}t===null&&(t="");for(var n=[lc(r,e+t)],i=16,s=1;i<a;++s,i+=16)n.push(lc(r,n[s-1]+e+t));return n.join("").substr(0,a)};function lc(e,t){return e.start().update(t).digest().getBytes()}function fc(e){var t;if(!e)t="hmacWithSHA1";else if(t=se.oids[P.derToOid(e)],!t){var a=new Error("Unsupported PRF OID.");throw a.oid=e,a.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],a}return cc(t)}function cc(e){var t=$.md;switch(e){case"hmacWithSHA224":t=$.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var a=new Error("Unsupported PRF algorithm.");throw a.algorithm=e,a.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],a}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function Zy(e,t,a,r){var n=P.create(P.Class.UNIVERSAL,P.Type.SEQUENCE,!0,[P.create(P.Class.UNIVERSAL,P.Type.OCTETSTRING,!1,e),P.create(P.Class.UNIVERSAL,P.Type.INTEGER,!1,t.getBytes())]);return r!=="hmacWithSHA1"&&n.value.push(P.create(P.Class.UNIVERSAL,P.Type.INTEGER,!1,$.util.hexToBytes(a.toString(16))),P.create(P.Class.UNIVERSAL,P.Type.SEQUENCE,!0,[P.create(P.Class.UNIVERSAL,P.Type.OID,!1,P.oidToDer(se.oids[r]).getBytes()),P.create(P.Class.UNIVERSAL,P.Type.NULL,!1,"")])),n}});var Io=ne((l1,yc)=>{var Ua=ue();Qt();me();var j=Ua.asn1,Oa=yc.exports=Ua.pkcs7asn1=Ua.pkcs7asn1||{};Ua.pkcs7=Ua.pkcs7||{};Ua.pkcs7.asn1=Oa;var hc={name:"ContentInfo",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:j.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};Oa.contentInfoValidator=hc;var pc={name:"EncryptedContentInfo",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:j.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:j.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};Oa.envelopedDataValidator={name:"EnvelopedData",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:j.Class.UNIVERSAL,type:j.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(pc)};Oa.encryptedDataValidator={name:"EncryptedData",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"version"}].concat(pc)};var Jy={name:"SignerInfo",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:j.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:j.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:j.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};Oa.signedDataValidator={name:"SignedData",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:j.Class.UNIVERSAL,type:j.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},hc,{name:"SignedData.Certificates",tagClass:j.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:j.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:j.Class.UNIVERSAL,type:j.Type.SET,capture:"signerInfos",optional:!0,value:[Jy]}]};Oa.recipientInfoValidator={name:"RecipientInfo",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:j.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var Bo=ne((f1,gc)=>{var ua=ue();me();ua.mgf=ua.mgf||{};var eg=gc.exports=ua.mgf.mgf1=ua.mgf1=ua.mgf1||{};eg.create=function(e){var t={generate:function(a,r){for(var n=new ua.util.ByteBuffer,i=Math.ceil(r/e.digestLength),s=0;s<i;s++){var u=new ua.util.ByteBuffer;u.putInt32(s),e.start(),e.update(a+u.getBytes()),n.putBuffer(e.digest())}return n.truncate(n.length()-r),n.getBytes()}};return t}});var vc=ne((c1,mc)=>{var Xi=ue();Bo();mc.exports=Xi.mgf=Xi.mgf||{};Xi.mgf.mgf1=Xi.mgf1});var Zi=ne((d1,Cc)=>{var la=ue();Pt();me();var tg=Cc.exports=la.pss=la.pss||{};tg.create=function(e){arguments.length===3&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t=e.md,a=e.mgf,r=t.digestLength,n=e.salt||null;typeof n=="string"&&(n=la.util.createBuffer(n));var i;if("saltLength"in e)i=e.saltLength;else if(n!==null)i=n.length();else throw new Error("Salt length not specified or specific salt not given.");if(n!==null&&n.length()!==i)throw new Error("Given salt length does not match length of given salt.");var s=e.prng||la.random,u={};return u.encode=function(c,f){var d,h=f-1,C=Math.ceil(h/8),E=c.digest().getBytes();if(C<r+i+2)throw new Error("Message is too long to encrypt.");var g;n===null?g=s.getBytesSync(i):g=n.bytes();var _=new la.util.ByteBuffer;_.fillWithByte(0,8),_.putBytes(E),_.putBytes(g),t.start(),t.update(_.getBytes());var S=t.digest().getBytes(),b=new la.util.ByteBuffer;b.fillWithByte(0,C-i-r-2),b.putByte(1),b.putBytes(g);var A=b.getBytes(),w=C-r-1,D=a.generate(S,w),k="";for(d=0;d<w;d++)k+=String.fromCharCode(A.charCodeAt(d)^D.charCodeAt(d));var R=65280>>8*C-h&255;return k=String.fromCharCode(k.charCodeAt(0)&~R)+k.substr(1),k+S+String.fromCharCode(188)},u.verify=function(c,f,d){var h,C=d-1,E=Math.ceil(C/8);if(f=f.substr(-E),E<r+i+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(f.charCodeAt(E-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var g=E-r-1,_=f.substr(0,g),S=f.substr(g,r),b=65280>>8*E-C&255;if((_.charCodeAt(0)&b)!==0)throw new Error("Bits beyond keysize not zero as expected.");var A=a.generate(S,g),w="";for(h=0;h<g;h++)w+=String.fromCharCode(_.charCodeAt(h)^A.charCodeAt(h));w=String.fromCharCode(w.charCodeAt(0)&~b)+w.substr(1);var D=E-r-i-2;for(h=0;h<D;h++)if(w.charCodeAt(h)!==0)throw new Error("Leftmost octets not zero as expected");if(w.charCodeAt(D)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var k=w.substr(-i),R=new la.util.ByteBuffer;R.fillWithByte(0,8),R.putBytes(c),R.putBytes(k),t.start(),t.update(R.getBytes());var G=t.digest().getBytes();return S===G},u}});var ts=ne((h1,Tc)=>{var ee=ue();Or();Qt();In();Jt();vc();Fr();na();Zi();Rn();me();var y=ee.asn1,z=Tc.exports=ee.pki=ee.pki||{},ge=z.oids,Me={};Me.CN=ge.commonName;Me.commonName="CN";Me.C=ge.countryName;Me.countryName="C";Me.L=ge.localityName;Me.localityName="L";Me.ST=ge.stateOrProvinceName;Me.stateOrProvinceName="ST";Me.O=ge.organizationName;Me.organizationName="O";Me.OU=ge.organizationalUnitName;Me.organizationalUnitName="OU";Me.E=ge.emailAddress;Me.emailAddress="E";var Ec=ee.pki.rsa.publicKeyValidator,rg={name:"Certificate",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:y.Class.UNIVERSAL,type:y.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:y.Class.UNIVERSAL,type:y.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:y.Class.UNIVERSAL,type:y.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:y.Class.UNIVERSAL,type:y.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},Ec,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:y.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:y.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:y.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},ag={name:"rsapss",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:y.Class.UNIVERSAL,type:y.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:y.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:y.Class.UNIVERSAL,type:y.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:y.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:y.Class.UNIVERSAL,type:y.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:y.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:y.Class.UNIVERSAL,type:y.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},ng={name:"CertificationRequestInfo",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},Ec,{name:"CertificationRequestInfo.attributes",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:y.Class.UNIVERSAL,type:y.Type.SET,constructed:!0}]}]}]},ig={name:"CertificationRequest",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[ng,{name:"CertificationRequest.signatureAlgorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};z.RDNAttributesAsArray=function(e,t){for(var a=[],r,n,i,s=0;s<e.value.length;++s){r=e.value[s];for(var u=0;u<r.value.length;++u)i={},n=r.value[u],i.type=y.derToOid(n.value[0].value),i.value=n.value[1].value,i.valueTagClass=n.value[1].type,i.type in ge&&(i.name=ge[i.type],i.name in Me&&(i.shortName=Me[i.name])),t&&(t.update(i.type),t.update(i.value)),a.push(i)}return a};z.CRIAttributesAsArray=function(e){for(var t=[],a=0;a<e.length;++a)for(var r=e[a],n=y.derToOid(r.value[0].value),i=r.value[1].value,s=0;s<i.length;++s){var u={};if(u.type=n,u.value=i[s].value,u.valueTagClass=i[s].type,u.type in ge&&(u.name=ge[u.type],u.name in Me&&(u.shortName=Me[u.name])),u.type===ge.extensionRequest){u.extensions=[];for(var c=0;c<u.value.length;++c)u.extensions.push(z.certificateExtensionFromAsn1(u.value[c]))}t.push(u)}return t};function Mr(e,t){typeof t=="string"&&(t={shortName:t});for(var a=null,r,n=0;a===null&&n<e.attributes.length;++n)r=e.attributes[n],(t.type&&t.type===r.type||t.name&&t.name===r.name||t.shortName&&t.shortName===r.shortName)&&(a=r);return a}var Ji=function(e,t,a){var r={};if(e!==ge["RSASSA-PSS"])return r;a&&(r={hash:{algorithmOid:ge.sha1},mgf:{algorithmOid:ge.mgf1,hash:{algorithmOid:ge.sha1}},saltLength:20});var n={},i=[];if(!y.validate(t,ag,n,i)){var s=new Error("Cannot read RSASSA-PSS parameter block.");throw s.errors=i,s}return n.hashOid!==void 0&&(r.hash=r.hash||{},r.hash.algorithmOid=y.derToOid(n.hashOid)),n.maskGenOid!==void 0&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=y.derToOid(n.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=y.derToOid(n.maskGenHashOid)),n.saltLength!==void 0&&(r.saltLength=n.saltLength.charCodeAt(0)),r},es=function(e){switch(ge[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return ee.md.sha1.create();case"md5WithRSAEncryption":return ee.md.md5.create();case"sha256WithRSAEncryption":return ee.md.sha256.create();case"sha384WithRSAEncryption":return ee.md.sha384.create();case"sha512WithRSAEncryption":return ee.md.sha512.create();case"RSASSA-PSS":return ee.md.sha256.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},bc=function(e){var t=e.certificate,a;switch(t.signatureOid){case ge.sha1WithRSAEncryption:case ge.sha1WithRSASignature:break;case ge["RSASSA-PSS"]:var r,n;if(r=ge[t.signatureParameters.mgf.hash.algorithmOid],r===void 0||ee.md[r]===void 0){var i=new Error("Unsupported MGF hash function.");throw i.oid=t.signatureParameters.mgf.hash.algorithmOid,i.name=r,i}if(n=ge[t.signatureParameters.mgf.algorithmOid],n===void 0||ee.mgf[n]===void 0){var i=new Error("Unsupported MGF function.");throw i.oid=t.signatureParameters.mgf.algorithmOid,i.name=n,i}if(n=ee.mgf[n].create(ee.md[r].create()),r=ge[t.signatureParameters.hash.algorithmOid],r===void 0||ee.md[r]===void 0){var i=new Error("Unsupported RSASSA-PSS hash function.");throw i.oid=t.signatureParameters.hash.algorithmOid,i.name=r,i}a=ee.pss.create(ee.md[r].create(),n,t.signatureParameters.saltLength);break}return t.publicKey.verify(e.md.digest().getBytes(),e.signature,a)};z.certificateFromPem=function(e,t,a){var r=ee.pem.decode(e)[0];if(r.type!=="CERTIFICATE"&&r.type!=="X509 CERTIFICATE"&&r.type!=="TRUSTED CERTIFICATE"){var n=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw n.headerType=r.type,n}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var i=y.fromDer(r.body,a);return z.certificateFromAsn1(i,t)};z.certificateToPem=function(e,t){var a={type:"CERTIFICATE",body:y.toDer(z.certificateToAsn1(e)).getBytes()};return ee.pem.encode(a,{maxline:t})};z.publicKeyFromPem=function(e){var t=ee.pem.decode(e)[0];if(t.type!=="PUBLIC KEY"&&t.type!=="RSA PUBLIC KEY"){var a=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var r=y.fromDer(t.body);return z.publicKeyFromAsn1(r)};z.publicKeyToPem=function(e,t){var a={type:"PUBLIC KEY",body:y.toDer(z.publicKeyToAsn1(e)).getBytes()};return ee.pem.encode(a,{maxline:t})};z.publicKeyToRSAPublicKeyPem=function(e,t){var a={type:"RSA PUBLIC KEY",body:y.toDer(z.publicKeyToRSAPublicKey(e)).getBytes()};return ee.pem.encode(a,{maxline:t})};z.getPublicKeyFingerprint=function(e,t){t=t||{};var a=t.md||ee.md.sha1.create(),r=t.type||"RSAPublicKey",n;switch(r){case"RSAPublicKey":n=y.toDer(z.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":n=y.toDer(z.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}a.start(),a.update(n);var i=a.digest();if(t.encoding==="hex"){var s=i.toHex();return t.delimiter?s.match(/.{2}/g).join(t.delimiter):s}else{if(t.encoding==="binary")return i.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return i};z.certificationRequestFromPem=function(e,t,a){var r=ee.pem.decode(e)[0];if(r.type!=="CERTIFICATE REQUEST"){var n=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw n.headerType=r.type,n}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var i=y.fromDer(r.body,a);return z.certificationRequestFromAsn1(i,t)};z.certificationRequestToPem=function(e,t){var a={type:"CERTIFICATE REQUEST",body:y.toDer(z.certificationRequestToAsn1(e)).getBytes()};return ee.pem.encode(a,{maxline:t})};z.createCertificate=function(){var e={};return e.version=2,e.serialNumber="00",e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return Mr(e.issuer,t)},e.issuer.addField=function(t){Ft([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return Mr(e.subject,t)},e.subject.addField=function(t){Ft([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,a){Ft(t),e.subject.attributes=t,delete e.subject.uniqueId,a&&(e.subject.uniqueId=a),e.subject.hash=null},e.setIssuer=function(t,a){Ft(t),e.issuer.attributes=t,delete e.issuer.uniqueId,a&&(e.issuer.uniqueId=a),e.issuer.hash=null},e.setExtensions=function(t){for(var a=0;a<t.length;++a)xc(t[a],{cert:e});e.extensions=t},e.getExtension=function(t){typeof t=="string"&&(t={name:t});for(var a=null,r,n=0;a===null&&n<e.extensions.length;++n)r=e.extensions[n],(t.id&&r.id===t.id||t.name&&r.name===t.name)&&(a=r);return a},e.sign=function(t,a){e.md=a||ee.md.sha1.create();var r=ge[e.md.algorithm+"WithRSAEncryption"];if(!r){var n=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw n.algorithm=e.md.algorithm,n}e.signatureOid=e.siginfo.algorithmOid=r,e.tbsCertificate=z.getTBSCertificate(e);var i=y.toDer(e.tbsCertificate);e.md.update(i.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var a=!1;if(!e.issued(t)){var r=t.issuer,n=e.subject,i=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw i.expectedIssuer=n.attributes,i.actualIssuer=r.attributes,i}var s=t.md;if(s===null){s=es({signatureOid:t.signatureOid,type:"certificate"});var u=t.tbsCertificate||z.getTBSCertificate(t),c=y.toDer(u);s.update(c.getBytes())}return s!==null&&(a=bc({certificate:e,md:s,signature:t.signature})),a},e.isIssuer=function(t){var a=!1,r=e.issuer,n=t.subject;if(r.hash&&n.hash)a=r.hash===n.hash;else if(r.attributes.length===n.attributes.length){a=!0;for(var i,s,u=0;a&&u<r.attributes.length;++u)i=r.attributes[u],s=n.attributes[u],(i.type!==s.type||i.value!==s.value)&&(a=!1)}return a},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return z.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=ge.subjectKeyIdentifier,a=0;a<e.extensions.length;++a){var r=e.extensions[a];if(r.id===t){var n=e.generateSubjectKeyIdentifier().getBytes();return ee.util.hexToBytes(r.subjectKeyIdentifier)===n}}return!1},e};z.certificateFromAsn1=function(e,t){var a={},r=[];if(!y.validate(e,rg,a,r)){var n=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw n.errors=r,n}var i=y.derToOid(a.publicKeyOid);if(i!==z.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var s=z.createCertificate();s.version=a.certVersion?a.certVersion.charCodeAt(0):0;var u=ee.util.createBuffer(a.certSerialNumber);s.serialNumber=u.toHex(),s.signatureOid=ee.asn1.derToOid(a.certSignatureOid),s.signatureParameters=Ji(s.signatureOid,a.certSignatureParams,!0),s.siginfo.algorithmOid=ee.asn1.derToOid(a.certinfoSignatureOid),s.siginfo.parameters=Ji(s.siginfo.algorithmOid,a.certinfoSignatureParams,!1),s.signature=a.certSignature;var c=[];if(a.certValidity1UTCTime!==void 0&&c.push(y.utcTimeToDate(a.certValidity1UTCTime)),a.certValidity2GeneralizedTime!==void 0&&c.push(y.generalizedTimeToDate(a.certValidity2GeneralizedTime)),a.certValidity3UTCTime!==void 0&&c.push(y.utcTimeToDate(a.certValidity3UTCTime)),a.certValidity4GeneralizedTime!==void 0&&c.push(y.generalizedTimeToDate(a.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(s.validity.notBefore=c[0],s.validity.notAfter=c[1],s.tbsCertificate=a.tbsCertificate,t){s.md=es({signatureOid:s.signatureOid,type:"certificate"});var f=y.toDer(s.tbsCertificate);s.md.update(f.getBytes())}var d=ee.md.sha1.create(),h=y.toDer(a.certIssuer);d.update(h.getBytes()),s.issuer.getField=function(g){return Mr(s.issuer,g)},s.issuer.addField=function(g){Ft([g]),s.issuer.attributes.push(g)},s.issuer.attributes=z.RDNAttributesAsArray(a.certIssuer),a.certIssuerUniqueId&&(s.issuer.uniqueId=a.certIssuerUniqueId),s.issuer.hash=d.digest().toHex();var C=ee.md.sha1.create(),E=y.toDer(a.certSubject);return C.update(E.getBytes()),s.subject.getField=function(g){return Mr(s.subject,g)},s.subject.addField=function(g){Ft([g]),s.subject.attributes.push(g)},s.subject.attributes=z.RDNAttributesAsArray(a.certSubject),a.certSubjectUniqueId&&(s.subject.uniqueId=a.certSubjectUniqueId),s.subject.hash=C.digest().toHex(),a.certExtensions?s.extensions=z.certificateExtensionsFromAsn1(a.certExtensions):s.extensions=[],s.publicKey=z.publicKeyFromAsn1(a.subjectPublicKeyInfo),s};z.certificateExtensionsFromAsn1=function(e){for(var t=[],a=0;a<e.value.length;++a)for(var r=e.value[a],n=0;n<r.value.length;++n)t.push(z.certificateExtensionFromAsn1(r.value[n]));return t};z.certificateExtensionFromAsn1=function(e){var t={};if(t.id=y.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===y.Type.BOOLEAN?(t.critical=e.value[1].value.charCodeAt(0)!==0,t.value=e.value[2].value):t.value=e.value[1].value,t.id in ge){if(t.name=ge[t.id],t.name==="keyUsage"){var a=y.fromDer(t.value),r=0,n=0;a.value.length>1&&(r=a.value.charCodeAt(1),n=a.value.length>2?a.value.charCodeAt(2):0),t.digitalSignature=(r&128)===128,t.nonRepudiation=(r&64)===64,t.keyEncipherment=(r&32)===32,t.dataEncipherment=(r&16)===16,t.keyAgreement=(r&8)===8,t.keyCertSign=(r&4)===4,t.cRLSign=(r&2)===2,t.encipherOnly=(r&1)===1,t.decipherOnly=(n&128)===128}else if(t.name==="basicConstraints"){var a=y.fromDer(t.value);a.value.length>0&&a.value[0].type===y.Type.BOOLEAN?t.cA=a.value[0].value.charCodeAt(0)!==0:t.cA=!1;var i=null;a.value.length>0&&a.value[0].type===y.Type.INTEGER?i=a.value[0].value:a.value.length>1&&(i=a.value[1].value),i!==null&&(t.pathLenConstraint=y.derToInteger(i))}else if(t.name==="extKeyUsage")for(var a=y.fromDer(t.value),s=0;s<a.value.length;++s){var u=y.derToOid(a.value[s].value);u in ge?t[ge[u]]=!0:t[u]=!0}else if(t.name==="nsCertType"){var a=y.fromDer(t.value),r=0;a.value.length>1&&(r=a.value.charCodeAt(1)),t.client=(r&128)===128,t.server=(r&64)===64,t.email=(r&32)===32,t.objsign=(r&16)===16,t.reserved=(r&8)===8,t.sslCA=(r&4)===4,t.emailCA=(r&2)===2,t.objCA=(r&1)===1}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.altNames=[];for(var c,a=y.fromDer(t.value),f=0;f<a.value.length;++f){c=a.value[f];var d={type:c.type,value:c.value};switch(t.altNames.push(d),c.type){case 1:case 2:case 6:break;case 7:d.ip=ee.util.bytesToIP(c.value);break;case 8:d.oid=y.derToOid(c.value);break;default:}}}else if(t.name==="subjectKeyIdentifier"){var a=y.fromDer(t.value);t.subjectKeyIdentifier=ee.util.bytesToHex(a.value)}}return t};z.certificationRequestFromAsn1=function(e,t){var a={},r=[];if(!y.validate(e,ig,a,r)){var n=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw n.errors=r,n}var i=y.derToOid(a.publicKeyOid);if(i!==z.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var s=z.createCertificationRequest();if(s.version=a.csrVersion?a.csrVersion.charCodeAt(0):0,s.signatureOid=ee.asn1.derToOid(a.csrSignatureOid),s.signatureParameters=Ji(s.signatureOid,a.csrSignatureParams,!0),s.siginfo.algorithmOid=ee.asn1.derToOid(a.csrSignatureOid),s.siginfo.parameters=Ji(s.siginfo.algorithmOid,a.csrSignatureParams,!1),s.signature=a.csrSignature,s.certificationRequestInfo=a.certificationRequestInfo,t){s.md=es({signatureOid:s.signatureOid,type:"certification request"});var u=y.toDer(s.certificationRequestInfo);s.md.update(u.getBytes())}var c=ee.md.sha1.create();return s.subject.getField=function(f){return Mr(s.subject,f)},s.subject.addField=function(f){Ft([f]),s.subject.attributes.push(f)},s.subject.attributes=z.RDNAttributesAsArray(a.certificationRequestInfoSubject,c),s.subject.hash=c.digest().toHex(),s.publicKey=z.publicKeyFromAsn1(a.subjectPublicKeyInfo),s.getAttribute=function(f){return Mr(s,f)},s.addAttribute=function(f){Ft([f]),s.attributes.push(f)},s.attributes=z.CRIAttributesAsArray(a.certificationRequestInfoAttributes||[]),s};z.createCertificationRequest=function(){var e={};return e.version=0,e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return Mr(e.subject,t)},e.subject.addField=function(t){Ft([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return Mr(e,t)},e.addAttribute=function(t){Ft([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){Ft(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){Ft(t),e.attributes=t},e.sign=function(t,a){e.md=a||ee.md.sha1.create();var r=ge[e.md.algorithm+"WithRSAEncryption"];if(!r){var n=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw n.algorithm=e.md.algorithm,n}e.signatureOid=e.siginfo.algorithmOid=r,e.certificationRequestInfo=z.getCertificationRequestInfo(e);var i=y.toDer(e.certificationRequestInfo);e.md.update(i.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,a=e.md;if(a===null){a=es({signatureOid:e.signatureOid,type:"certification request"});var r=e.certificationRequestInfo||z.getCertificationRequestInfo(e),n=y.toDer(r);a.update(n.getBytes())}return a!==null&&(t=bc({certificate:e,md:a,signature:e.signature})),t},e};function Fa(e){for(var t=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),a,r,n=e.attributes,i=0;i<n.length;++i){a=n[i];var s=a.value,u=y.Type.PRINTABLESTRING;"valueTagClass"in a&&(u=a.valueTagClass,u===y.Type.UTF8&&(s=ee.util.encodeUtf8(s))),r=y.create(y.Class.UNIVERSAL,y.Type.SET,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(a.type).getBytes()),y.create(y.Class.UNIVERSAL,u,!1,s)])]),t.value.push(r)}return t}function Ft(e){for(var t,a=0;a<e.length;++a){if(t=e[a],typeof t.name>"u"&&(t.type&&t.type in z.oids?t.name=z.oids[t.type]:t.shortName&&t.shortName in Me&&(t.name=z.oids[Me[t.shortName]])),typeof t.type>"u")if(t.name&&t.name in z.oids)t.type=z.oids[t.name];else{var r=new Error("Attribute type not specified.");throw r.attribute=t,r}if(typeof t.shortName>"u"&&t.name&&t.name in Me&&(t.shortName=Me[t.name]),t.type===ge.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=y.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var n=0;n<t.extensions.length;++n)t.value.push(z.certificateExtensionToAsn1(xc(t.extensions[n])))}if(typeof t.value>"u"){var r=new Error("Attribute value not specified.");throw r.attribute=t,r}}}function xc(e,t){if(t=t||{},typeof e.name>"u"&&e.id&&e.id in z.oids&&(e.name=z.oids[e.id]),typeof e.id>"u")if(e.name&&e.name in z.oids)e.id=z.oids[e.name];else{var a=new Error("Extension ID not specified.");throw a.extension=e,a}if(typeof e.value<"u")return e;if(e.name==="keyUsage"){var r=0,n=0,i=0;e.digitalSignature&&(n|=128,r=7),e.nonRepudiation&&(n|=64,r=6),e.keyEncipherment&&(n|=32,r=5),e.dataEncipherment&&(n|=16,r=4),e.keyAgreement&&(n|=8,r=3),e.keyCertSign&&(n|=4,r=2),e.cRLSign&&(n|=2,r=1),e.encipherOnly&&(n|=1,r=0),e.decipherOnly&&(i|=128,r=7);var s=String.fromCharCode(r);i!==0?s+=String.fromCharCode(n)+String.fromCharCode(i):n!==0&&(s+=String.fromCharCode(n)),e.value=y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,s)}else if(e.name==="basicConstraints")e.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(y.create(y.Class.UNIVERSAL,y.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(e.pathLenConstraint).getBytes()));else if(e.name==="extKeyUsage"){e.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);var u=e.value.value;for(var c in e)e[c]===!0&&(c in ge?u.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(ge[c]).getBytes())):c.indexOf(".")!==-1&&u.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(c).getBytes())))}else if(e.name==="nsCertType"){var r=0,n=0;e.client&&(n|=128,r=7),e.server&&(n|=64,r=6),e.email&&(n|=32,r=5),e.objsign&&(n|=16,r=4),e.reserved&&(n|=8,r=3),e.sslCA&&(n|=4,r=2),e.emailCA&&(n|=2,r=1),e.objCA&&(n|=1,r=0);var s=String.fromCharCode(r);n!==0&&(s+=String.fromCharCode(n)),e.value=y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,s)}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);for(var f,d=0;d<e.altNames.length;++d){f=e.altNames[d];var s=f.value;if(f.type===7&&f.ip){if(s=ee.util.bytesFromIP(f.ip),s===null){var a=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw a.extension=e,a}}else f.type===8&&(f.oid?s=y.oidToDer(y.oidToDer(f.oid)):s=y.oidToDer(s));e.value.value.push(y.create(y.Class.CONTEXT_SPECIFIC,f.type,!1,s))}}else if(e.name==="nsComment"&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=y.create(y.Class.UNIVERSAL,y.Type.IA5STRING,!1,e.comment)}else if(e.name==="subjectKeyIdentifier"&&t.cert){var h=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=h.toHex(),e.value=y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,h.getBytes())}else if(e.name==="authorityKeyIdentifier"&&t.cert){e.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);var u=e.value.value;if(e.keyIdentifier){var C=e.keyIdentifier===!0?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;u.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!1,C))}if(e.authorityCertIssuer){var E=[y.create(y.Class.CONTEXT_SPECIFIC,4,!0,[Fa(e.authorityCertIssuer===!0?t.cert.issuer:e.authorityCertIssuer)])];u.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,E))}if(e.serialNumber){var g=ee.util.hexToBytes(e.serialNumber===!0?t.cert.serialNumber:e.serialNumber);u.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if(e.name==="cRLDistributionPoints"){e.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);for(var u=e.value.value,_=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),S=y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[]),f,d=0;d<e.altNames.length;++d){f=e.altNames[d];var s=f.value;if(f.type===7&&f.ip){if(s=ee.util.bytesFromIP(f.ip),s===null){var a=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw a.extension=e,a}}else f.type===8&&(f.oid?s=y.oidToDer(y.oidToDer(f.oid)):s=y.oidToDer(s));S.value.push(y.create(y.Class.CONTEXT_SPECIFIC,f.type,!1,s))}_.value.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[S])),u.push(_)}if(typeof e.value>"u"){var a=new Error("Extension value not specified.");throw a.extension=e,a}return e}function wo(e,t){switch(e){case ge["RSASSA-PSS"]:var a=[];return t.hash.algorithmOid!==void 0&&a.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.hash.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")])])),t.mgf.algorithmOid!==void 0&&a.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.mgf.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.mgf.hash.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")])])])),t.saltLength!==void 0&&a.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(t.saltLength).getBytes())])),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,a);default:return y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")}}function sg(e){var t=y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[]);if(e.attributes.length===0)return t;for(var a=e.attributes,r=0;r<a.length;++r){var n=a[r],i=n.value,s=y.Type.UTF8;"valueTagClass"in n&&(s=n.valueTagClass),s===y.Type.UTF8&&(i=ee.util.encodeUtf8(i));var u=!1;"valueConstructed"in n&&(u=n.valueConstructed);var c=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(n.type).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SET,!0,[y.create(y.Class.UNIVERSAL,s,u,i)])]);t.value.push(c)}return t}var og=new Date("1950-01-01T00:00:00Z"),ug=new Date("2050-01-01T00:00:00Z");function Sc(e){return e>=og&&e<ug?y.create(y.Class.UNIVERSAL,y.Type.UTCTIME,!1,y.dateToUtcTime(e)):y.create(y.Class.UNIVERSAL,y.Type.GENERALIZEDTIME,!1,y.dateToGeneralizedTime(e))}z.getTBSCertificate=function(e){var t=Sc(e.validity.notBefore),a=Sc(e.validity.notAfter),r=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(e.version).getBytes())]),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,ee.util.hexToBytes(e.serialNumber)),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.siginfo.algorithmOid).getBytes()),wo(e.siginfo.algorithmOid,e.siginfo.parameters)]),Fa(e.issuer),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[t,a]),Fa(e.subject),z.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&r.value.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,[y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&r.value.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!0,[y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&r.value.push(z.certificateExtensionsToAsn1(e.extensions)),r};z.getCertificationRequestInfo=function(e){var t=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(e.version).getBytes()),Fa(e.subject),z.publicKeyToAsn1(e.publicKey),sg(e)]);return t};z.distinguishedNameToAsn1=function(e){return Fa(e)};z.certificateToAsn1=function(e){var t=e.tbsCertificate||z.getTBSCertificate(e);return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[t,y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.signatureOid).getBytes()),wo(e.signatureOid,e.signatureParameters)]),y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])};z.certificateExtensionsToAsn1=function(e){var t=y.create(y.Class.CONTEXT_SPECIFIC,3,!0,[]),a=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);t.value.push(a);for(var r=0;r<e.length;++r)a.value.push(z.certificateExtensionToAsn1(e[r]));return t};z.certificateExtensionToAsn1=function(e){var t=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);t.value.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.id).getBytes())),e.critical&&t.value.push(y.create(y.Class.UNIVERSAL,y.Type.BOOLEAN,!1,String.fromCharCode(255)));var a=e.value;return typeof e.value!="string"&&(a=y.toDer(a).getBytes()),t.value.push(y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,a)),t};z.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||z.getCertificationRequestInfo(e);return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[t,y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.signatureOid).getBytes()),wo(e.signatureOid,e.signatureParameters)]),y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])};z.createCaStore=function(e){var t={certs:{}};t.getIssuer=function(s){var u=a(s.issuer);return u},t.addCertificate=function(s){if(typeof s=="string"&&(s=ee.pki.certificateFromPem(s)),r(s.subject),!t.hasCertificate(s))if(s.subject.hash in t.certs){var u=t.certs[s.subject.hash];ee.util.isArray(u)||(u=[u]),u.push(s),t.certs[s.subject.hash]=u}else t.certs[s.subject.hash]=s},t.hasCertificate=function(s){typeof s=="string"&&(s=ee.pki.certificateFromPem(s));var u=a(s.subject);if(!u)return!1;ee.util.isArray(u)||(u=[u]);for(var c=y.toDer(z.certificateToAsn1(s)).getBytes(),f=0;f<u.length;++f){var d=y.toDer(z.certificateToAsn1(u[f])).getBytes();if(c===d)return!0}return!1},t.listAllCertificates=function(){var s=[];for(var u in t.certs)if(t.certs.hasOwnProperty(u)){var c=t.certs[u];if(!ee.util.isArray(c))s.push(c);else for(var f=0;f<c.length;++f)s.push(c[f])}return s},t.removeCertificate=function(s){var u;if(typeof s=="string"&&(s=ee.pki.certificateFromPem(s)),r(s.subject),!t.hasCertificate(s))return null;var c=a(s.subject);if(!ee.util.isArray(c))return u=t.certs[s.subject.hash],delete t.certs[s.subject.hash],u;for(var f=y.toDer(z.certificateToAsn1(s)).getBytes(),d=0;d<c.length;++d){var h=y.toDer(z.certificateToAsn1(c[d])).getBytes();f===h&&(u=c[d],c.splice(d,1))}return c.length===0&&delete t.certs[s.subject.hash],u};function a(s){return r(s),t.certs[s.hash]||null}function r(s){if(!s.hash){var u=ee.md.sha1.create();s.attributes=z.RDNAttributesAsArray(Fa(s),u),s.hash=u.digest().toHex()}}if(e)for(var n=0;n<e.length;++n){var i=e[n];t.addCertificate(i)}return t};z.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};z.verifyCertificateChain=function(e,t,a){typeof a=="function"&&(a={verify:a}),a=a||{},t=t.slice(0);var r=t.slice(0),n=a.validityCheckDate;typeof n>"u"&&(n=new Date);var i=!0,s=null,u=0;do{var c=t.shift(),f=null,d=!1;if(n&&(n<c.validity.notBefore||n>c.validity.notAfter)&&(s={message:"Certificate is not valid yet or has expired.",error:z.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:n}),s===null){if(f=t[0]||e.getIssuer(c),f===null&&c.isIssuer(c)&&(d=!0,f=c),f){var h=f;ee.util.isArray(h)||(h=[h]);for(var C=!1;!C&&h.length>0;){f=h.shift();try{C=f.verify(c)}catch{}}C||(s={message:"Certificate signature is invalid.",error:z.certificateError.bad_certificate})}s===null&&(!f||d)&&!e.hasCertificate(c)&&(s={message:"Certificate is not trusted.",error:z.certificateError.unknown_ca})}if(s===null&&f&&!c.isIssuer(f)&&(s={message:"Certificate issuer is invalid.",error:z.certificateError.bad_certificate}),s===null)for(var E={keyUsage:!0,basicConstraints:!0},g=0;s===null&&g<c.extensions.length;++g){var _=c.extensions[g];_.critical&&!(_.name in E)&&(s={message:"Certificate has an unsupported critical extension.",error:z.certificateError.unsupported_certificate})}if(s===null&&(!i||t.length===0&&(!f||d))){var S=c.getExtension("basicConstraints"),b=c.getExtension("keyUsage");if(b!==null&&(!b.keyCertSign||S===null)&&(s={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:z.certificateError.bad_certificate}),s===null&&S!==null&&!S.cA&&(s={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:z.certificateError.bad_certificate}),s===null&&b!==null&&"pathLenConstraint"in S){var A=u-1;A>S.pathLenConstraint&&(s={message:"Certificate basicConstraints pathLenConstraint violated.",error:z.certificateError.bad_certificate})}}var w=s===null?!0:s.error,D=a.verify?a.verify(w,u,r):w;if(D===!0)s=null;else throw w===!0&&(s={message:"The application rejected the certificate.",error:z.certificateError.bad_certificate}),(D||D===0)&&(typeof D=="object"&&!ee.util.isArray(D)?(D.message&&(s.message=D.message),D.error&&(s.error=D.error)):typeof D=="string"&&(s.error=D)),s;i=!1,++u}while(t.length>0);return!0}});var No=ne((p1,_c)=>{var Le=ue();Qt();Na();Fr();Io();_o();Pt();Rn();Pa();me();ts();var T=Le.asn1,fe=Le.pki,Ln=_c.exports=Le.pkcs12=Le.pkcs12||{},Ac={name:"ContentInfo",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:T.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},lg={name:"PFX",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,capture:"version"},Ac,{name:"PFX.macData",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:T.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:T.Class.UNIVERSAL,type:T.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:T.Class.UNIVERSAL,type:T.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:T.Class.UNIVERSAL,type:T.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},fg={name:"SafeBag",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:T.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:T.Class.UNIVERSAL,type:T.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},cg={name:"Attribute",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:T.Class.UNIVERSAL,type:T.Type.SET,constructed:!0,capture:"values"}]},dg={name:"CertBag",tagClass:T.Class.UNIVERSAL,type:T.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:T.Class.UNIVERSAL,type:T.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:T.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:T.Class.UNIVERSAL,type:T.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function Nn(e,t,a,r){for(var n=[],i=0;i<e.length;i++)for(var s=0;s<e[i].safeBags.length;s++){var u=e[i].safeBags[s];if(!(r!==void 0&&u.type!==r)){if(t===null){n.push(u);continue}u.attributes[t]!==void 0&&u.attributes[t].indexOf(a)>=0&&n.push(u)}}return n}Ln.pkcs12FromAsn1=function(e,t,a){typeof t=="string"?(a=t,t=!0):t===void 0&&(t=!0);var r={},n=[];if(!T.validate(e,lg,r,n)){var i=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw i.errors=i,i}var s={version:r.version.charCodeAt(0),safeContents:[],getBags:function(S){var b={},A;return"localKeyId"in S?A=S.localKeyId:"localKeyIdHex"in S&&(A=Le.util.hexToBytes(S.localKeyIdHex)),A===void 0&&!("friendlyName"in S)&&"bagType"in S&&(b[S.bagType]=Nn(s.safeContents,null,null,S.bagType)),A!==void 0&&(b.localKeyId=Nn(s.safeContents,"localKeyId",A,S.bagType)),"friendlyName"in S&&(b.friendlyName=Nn(s.safeContents,"friendlyName",S.friendlyName,S.bagType)),b},getBagsByFriendlyName:function(S,b){return Nn(s.safeContents,"friendlyName",S,b)},getBagsByLocalKeyId:function(S,b){return Nn(s.safeContents,"localKeyId",S,b)}};if(r.version.charCodeAt(0)!==3){var i=new Error("PKCS#12 PFX of version other than 3 not supported.");throw i.version=r.version.charCodeAt(0),i}if(T.derToOid(r.contentType)!==fe.oids.data){var i=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw i.oid=T.derToOid(r.contentType),i}var u=r.content.value[0];if(u.tagClass!==T.Class.UNIVERSAL||u.type!==T.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(u=Ro(u),r.mac){var c=null,f=0,d=T.derToOid(r.macAlgorithm);switch(d){case fe.oids.sha1:c=Le.md.sha1.create(),f=20;break;case fe.oids.sha256:c=Le.md.sha256.create(),f=32;break;case fe.oids.sha384:c=Le.md.sha384.create(),f=48;break;case fe.oids.sha512:c=Le.md.sha512.create(),f=64;break;case fe.oids.md5:c=Le.md.md5.create(),f=16;break}if(c===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+d);var h=new Le.util.ByteBuffer(r.macSalt),C="macIterations"in r?parseInt(Le.util.bytesToHex(r.macIterations),16):1,E=Ln.generateKey(a,h,3,C,f,c),g=Le.hmac.create();g.start(c,E),g.update(u.value);var _=g.getMac();if(_.getBytes()!==r.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return hg(s,u.value,t,a),s};function Ro(e){if(e.composed||e.constructed){for(var t=Le.util.createBuffer(),a=0;a<e.value.length;++a)t.putBytes(e.value[a].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function hg(e,t,a,r){if(t=T.fromDer(t,a),t.tagClass!==T.Class.UNIVERSAL||t.type!==T.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var n=0;n<t.value.length;n++){var i=t.value[n],s={},u=[];if(!T.validate(i,Ac,s,u)){var c=new Error("Cannot read ContentInfo.");throw c.errors=u,c}var f={encrypted:!1},d=null,h=s.content.value[0];switch(T.derToOid(s.contentType)){case fe.oids.data:if(h.tagClass!==T.Class.UNIVERSAL||h.type!==T.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");d=Ro(h).value;break;case fe.oids.encryptedData:d=pg(h,r),f.encrypted=!0;break;default:var c=new Error("Unsupported PKCS#12 contentType.");throw c.contentType=T.derToOid(s.contentType),c}f.safeBags=yg(d,a,r),e.safeContents.push(f)}}function pg(e,t){var a={},r=[];if(!T.validate(e,Le.pkcs7.asn1.encryptedDataValidator,a,r)){var n=new Error("Cannot read EncryptedContentInfo.");throw n.errors=r,n}var i=T.derToOid(a.contentType);if(i!==fe.oids.data){var n=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw n.oid=i,n}i=T.derToOid(a.encAlgorithm);var s=fe.pbe.getCipher(i,a.encParameter,t),u=Ro(a.encryptedContentAsn1),c=Le.util.createBuffer(u.value);if(s.update(c),!s.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return s.output.getBytes()}function yg(e,t,a){if(!t&&e.length===0)return[];if(e=T.fromDer(e,t),e.tagClass!==T.Class.UNIVERSAL||e.type!==T.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var r=[],n=0;n<e.value.length;n++){var i=e.value[n],s={},u=[];if(!T.validate(i,fg,s,u)){var c=new Error("Cannot read SafeBag.");throw c.errors=u,c}var f={type:T.derToOid(s.bagId),attributes:gg(s.bagAttributes)};r.push(f);var d,h,C=s.bagValue.value[0];switch(f.type){case fe.oids.pkcs8ShroudedKeyBag:if(C=fe.decryptPrivateKeyInfo(C,a),C===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case fe.oids.keyBag:try{f.key=fe.privateKeyFromAsn1(C)}catch{f.key=null,f.asn1=C}continue;case fe.oids.certBag:d=dg,h=function(){if(T.derToOid(s.certId)!==fe.oids.x509Certificate){var g=new Error("Unsupported certificate type, only X.509 supported.");throw g.oid=T.derToOid(s.certId),g}var _=T.fromDer(s.cert,t);try{f.cert=fe.certificateFromAsn1(_,!0)}catch{f.cert=null,f.asn1=_}};break;default:var c=new Error("Unsupported PKCS#12 SafeBag type.");throw c.oid=f.type,c}if(d!==void 0&&!T.validate(C,d,s,u)){var c=new Error("Cannot read PKCS#12 "+d.name);throw c.errors=u,c}h()}return r}function gg(e){var t={};if(e!==void 0)for(var a=0;a<e.length;++a){var r={},n=[];if(!T.validate(e[a],cg,r,n)){var i=new Error("Cannot read PKCS#12 BagAttribute.");throw i.errors=n,i}var s=T.derToOid(r.oid);if(fe.oids[s]!==void 0){t[fe.oids[s]]=[];for(var u=0;u<r.values.length;++u)t[fe.oids[s]].push(r.values[u].value)}}return t}Ln.toPkcs12Asn1=function(e,t,a,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||r.encAlgorithm||"aes128","useMac"in r||(r.useMac=!0),"localKeyId"in r||(r.localKeyId=null),"generateLocalKeyId"in r||(r.generateLocalKeyId=!0);var n=r.localKeyId,i;if(n!==null)n=Le.util.hexToBytes(n);else if(r.generateLocalKeyId)if(t){var s=Le.util.isArray(t)?t[0]:t;typeof s=="string"&&(s=fe.certificateFromPem(s));var u=Le.md.sha1.create();u.update(T.toDer(fe.certificateToAsn1(s)).getBytes()),n=u.digest().getBytes()}else n=Le.random.getBytes(20);var c=[];n!==null&&c.push(T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.localKeyId).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SET,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,n)])])),"friendlyName"in r&&c.push(T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.friendlyName).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SET,!0,[T.create(T.Class.UNIVERSAL,T.Type.BMPSTRING,!1,r.friendlyName)])])),c.length>0&&(i=T.create(T.Class.UNIVERSAL,T.Type.SET,!0,c));var f=[],d=[];t!==null&&(Le.util.isArray(t)?d=t:d=[t]);for(var h=[],C=0;C<d.length;++C){t=d[C],typeof t=="string"&&(t=fe.certificateFromPem(t));var E=C===0?i:void 0,g=fe.certificateToAsn1(t),_=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.certBag).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.x509Certificate).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,T.toDer(g).getBytes())])])]),E]);h.push(_)}if(h.length>0){var S=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,h),b=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.data).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,T.toDer(S).getBytes())])]);f.push(b)}var A=null;if(e!==null){var w=fe.wrapRsaPrivateKey(fe.privateKeyToAsn1(e));a===null?A=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.keyBag).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[w]),i]):A=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.pkcs8ShroudedKeyBag).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[fe.encryptPrivateKeyInfo(w,a,r)]),i]);var D=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[A]),k=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.data).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,T.toDer(D).getBytes())])]);f.push(k)}var R=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,f),G;if(r.useMac){var u=Le.md.sha1.create(),q=new Le.util.ByteBuffer(Le.random.getBytes(r.saltSize)),Y=r.count,e=Ln.generateKey(a,q,3,Y,20),H=Le.hmac.create();H.start(u,e),H.update(T.toDer(R).getBytes());var ae=H.getMac();G=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.sha1).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,"")]),T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,ae.getBytes())]),T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,q.getBytes()),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(Y).getBytes())])}return T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(3).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(fe.oids.data).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,T.toDer(R).getBytes())])]),G])};Ln.generateKey=Le.pbe.generatePkcs12Key});var Do=ne((y1,Ic)=>{var Kr=ue();Qt();Fr();_o();na();Wi();No();Zi();Rn();me();ts();var Lo=Kr.asn1,Va=Ic.exports=Kr.pki=Kr.pki||{};Va.pemToDer=function(e){var t=Kr.pem.decode(e)[0];if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return Kr.util.createBuffer(t.body)};Va.privateKeyFromPem=function(e){var t=Kr.pem.decode(e)[0];if(t.type!=="PRIVATE KEY"&&t.type!=="RSA PRIVATE KEY"){var a=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var r=Lo.fromDer(t.body);return Va.privateKeyFromAsn1(r)};Va.privateKeyToPem=function(e,t){var a={type:"RSA PRIVATE KEY",body:Lo.toDer(Va.privateKeyToAsn1(e)).getBytes()};return Kr.pem.encode(a,{maxline:t})};Va.privateKeyInfoToPem=function(e,t){var a={type:"PRIVATE KEY",body:Lo.toDer(e).getBytes()};return Kr.pem.encode(a,{maxline:t})}});var Vo=ne((g1,Pc)=>{var V=ue();Qt();Na();Mi();na();Do();Pt();Pa();me();var is=function(e,t,a,r){var n=V.util.createBuffer(),i=e.length>>1,s=i+(e.length&1),u=e.substr(0,s),c=e.substr(i,s),f=V.util.createBuffer(),d=V.hmac.create();a=t+a;var h=Math.ceil(r/16),C=Math.ceil(r/20);d.start("MD5",u);var E=V.util.createBuffer();f.putBytes(a);for(var g=0;g<h;++g)d.start(null,null),d.update(f.getBytes()),f.putBuffer(d.digest()),d.start(null,null),d.update(f.bytes()+a),E.putBuffer(d.digest());d.start("SHA1",c);var _=V.util.createBuffer();f.clear(),f.putBytes(a);for(var g=0;g<C;++g)d.start(null,null),d.update(f.getBytes()),f.putBuffer(d.digest()),d.start(null,null),d.update(f.bytes()+a),_.putBuffer(d.digest());return n.putBytes(V.util.xorBytes(E.getBytes(),_.getBytes(),r)),n},mg=function(e,t,a){var r=V.hmac.create();r.start("SHA1",e);var n=V.util.createBuffer();return n.putInt32(t[0]),n.putInt32(t[1]),n.putByte(a.type),n.putByte(a.version.major),n.putByte(a.version.minor),n.putInt16(a.length),n.putBytes(a.fragment.bytes()),r.update(n.getBytes()),r.digest().getBytes()},vg=function(e,t,a){var r=!1;try{var n=e.deflate(t.fragment.getBytes());t.fragment=V.util.createBuffer(n),t.length=n.length,r=!0}catch{}return r},Cg=function(e,t,a){var r=!1;try{var n=e.inflate(t.fragment.getBytes());t.fragment=V.util.createBuffer(n),t.length=n.length,r=!0}catch{}return r},Bt=function(e,t){var a=0;switch(t){case 1:a=e.getByte();break;case 2:a=e.getInt16();break;case 3:a=e.getInt24();break;case 4:a=e.getInt32();break}return V.util.createBuffer(e.getBytes(a))},Vt=function(e,t,a){e.putInt(a.length(),t<<3),e.putBuffer(a)},v={};v.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};v.SupportedVersions=[v.Versions.TLS_1_1,v.Versions.TLS_1_0];v.Version=v.SupportedVersions[0];v.MaxFragment=16384-1024;v.ConnectionEnd={server:0,client:1};v.PRFAlgorithm={tls_prf_sha256:0};v.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};v.CipherType={stream:0,block:1,aead:2};v.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};v.CompressionMethod={none:0,deflate:1};v.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};v.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};v.Alert={};v.Alert.Level={warning:1,fatal:2};v.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};v.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};v.CipherSuites={};v.getCipherSuite=function(e){var t=null;for(var a in v.CipherSuites){var r=v.CipherSuites[a];if(r.id[0]===e.charCodeAt(0)&&r.id[1]===e.charCodeAt(1)){t=r;break}}return t};v.handleUnexpected=function(e,t){var a=!e.open&&e.entity===v.ConnectionEnd.client;a||e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.unexpected_message}})};v.handleHelloRequest=function(e,t,a){!e.handshaking&&e.handshakes>0&&(v.queue(e,v.createAlert(e,{level:v.Alert.Level.warning,description:v.Alert.Description.no_renegotiation})),v.flush(e)),e.process()};v.parseHelloMessage=function(e,t,a){var r=null,n=e.entity===v.ConnectionEnd.client;if(a<38)e.error(e,{message:n?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.illegal_parameter}});else{var i=t.fragment,s=i.length();if(r={version:{major:i.getByte(),minor:i.getByte()},random:V.util.createBuffer(i.getBytes(32)),session_id:Bt(i,1),extensions:[]},n?(r.cipher_suite=i.getBytes(2),r.compression_method=i.getByte()):(r.cipher_suites=Bt(i,2),r.compression_methods=Bt(i,1)),s=a-(s-i.length()),s>0){for(var u=Bt(i,2);u.length()>0;)r.extensions.push({type:[u.getByte(),u.getByte()],data:Bt(u,2)});if(!n)for(var c=0;c<r.extensions.length;++c){var f=r.extensions[c];if(f.type[0]===0&&f.type[1]===0)for(var d=Bt(f.data,2);d.length()>0;){var h=d.getByte();if(h!==0)break;e.session.extensions.server_name.serverNameList.push(Bt(d,2).getBytes())}}}if(e.session.version&&(r.version.major!==e.session.version.major||r.version.minor!==e.session.version.minor))return e.error(e,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.protocol_version}});if(n)e.session.cipherSuite=v.getCipherSuite(r.cipher_suite);else for(var C=V.util.createBuffer(r.cipher_suites.bytes());C.length()>0&&(e.session.cipherSuite=v.getCipherSuite(C.getBytes(2)),e.session.cipherSuite===null););if(e.session.cipherSuite===null)return e.error(e,{message:"No cipher suites in common.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.handshake_failure},cipherSuite:V.util.bytesToHex(r.cipher_suite)});n?e.session.compressionMethod=r.compression_method:e.session.compressionMethod=v.CompressionMethod.none}return r};v.createSecurityParameters=function(e,t){var a=e.entity===v.ConnectionEnd.client,r=t.random.bytes(),n=a?e.session.sp.client_random:r,i=a?r:v.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:v.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:n,server_random:i}};v.handleServerHello=function(e,t,a){var r=v.parseHelloMessage(e,t,a);if(!e.fail){if(r.version.minor<=e.version.minor)e.version.minor=r.version.minor;else return e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.protocol_version}});e.session.version=e.version;var n=r.session_id.bytes();n.length>0&&n===e.session.id?(e.expect=Rc,e.session.resuming=!0,e.session.sp.server_random=r.random.bytes()):(e.expect=Eg,e.session.resuming=!1,v.createSecurityParameters(e,r)),e.session.id=n,e.process()}};v.handleClientHello=function(e,t,a){var r=v.parseHelloMessage(e,t,a);if(!e.fail){var n=r.session_id.bytes(),i=null;if(e.sessionCache&&(i=e.sessionCache.getSession(n),i===null?n="":(i.version.major!==r.version.major||i.version.minor>r.version.minor)&&(i=null,n="")),n.length===0&&(n=V.random.getBytes(32)),e.session.id=n,e.session.clientHelloVersion=r.version,e.session.sp={},i)e.version=e.session.version=i.version,e.session.sp=i.sp;else{for(var s,u=1;u<v.SupportedVersions.length&&(s=v.SupportedVersions[u],!(s.minor<=r.version.minor));++u);e.version={major:s.major,minor:s.minor},e.session.version=e.version}i!==null?(e.expect=Oo,e.session.resuming=!0,e.session.sp.client_random=r.random.bytes()):(e.expect=e.verifyClient!==!1?Bg:Uo,e.session.resuming=!1,v.createSecurityParameters(e,r)),e.open=!0,v.queue(e,v.createRecord(e,{type:v.ContentType.handshake,data:v.createServerHello(e)})),e.session.resuming?(v.queue(e,v.createRecord(e,{type:v.ContentType.change_cipher_spec,data:v.createChangeCipherSpec()})),e.state.pending=v.createConnectionState(e),e.state.current.write=e.state.pending.write,v.queue(e,v.createRecord(e,{type:v.ContentType.handshake,data:v.createFinished(e)}))):(v.queue(e,v.createRecord(e,{type:v.ContentType.handshake,data:v.createCertificate(e)})),e.fail||(v.queue(e,v.createRecord(e,{type:v.ContentType.handshake,data:v.createServerKeyExchange(e)})),e.verifyClient!==!1&&v.queue(e,v.createRecord(e,{type:v.ContentType.handshake,data:v.createCertificateRequest(e)})),v.queue(e,v.createRecord(e,{type:v.ContentType.handshake,data:v.createServerHelloDone(e)})))),v.flush(e),e.process()}};v.handleCertificate=function(e,t,a){if(a<3)return e.error(e,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.illegal_parameter}});var r=t.fragment,n={certificate_list:Bt(r,3)},i,s,u=[];try{for(;n.certificate_list.length()>0;)i=Bt(n.certificate_list,3),s=V.asn1.fromDer(i),i=V.pki.certificateFromAsn1(s,!0),u.push(i)}catch(f){return e.error(e,{message:"Could not parse certificate list.",cause:f,send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.bad_certificate}})}var c=e.entity===v.ConnectionEnd.client;(c||e.verifyClient===!0)&&u.length===0?e.error(e,{message:c?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.illegal_parameter}}):u.length===0?e.expect=c?Bc:Uo:(c?e.session.serverCertificate=u[0]:e.session.clientCertificate=u[0],v.verifyCertificateChain(e,u)&&(e.expect=c?Bc:Uo)),e.process()};v.handleServerKeyExchange=function(e,t,a){if(a>0)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.unsupported_certificate}});e.expect=bg,e.process()};v.handleClientKeyExchange=function(e,t,a){if(a<48)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.unsupported_certificate}});var r=t.fragment,n={enc_pre_master_secret:Bt(r,2).getBytes()},i=null;if(e.getPrivateKey)try{i=e.getPrivateKey(e,e.session.serverCertificate),i=V.pki.privateKeyFromPem(i)}catch(c){e.error(e,{message:"Could not get private key.",cause:c,send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.internal_error}})}if(i===null)return e.error(e,{message:"No private key set.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.internal_error}});try{var s=e.session.sp;s.pre_master_secret=i.decrypt(n.enc_pre_master_secret);var u=e.session.clientHelloVersion;if(u.major!==s.pre_master_secret.charCodeAt(0)||u.minor!==s.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{s.pre_master_secret=V.random.getBytes(48)}e.expect=Oo,e.session.clientCertificate!==null&&(e.expect=wg),e.process()};v.handleCertificateRequest=function(e,t,a){if(a<3)return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.illegal_parameter}});var r=t.fragment,n={certificate_types:Bt(r,1),certificate_authorities:Bt(r,2)};e.session.certificateRequest=n,e.expect=xg,e.process()};v.handleCertificateVerify=function(e,t,a){if(a<2)return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.illegal_parameter}});var r=t.fragment;r.read-=4;var n=r.bytes();r.read+=4;var i={signature:Bt(r,2).getBytes()},s=V.util.createBuffer();s.putBuffer(e.session.md5.digest()),s.putBuffer(e.session.sha1.digest()),s=s.getBytes();try{var u=e.session.clientCertificate;if(!u.publicKey.verify(s,i.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");e.session.md5.update(n),e.session.sha1.update(n)}catch{return e.error(e,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.handshake_failure}})}e.expect=Oo,e.process()};v.handleServerHelloDone=function(e,t,a){if(a>0)return e.error(e,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.record_overflow}});if(e.serverCertificate===null){var r={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.insufficient_security}},n=0,i=e.verify(e,r.alert.description,n,[]);if(i!==!0)return(i||i===0)&&(typeof i=="object"&&!V.util.isArray(i)?(i.message&&(r.message=i.message),i.alert&&(r.alert.description=i.alert)):typeof i=="number"&&(r.alert.description=i)),e.error(e,r)}e.session.certificateRequest!==null&&(t=v.createRecord(e,{type:v.ContentType.handshake,data:v.createCertificate(e)}),v.queue(e,t)),t=v.createRecord(e,{type:v.ContentType.handshake,data:v.createClientKeyExchange(e)}),v.queue(e,t),e.expect=_g;var s=function(u,c){u.session.certificateRequest!==null&&u.session.clientCertificate!==null&&v.queue(u,v.createRecord(u,{type:v.ContentType.handshake,data:v.createCertificateVerify(u,c)})),v.queue(u,v.createRecord(u,{type:v.ContentType.change_cipher_spec,data:v.createChangeCipherSpec()})),u.state.pending=v.createConnectionState(u),u.state.current.write=u.state.pending.write,v.queue(u,v.createRecord(u,{type:v.ContentType.handshake,data:v.createFinished(u)})),u.expect=Rc,v.flush(u),u.process()};if(e.session.certificateRequest===null||e.session.clientCertificate===null)return s(e,null);v.getClientSignature(e,s)};v.handleChangeCipherSpec=function(e,t){if(t.fragment.getByte()!==1)return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.illegal_parameter}});var a=e.entity===v.ConnectionEnd.client;(e.session.resuming&&a||!e.session.resuming&&!a)&&(e.state.pending=v.createConnectionState(e)),e.state.current.read=e.state.pending.read,(!e.session.resuming&&a||e.session.resuming&&!a)&&(e.state.pending=null),e.expect=a?Tg:Rg,e.process()};v.handleFinished=function(e,t,a){var r=t.fragment;r.read-=4;var n=r.bytes();r.read+=4;var i=t.fragment.getBytes();r=V.util.createBuffer(),r.putBuffer(e.session.md5.digest()),r.putBuffer(e.session.sha1.digest());var s=e.entity===v.ConnectionEnd.client,u=s?"server finished":"client finished",c=e.session.sp,f=12,d=is;if(r=d(c.master_secret,u,r.getBytes(),f),r.getBytes()!==i)return e.error(e,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.decrypt_error}});e.session.md5.update(n),e.session.sha1.update(n),(e.session.resuming&&s||!e.session.resuming&&!s)&&(v.queue(e,v.createRecord(e,{type:v.ContentType.change_cipher_spec,data:v.createChangeCipherSpec()})),e.state.current.write=e.state.pending.write,e.state.pending=null,v.queue(e,v.createRecord(e,{type:v.ContentType.handshake,data:v.createFinished(e)}))),e.expect=s?Ag:Ng,e.handshaking=!1,++e.handshakes,e.peerCertificate=s?e.session.serverCertificate:e.session.clientCertificate,v.flush(e),e.isConnected=!0,e.connected(e),e.process()};v.handleAlert=function(e,t){var a=t.fragment,r={level:a.getByte(),description:a.getByte()},n;switch(r.description){case v.Alert.Description.close_notify:n="Connection closed.";break;case v.Alert.Description.unexpected_message:n="Unexpected message.";break;case v.Alert.Description.bad_record_mac:n="Bad record MAC.";break;case v.Alert.Description.decryption_failed:n="Decryption failed.";break;case v.Alert.Description.record_overflow:n="Record overflow.";break;case v.Alert.Description.decompression_failure:n="Decompression failed.";break;case v.Alert.Description.handshake_failure:n="Handshake failure.";break;case v.Alert.Description.bad_certificate:n="Bad certificate.";break;case v.Alert.Description.unsupported_certificate:n="Unsupported certificate.";break;case v.Alert.Description.certificate_revoked:n="Certificate revoked.";break;case v.Alert.Description.certificate_expired:n="Certificate expired.";break;case v.Alert.Description.certificate_unknown:n="Certificate unknown.";break;case v.Alert.Description.illegal_parameter:n="Illegal parameter.";break;case v.Alert.Description.unknown_ca:n="Unknown certificate authority.";break;case v.Alert.Description.access_denied:n="Access denied.";break;case v.Alert.Description.decode_error:n="Decode error.";break;case v.Alert.Description.decrypt_error:n="Decrypt error.";break;case v.Alert.Description.export_restriction:n="Export restriction.";break;case v.Alert.Description.protocol_version:n="Unsupported protocol version.";break;case v.Alert.Description.insufficient_security:n="Insufficient security.";break;case v.Alert.Description.internal_error:n="Internal error.";break;case v.Alert.Description.user_canceled:n="User canceled.";break;case v.Alert.Description.no_renegotiation:n="Renegotiation not supported.";break;default:n="Unknown error.";break}if(r.description===v.Alert.Description.close_notify)return e.close();e.error(e,{message:n,send:!1,origin:e.entity===v.ConnectionEnd.client?"server":"client",alert:r}),e.process()};v.handleHandshake=function(e,t){var a=t.fragment,r=a.getByte(),n=a.getInt24();if(n>a.length())return e.fragmented=t,t.fragment=V.util.createBuffer(),a.read-=4,e.process();e.fragmented=null,a.read-=4;var i=a.bytes(n+4);a.read+=4,r in ns[e.entity][e.expect]?(e.entity===v.ConnectionEnd.server&&!e.open&&!e.fail&&(e.handshaking=!0,e.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:V.md.md5.create(),sha1:V.md.sha1.create()}),r!==v.HandshakeType.hello_request&&r!==v.HandshakeType.certificate_verify&&r!==v.HandshakeType.finished&&(e.session.md5.update(i),e.session.sha1.update(i)),ns[e.entity][e.expect][r](e,t,n)):v.handleUnexpected(e,t)};v.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment),e.dataReady(e),e.process()};v.handleHeartbeat=function(e,t){var a=t.fragment,r=a.getByte(),n=a.getInt16(),i=a.getBytes(n);if(r===v.HeartbeatMessageType.heartbeat_request){if(e.handshaking||n>i.length)return e.process();v.queue(e,v.createRecord(e,{type:v.ContentType.heartbeat,data:v.createHeartbeat(v.HeartbeatMessageType.heartbeat_response,i)})),v.flush(e)}else if(r===v.HeartbeatMessageType.heartbeat_response){if(i!==e.expectedHeartbeatPayload)return e.process();e.heartbeatReceived&&e.heartbeatReceived(e,V.util.createBuffer(i))}e.process()};var Sg=0,Eg=1,Bc=2,bg=3,xg=4,Rc=5,Tg=6,Ag=7,_g=8,Ig=0,Bg=1,Uo=2,wg=3,Oo=4,Rg=5,Ng=6,m=v.handleUnexpected,Nc=v.handleChangeCipherSpec,ot=v.handleAlert,gt=v.handleHandshake,Lc=v.handleApplicationData,ut=v.handleHeartbeat,Fo=[];Fo[v.ConnectionEnd.client]=[[m,ot,gt,m,ut],[m,ot,gt,m,ut],[m,ot,gt,m,ut],[m,ot,gt,m,ut],[m,ot,gt,m,ut],[Nc,ot,m,m,ut],[m,ot,gt,m,ut],[m,ot,gt,Lc,ut],[m,ot,gt,m,ut]];Fo[v.ConnectionEnd.server]=[[m,ot,gt,m,ut],[m,ot,gt,m,ut],[m,ot,gt,m,ut],[m,ot,gt,m,ut],[Nc,ot,m,m,ut],[m,ot,gt,m,ut],[m,ot,gt,Lc,ut],[m,ot,gt,m,ut]];var Hr=v.handleHelloRequest,Lg=v.handleServerHello,Dc=v.handleCertificate,wc=v.handleServerKeyExchange,ko=v.handleCertificateRequest,rs=v.handleServerHelloDone,kc=v.handleFinished,ns=[];ns[v.ConnectionEnd.client]=[[m,m,Lg,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m],[Hr,m,m,m,m,m,m,m,m,m,m,Dc,wc,ko,rs,m,m,m,m,m,m],[Hr,m,m,m,m,m,m,m,m,m,m,m,wc,ko,rs,m,m,m,m,m,m],[Hr,m,m,m,m,m,m,m,m,m,m,m,m,ko,rs,m,m,m,m,m,m],[Hr,m,m,m,m,m,m,m,m,m,m,m,m,m,rs,m,m,m,m,m,m],[Hr,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m],[Hr,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,kc],[Hr,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m],[Hr,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m]];var Dg=v.handleClientHello,kg=v.handleClientKeyExchange,Pg=v.handleCertificateVerify;ns[v.ConnectionEnd.server]=[[m,Dg,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,m,m,m,Dc,m,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,kg,m,m,m,m],[m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,Pg,m,m,m,m,m],[m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,kc],[m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m],[m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m]];v.generateKeys=function(e,t){var a=is,r=t.client_random+t.server_random;e.session.resuming||(t.master_secret=a(t.pre_master_secret,"master secret",r,48).bytes(),t.pre_master_secret=null),r=t.server_random+t.client_random;var n=2*t.mac_key_length+2*t.enc_key_length,i=e.version.major===v.Versions.TLS_1_0.major&&e.version.minor===v.Versions.TLS_1_0.minor;i&&(n+=2*t.fixed_iv_length);var s=a(t.master_secret,"key expansion",r,n),u={client_write_MAC_key:s.getBytes(t.mac_key_length),server_write_MAC_key:s.getBytes(t.mac_key_length),client_write_key:s.getBytes(t.enc_key_length),server_write_key:s.getBytes(t.enc_key_length)};return i&&(u.client_write_IV=s.getBytes(t.fixed_iv_length),u.server_write_IV=s.getBytes(t.fixed_iv_length)),u};v.createConnectionState=function(e){var t=e.entity===v.ConnectionEnd.client,a=function(){var i={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(s){return!0},compressionState:null,compressFunction:function(s){return!0},updateSequenceNumber:function(){i.sequenceNumber[1]===4294967295?(i.sequenceNumber[1]=0,++i.sequenceNumber[0]):++i.sequenceNumber[1]}};return i},r={read:a(),write:a()};if(r.read.update=function(i,s){return r.read.cipherFunction(s,r.read)?r.read.compressFunction(i,s,r.read)||i.error(i,{message:"Could not decompress record.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.decompression_failure}}):i.error(i,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.bad_record_mac}}),!i.fail},r.write.update=function(i,s){return r.write.compressFunction(i,s,r.write)?r.write.cipherFunction(s,r.write)||i.error(i,{message:"Could not encrypt record.",send:!1,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.internal_error}}):i.error(i,{message:"Could not compress record.",send:!1,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.internal_error}}),!i.fail},e.session){var n=e.session.sp;switch(e.session.cipherSuite.initSecurityParameters(n),n.keys=v.generateKeys(e,n),r.read.macKey=t?n.keys.server_write_MAC_key:n.keys.client_write_MAC_key,r.write.macKey=t?n.keys.client_write_MAC_key:n.keys.server_write_MAC_key,e.session.cipherSuite.initConnectionState(r,e,n),n.compression_algorithm){case v.CompressionMethod.none:break;case v.CompressionMethod.deflate:r.read.compressFunction=Cg,r.write.compressFunction=vg;break;default:throw new Error("Unsupported compression algorithm.")}}return r};v.createRandom=function(){var e=new Date,t=+e+e.getTimezoneOffset()*6e4,a=V.util.createBuffer();return a.putInt32(t),a.putBytes(V.random.getBytes(28)),a};v.createRecord=function(e,t){if(!t.data)return null;var a={type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data};return a};v.createAlert=function(e,t){var a=V.util.createBuffer();return a.putByte(t.level),a.putByte(t.description),v.createRecord(e,{type:v.ContentType.alert,data:a})};v.createClientHello=function(e){e.session.clientHelloVersion={major:e.version.major,minor:e.version.minor};for(var t=V.util.createBuffer(),a=0;a<e.cipherSuites.length;++a){var r=e.cipherSuites[a];t.putByte(r.id[0]),t.putByte(r.id[1])}var n=t.length(),i=V.util.createBuffer();i.putByte(v.CompressionMethod.none);var s=i.length(),u=V.util.createBuffer();if(e.virtualHost){var c=V.util.createBuffer();c.putByte(0),c.putByte(0);var f=V.util.createBuffer();f.putByte(0),Vt(f,2,V.util.createBuffer(e.virtualHost));var d=V.util.createBuffer();Vt(d,2,f),Vt(c,2,d),u.putBuffer(c)}var h=u.length();h>0&&(h+=2);var C=e.session.id,E=C.length+1+2+4+28+2+n+1+s+h,g=V.util.createBuffer();return g.putByte(v.HandshakeType.client_hello),g.putInt24(E),g.putByte(e.version.major),g.putByte(e.version.minor),g.putBytes(e.session.sp.client_random),Vt(g,1,V.util.createBuffer(C)),Vt(g,2,t),Vt(g,1,i),h>0&&Vt(g,2,u),g};v.createServerHello=function(e){var t=e.session.id,a=t.length+1+2+4+28+2+1,r=V.util.createBuffer();return r.putByte(v.HandshakeType.server_hello),r.putInt24(a),r.putByte(e.version.major),r.putByte(e.version.minor),r.putBytes(e.session.sp.server_random),Vt(r,1,V.util.createBuffer(t)),r.putByte(e.session.cipherSuite.id[0]),r.putByte(e.session.cipherSuite.id[1]),r.putByte(e.session.compressionMethod),r};v.createCertificate=function(e){var t=e.entity===v.ConnectionEnd.client,a=null;if(e.getCertificate){var r;t?r=e.session.certificateRequest:r=e.session.extensions.server_name.serverNameList,a=e.getCertificate(e,r)}var n=V.util.createBuffer();if(a!==null)try{V.util.isArray(a)||(a=[a]);for(var i=null,s=0;s<a.length;++s){var u=V.pem.decode(a[s])[0];if(u.type!=="CERTIFICATE"&&u.type!=="X509 CERTIFICATE"&&u.type!=="TRUSTED CERTIFICATE"){var c=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw c.headerType=u.type,c}if(u.procType&&u.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var f=V.util.createBuffer(u.body);i===null&&(i=V.asn1.fromDer(f.bytes(),!1));var d=V.util.createBuffer();Vt(d,3,f),n.putBuffer(d)}a=V.pki.certificateFromAsn1(i),t?e.session.clientCertificate=a:e.session.serverCertificate=a}catch(E){return e.error(e,{message:"Could not send certificate list.",cause:E,send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.bad_certificate}})}var h=3+n.length(),C=V.util.createBuffer();return C.putByte(v.HandshakeType.certificate),C.putInt24(h),Vt(C,3,n),C};v.createClientKeyExchange=function(e){var t=V.util.createBuffer();t.putByte(e.session.clientHelloVersion.major),t.putByte(e.session.clientHelloVersion.minor),t.putBytes(V.random.getBytes(46));var a=e.session.sp;a.pre_master_secret=t.getBytes();var r=e.session.serverCertificate.publicKey;t=r.encrypt(a.pre_master_secret);var n=t.length+2,i=V.util.createBuffer();return i.putByte(v.HandshakeType.client_key_exchange),i.putInt24(n),i.putInt16(t.length),i.putBytes(t),i};v.createServerKeyExchange=function(e){var t=0,a=V.util.createBuffer();return t>0&&(a.putByte(v.HandshakeType.server_key_exchange),a.putInt24(t)),a};v.getClientSignature=function(e,t){var a=V.util.createBuffer();a.putBuffer(e.session.md5.digest()),a.putBuffer(e.session.sha1.digest()),a=a.getBytes(),e.getSignature=e.getSignature||function(r,n,i){var s=null;if(r.getPrivateKey)try{s=r.getPrivateKey(r,r.session.clientCertificate),s=V.pki.privateKeyFromPem(s)}catch(u){r.error(r,{message:"Could not get private key.",cause:u,send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.internal_error}})}s===null?r.error(r,{message:"No private key set.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.internal_error}}):n=s.sign(n,null),i(r,n)},e.getSignature(e,a,t)};v.createCertificateVerify=function(e,t){var a=t.length+2,r=V.util.createBuffer();return r.putByte(v.HandshakeType.certificate_verify),r.putInt24(a),r.putInt16(t.length),r.putBytes(t),r};v.createCertificateRequest=function(e){var t=V.util.createBuffer();t.putByte(1);var a=V.util.createBuffer();for(var r in e.caStore.certs){var n=e.caStore.certs[r],i=V.pki.distinguishedNameToAsn1(n.subject),s=V.asn1.toDer(i);a.putInt16(s.length()),a.putBuffer(s)}var u=1+t.length()+2+a.length(),c=V.util.createBuffer();return c.putByte(v.HandshakeType.certificate_request),c.putInt24(u),Vt(c,1,t),Vt(c,2,a),c};v.createServerHelloDone=function(e){var t=V.util.createBuffer();return t.putByte(v.HandshakeType.server_hello_done),t.putInt24(0),t};v.createChangeCipherSpec=function(){var e=V.util.createBuffer();return e.putByte(1),e};v.createFinished=function(e){var t=V.util.createBuffer();t.putBuffer(e.session.md5.digest()),t.putBuffer(e.session.sha1.digest());var a=e.entity===v.ConnectionEnd.client,r=e.session.sp,n=12,i=is,s=a?"client finished":"server finished";t=i(r.master_secret,s,t.getBytes(),n);var u=V.util.createBuffer();return u.putByte(v.HandshakeType.finished),u.putInt24(t.length()),u.putBuffer(t),u};v.createHeartbeat=function(e,t,a){typeof a>"u"&&(a=t.length);var r=V.util.createBuffer();r.putByte(e),r.putInt16(a),r.putBytes(t);var n=r.length(),i=Math.max(16,n-a-3);return r.putBytes(V.random.getBytes(i)),r};v.queue=function(e,t){if(!!t&&!(t.fragment.length()===0&&(t.type===v.ContentType.handshake||t.type===v.ContentType.alert||t.type===v.ContentType.change_cipher_spec))){if(t.type===v.ContentType.handshake){var a=t.fragment.bytes();e.session.md5.update(a),e.session.sha1.update(a),a=null}var r;if(t.fragment.length()<=v.MaxFragment)r=[t];else{r=[];for(var n=t.fragment.bytes();n.length>v.MaxFragment;)r.push(v.createRecord(e,{type:t.type,data:V.util.createBuffer(n.slice(0,v.MaxFragment))})),n=n.slice(v.MaxFragment);n.length>0&&r.push(v.createRecord(e,{type:t.type,data:V.util.createBuffer(n)}))}for(var i=0;i<r.length&&!e.fail;++i){var s=r[i],u=e.state.current.write;u.update(e,s)&&e.records.push(s)}}};v.flush=function(e){for(var t=0;t<e.records.length;++t){var a=e.records[t];e.tlsData.putByte(a.type),e.tlsData.putByte(a.version.major),e.tlsData.putByte(a.version.minor),e.tlsData.putInt16(a.fragment.length()),e.tlsData.putBuffer(e.records[t].fragment)}return e.records=[],e.tlsDataReady(e)};var Po=function(e){switch(e){case!0:return!0;case V.pki.certificateError.bad_certificate:return v.Alert.Description.bad_certificate;case V.pki.certificateError.unsupported_certificate:return v.Alert.Description.unsupported_certificate;case V.pki.certificateError.certificate_revoked:return v.Alert.Description.certificate_revoked;case V.pki.certificateError.certificate_expired:return v.Alert.Description.certificate_expired;case V.pki.certificateError.certificate_unknown:return v.Alert.Description.certificate_unknown;case V.pki.certificateError.unknown_ca:return v.Alert.Description.unknown_ca;default:return v.Alert.Description.bad_certificate}},Ug=function(e){switch(e){case!0:return!0;case v.Alert.Description.bad_certificate:return V.pki.certificateError.bad_certificate;case v.Alert.Description.unsupported_certificate:return V.pki.certificateError.unsupported_certificate;case v.Alert.Description.certificate_revoked:return V.pki.certificateError.certificate_revoked;case v.Alert.Description.certificate_expired:return V.pki.certificateError.certificate_expired;case v.Alert.Description.certificate_unknown:return V.pki.certificateError.certificate_unknown;case v.Alert.Description.unknown_ca:return V.pki.certificateError.unknown_ca;default:return V.pki.certificateError.bad_certificate}};v.verifyCertificateChain=function(e,t){try{var a={};for(var r in e.verifyOptions)a[r]=e.verifyOptions[r];a.verify=function(i,s,u){var c=Po(i),f=e.verify(e,i,s,u);if(f!==!0){if(typeof f=="object"&&!V.util.isArray(f)){var d=new Error("The application rejected the certificate.");throw d.send=!0,d.alert={level:v.Alert.Level.fatal,description:v.Alert.Description.bad_certificate},f.message&&(d.message=f.message),f.alert&&(d.alert.description=f.alert),d}f!==i&&(f=Ug(f))}return f},V.pki.verifyCertificateChain(e.caStore,t,a)}catch(i){var n=i;(typeof n!="object"||V.util.isArray(n))&&(n={send:!0,alert:{level:v.Alert.Level.fatal,description:Po(i)}}),"send"in n||(n.send=!0),"alert"in n||(n.alert={level:v.Alert.Level.fatal,description:Po(n.error)}),e.error(e,n)}return!e.fail};v.createSessionCache=function(e,t){var a=null;if(e&&e.getSession&&e.setSession&&e.order)a=e;else{a={},a.cache=e||{},a.capacity=Math.max(t||100,1),a.order=[];for(var r in e)a.order.length<=t?a.order.push(r):delete e[r];a.getSession=function(n){var i=null,s=null;if(n?s=V.util.bytesToHex(n):a.order.length>0&&(s=a.order[0]),s!==null&&s in a.cache){i=a.cache[s],delete a.cache[s];for(var u in a.order)if(a.order[u]===s){a.order.splice(u,1);break}}return i},a.setSession=function(n,i){if(a.order.length===a.capacity){var s=a.order.shift();delete a.cache[s]}var s=V.util.bytesToHex(n);a.order.push(s),a.cache[s]=i}}return a};v.createConnection=function(e){var t=null;e.caStore?V.util.isArray(e.caStore)?t=V.pki.createCaStore(e.caStore):t=e.caStore:t=V.pki.createCaStore();var a=e.cipherSuites||null;if(a===null){a=[];for(var r in v.CipherSuites)a.push(v.CipherSuites[r])}var n=e.server?v.ConnectionEnd.server:v.ConnectionEnd.client,i=e.sessionCache?v.createSessionCache(e.sessionCache):null,s={version:{major:v.Version.major,minor:v.Version.minor},entity:n,sessionId:e.sessionId,caStore:t,sessionCache:i,cipherSuites:a,connected:e.connected,virtualHost:e.virtualHost||null,verifyClient:e.verifyClient||!1,verify:e.verify||function(d,h,C,E){return h},verifyOptions:e.verifyOptions||{},getCertificate:e.getCertificate||null,getPrivateKey:e.getPrivateKey||null,getSignature:e.getSignature||null,input:V.util.createBuffer(),tlsData:V.util.createBuffer(),data:V.util.createBuffer(),tlsDataReady:e.tlsDataReady,dataReady:e.dataReady,heartbeatReceived:e.heartbeatReceived,closed:e.closed,error:function(d,h){h.origin=h.origin||(d.entity===v.ConnectionEnd.client?"client":"server"),h.send&&(v.queue(d,v.createAlert(d,h.alert)),v.flush(d));var C=h.fatal!==!1;C&&(d.fail=!0),e.error(d,h),C&&d.close(!1)},deflate:e.deflate||null,inflate:e.inflate||null};s.reset=function(d){s.version={major:v.Version.major,minor:v.Version.minor},s.record=null,s.session=null,s.peerCertificate=null,s.state={pending:null,current:null},s.expect=s.entity===v.ConnectionEnd.client?Sg:Ig,s.fragmented=null,s.records=[],s.open=!1,s.handshakes=0,s.handshaking=!1,s.isConnected=!1,s.fail=!(d||typeof d>"u"),s.input.clear(),s.tlsData.clear(),s.data.clear(),s.state.current=v.createConnectionState(s)},s.reset();var u=function(d,h){var C=h.type-v.ContentType.change_cipher_spec,E=Fo[d.entity][d.expect];C in E?E[C](d,h):v.handleUnexpected(d,h)},c=function(d){var h=0,C=d.input,E=C.length();if(E<5)h=5-E;else{d.record={type:C.getByte(),version:{major:C.getByte(),minor:C.getByte()},length:C.getInt16(),fragment:V.util.createBuffer(),ready:!1};var g=d.record.version.major===d.version.major;g&&d.session&&d.session.version&&(g=d.record.version.minor===d.version.minor),g||d.error(d,{message:"Incompatible TLS version.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.protocol_version}})}return h},f=function(d){var h=0,C=d.input,E=C.length();if(E<d.record.length)h=d.record.length-E;else{d.record.fragment.putBytes(C.getBytes(d.record.length)),C.compact();var g=d.state.current.read;g.update(d,d.record)&&(d.fragmented!==null&&(d.fragmented.type===d.record.type?(d.fragmented.fragment.putBuffer(d.record.fragment),d.record=d.fragmented):d.error(d,{message:"Invalid fragmented record.",send:!0,alert:{level:v.Alert.Level.fatal,description:v.Alert.Description.unexpected_message}})),d.record.ready=!0)}return h};return s.handshake=function(d){if(s.entity!==v.ConnectionEnd.client)s.error(s,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(s.handshaking)s.error(s,{message:"Handshake already in progress.",fatal:!1});else{s.fail&&!s.open&&s.handshakes===0&&(s.fail=!1),s.handshaking=!0,d=d||"";var h=null;d.length>0&&(s.sessionCache&&(h=s.sessionCache.getSession(d)),h===null&&(d="")),d.length===0&&s.sessionCache&&(h=s.sessionCache.getSession(),h!==null&&(d=h.id)),s.session={id:d,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:V.md.md5.create(),sha1:V.md.sha1.create()},h&&(s.version=h.version,s.session.sp=h.sp),s.session.sp.client_random=v.createRandom().getBytes(),s.open=!0,v.queue(s,v.createRecord(s,{type:v.ContentType.handshake,data:v.createClientHello(s)})),v.flush(s)}},s.process=function(d){var h=0;return d&&s.input.putBytes(d),s.fail||(s.record!==null&&s.record.ready&&s.record.fragment.isEmpty()&&(s.record=null),s.record===null&&(h=c(s)),!s.fail&&s.record!==null&&!s.record.ready&&(h=f(s)),!s.fail&&s.record!==null&&s.record.ready&&u(s,s.record)),h},s.prepare=function(d){return v.queue(s,v.createRecord(s,{type:v.ContentType.application_data,data:V.util.createBuffer(d)})),v.flush(s)},s.prepareHeartbeatRequest=function(d,h){return d instanceof V.util.ByteBuffer&&(d=d.bytes()),typeof h>"u"&&(h=d.length),s.expectedHeartbeatPayload=d,v.queue(s,v.createRecord(s,{type:v.ContentType.heartbeat,data:v.createHeartbeat(v.HeartbeatMessageType.heartbeat_request,d,h)})),v.flush(s)},s.close=function(d){if(!s.fail&&s.sessionCache&&s.session){var h={id:s.session.id,version:s.session.version,sp:s.session.sp};h.sp.keys=null,s.sessionCache.setSession(h.id,h)}s.open&&(s.open=!1,s.input.clear(),(s.isConnected||s.handshaking)&&(s.isConnected=s.handshaking=!1,v.queue(s,v.createAlert(s,{level:v.Alert.Level.warning,description:v.Alert.Description.close_notify})),v.flush(s)),s.closed(s)),s.reset(d)},s};Pc.exports=V.tls=V.tls||{};for(as in v)typeof v[as]!="function"&&(V.tls[as]=v[as]);var as;V.tls.prf_tls1=is;V.tls.hmac_sha1=mg;V.tls.createSessionCache=v.createSessionCache;V.tls.createConnection=v.createConnection});var Fc=ne((m1,Oc)=>{var zr=ue();Or();Vo();var qt=Oc.exports=zr.tls;qt.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=qt.BulkCipherAlgorithm.aes,e.cipher_type=qt.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=qt.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Uc};qt.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=qt.BulkCipherAlgorithm.aes,e.cipher_type=qt.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=qt.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Uc};function Uc(e,t,a){var r=t.entity===zr.tls.ConnectionEnd.client;e.read.cipherState={init:!1,cipher:zr.cipher.createDecipher("AES-CBC",r?a.keys.server_write_key:a.keys.client_write_key),iv:r?a.keys.server_write_IV:a.keys.client_write_IV},e.write.cipherState={init:!1,cipher:zr.cipher.createCipher("AES-CBC",r?a.keys.client_write_key:a.keys.server_write_key),iv:r?a.keys.client_write_IV:a.keys.server_write_IV},e.read.cipherFunction=qg,e.write.cipherFunction=Og,e.read.macLength=e.write.macLength=a.mac_length,e.read.macFunction=e.write.macFunction=qt.hmac_sha1}function Og(e,t){var a=!1,r=t.macFunction(t.macKey,t.sequenceNumber,e);e.fragment.putBytes(r),t.updateSequenceNumber();var n;e.version.minor===qt.Versions.TLS_1_0.minor?n=t.cipherState.init?null:t.cipherState.iv:n=zr.random.getBytesSync(16),t.cipherState.init=!0;var i=t.cipherState.cipher;return i.start({iv:n}),e.version.minor>=qt.Versions.TLS_1_1.minor&&i.output.putBytes(n),i.update(e.fragment),i.finish(Fg)&&(e.fragment=i.output,e.length=e.fragment.length(),a=!0),a}function Fg(e,t,a){if(!a){var r=e-t.length()%e;t.fillWithByte(r-1,r)}return!0}function Vg(e,t,a){var r=!0;if(a){for(var n=t.length(),i=t.last(),s=n-1-i;s<n-1;++s)r=r&&t.at(s)==i;r&&t.truncate(i+1)}return r}function qg(e,t){var a=!1,r;e.version.minor===qt.Versions.TLS_1_0.minor?r=t.cipherState.init?null:t.cipherState.iv:r=e.fragment.getBytes(16),t.cipherState.init=!0;var n=t.cipherState.cipher;n.start({iv:r}),n.update(e.fragment),a=n.finish(Vg);var i=t.macLength,s=zr.random.getBytesSync(i),u=n.output.length();u>=i?(e.fragment=n.output.getBytes(u-i),s=n.output.getBytes(i)):e.fragment=n.output.getBytes(),e.fragment=zr.util.createBuffer(e.fragment),e.length=e.fragment.length();var c=t.macFunction(t.macKey,t.sequenceNumber,e);return t.updateSequenceNumber(),a=Mg(t.macKey,s,c)&&a,a}function Mg(e,t,a){var r=zr.hmac.create();return r.start("SHA1",e),r.update(t),t=r.digest().getBytes(),r.start(null,null),r.update(a),a=r.digest().getBytes(),t===a}});var Ko=ne((v1,Kc)=>{var Pe=ue();Jt();me();var Dn=Kc.exports=Pe.sha512=Pe.sha512||{};Pe.md.sha512=Pe.md.algorithms.sha512=Dn;var qc=Pe.sha384=Pe.sha512.sha384=Pe.sha512.sha384||{};qc.create=function(){return Dn.create("SHA-384")};Pe.md.sha384=Pe.md.algorithms.sha384=qc;Pe.sha512.sha256=Pe.sha512.sha256||{create:function(){return Dn.create("SHA-512/256")}};Pe.md["sha512/256"]=Pe.md.algorithms["sha512/256"]=Pe.sha512.sha256;Pe.sha512.sha224=Pe.sha512.sha224||{create:function(){return Dn.create("SHA-512/224")}};Pe.md["sha512/224"]=Pe.md.algorithms["sha512/224"]=Pe.sha512.sha224;Dn.create=function(e){if(Mc||Kg(),typeof e>"u"&&(e="SHA-512"),!(e in fa))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=fa[e],a=null,r=Pe.util.createBuffer(),n=new Array(80),i=0;i<80;++i)n[i]=new Array(2);var s=64;switch(e){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var u={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return u.start=function(){u.messageLength=0,u.fullMessageLength=u.messageLength128=[];for(var c=u.messageLengthSize/4,f=0;f<c;++f)u.fullMessageLength.push(0);r=Pe.util.createBuffer(),a=new Array(t.length);for(var f=0;f<t.length;++f)a[f]=t[f].slice(0);return u},u.start(),u.update=function(c,f){f==="utf8"&&(c=Pe.util.encodeUtf8(c));var d=c.length;u.messageLength+=d,d=[d/4294967296>>>0,d>>>0];for(var h=u.fullMessageLength.length-1;h>=0;--h)u.fullMessageLength[h]+=d[1],d[1]=d[0]+(u.fullMessageLength[h]/4294967296>>>0),u.fullMessageLength[h]=u.fullMessageLength[h]>>>0,d[0]=d[1]/4294967296>>>0;return r.putBytes(c),Vc(a,n,r),(r.read>2048||r.length()===0)&&r.compact(),u},u.digest=function(){var c=Pe.util.createBuffer();c.putBytes(r.bytes());var f=u.fullMessageLength[u.fullMessageLength.length-1]+u.messageLengthSize,d=f&u.blockLength-1;c.putBytes(qo.substr(0,u.blockLength-d));for(var h,C,E=u.fullMessageLength[0]*8,g=0;g<u.fullMessageLength.length-1;++g)h=u.fullMessageLength[g+1]*8,C=h/4294967296>>>0,E+=C,c.putInt32(E>>>0),E=h>>>0;c.putInt32(E);for(var _=new Array(a.length),g=0;g<a.length;++g)_[g]=a[g].slice(0);Vc(_,n,c);var S=Pe.util.createBuffer(),b;e==="SHA-512"?b=_.length:e==="SHA-384"?b=_.length-2:b=_.length-4;for(var g=0;g<b;++g)S.putInt32(_[g][0]),(g!==b-1||e!=="SHA-512/224")&&S.putInt32(_[g][1]);return S},u};var qo=null,Mc=!1,Mo=null,fa=null;function Kg(){qo=String.fromCharCode(128),qo+=Pe.util.fillString(String.fromCharCode(0),128),Mo=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],fa={},fa["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],fa["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],fa["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],fa["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Mc=!0}function Vc(e,t,a){for(var r,n,i,s,u,c,f,d,h,C,E,g,_,S,b,A,w,D,k,R,G,q,Y,H,ae,K,xe,De,Te,Ue,Z,$t,fr,Ve,Oe,qe=a.length();qe>=128;){for(Te=0;Te<16;++Te)t[Te][0]=a.getInt32()>>>0,t[Te][1]=a.getInt32()>>>0;for(;Te<80;++Te)$t=t[Te-2],Ue=$t[0],Z=$t[1],r=((Ue>>>19|Z<<13)^(Z>>>29|Ue<<3)^Ue>>>6)>>>0,n=((Ue<<13|Z>>>19)^(Z<<3|Ue>>>29)^(Ue<<26|Z>>>6))>>>0,Ve=t[Te-15],Ue=Ve[0],Z=Ve[1],i=((Ue>>>1|Z<<31)^(Ue>>>8|Z<<24)^Ue>>>7)>>>0,s=((Ue<<31|Z>>>1)^(Ue<<24|Z>>>8)^(Ue<<25|Z>>>7))>>>0,fr=t[Te-7],Oe=t[Te-16],Z=n+fr[1]+s+Oe[1],t[Te][0]=r+fr[0]+i+Oe[0]+(Z/4294967296>>>0)>>>0,t[Te][1]=Z>>>0;for(_=e[0][0],S=e[0][1],b=e[1][0],A=e[1][1],w=e[2][0],D=e[2][1],k=e[3][0],R=e[3][1],G=e[4][0],q=e[4][1],Y=e[5][0],H=e[5][1],ae=e[6][0],K=e[6][1],xe=e[7][0],De=e[7][1],Te=0;Te<80;++Te)f=((G>>>14|q<<18)^(G>>>18|q<<14)^(q>>>9|G<<23))>>>0,d=((G<<18|q>>>14)^(G<<14|q>>>18)^(q<<23|G>>>9))>>>0,h=(ae^G&(Y^ae))>>>0,C=(K^q&(H^K))>>>0,u=((_>>>28|S<<4)^(S>>>2|_<<30)^(S>>>7|_<<25))>>>0,c=((_<<4|S>>>28)^(S<<30|_>>>2)^(S<<25|_>>>7))>>>0,E=(_&b|w&(_^b))>>>0,g=(S&A|D&(S^A))>>>0,Z=De+d+C+Mo[Te][1]+t[Te][1],r=xe+f+h+Mo[Te][0]+t[Te][0]+(Z/4294967296>>>0)>>>0,n=Z>>>0,Z=c+g,i=u+E+(Z/4294967296>>>0)>>>0,s=Z>>>0,xe=ae,De=K,ae=Y,K=H,Y=G,H=q,Z=R+n,G=k+r+(Z/4294967296>>>0)>>>0,q=Z>>>0,k=w,R=D,w=b,D=A,b=_,A=S,Z=n+s,_=r+i+(Z/4294967296>>>0)>>>0,S=Z>>>0;Z=e[0][1]+S,e[0][0]=e[0][0]+_+(Z/4294967296>>>0)>>>0,e[0][1]=Z>>>0,Z=e[1][1]+A,e[1][0]=e[1][0]+b+(Z/4294967296>>>0)>>>0,e[1][1]=Z>>>0,Z=e[2][1]+D,e[2][0]=e[2][0]+w+(Z/4294967296>>>0)>>>0,e[2][1]=Z>>>0,Z=e[3][1]+R,e[3][0]=e[3][0]+k+(Z/4294967296>>>0)>>>0,e[3][1]=Z>>>0,Z=e[4][1]+q,e[4][0]=e[4][0]+G+(Z/4294967296>>>0)>>>0,e[4][1]=Z>>>0,Z=e[5][1]+H,e[5][0]=e[5][0]+Y+(Z/4294967296>>>0)>>>0,e[5][1]=Z>>>0,Z=e[6][1]+K,e[6][0]=e[6][0]+ae+(Z/4294967296>>>0)>>>0,e[6][1]=Z>>>0,Z=e[7][1]+De,e[7][0]=e[7][0]+xe+(Z/4294967296>>>0)>>>0,e[7][1]=Z>>>0,qe-=128}}});var Hc=ne(Ho=>{var Hg=ue();Qt();var nt=Hg.asn1;Ho.privateKeyValidator={name:"PrivateKeyInfo",tagClass:nt.Class.UNIVERSAL,type:nt.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:nt.Class.UNIVERSAL,type:nt.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:nt.Class.UNIVERSAL,type:nt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:nt.Class.UNIVERSAL,type:nt.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:nt.Class.UNIVERSAL,type:nt.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};Ho.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:nt.Class.UNIVERSAL,type:nt.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:nt.Class.UNIVERSAL,type:nt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:nt.Class.UNIVERSAL,type:nt.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:nt.Class.UNIVERSAL,type:nt.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var r0=ne((S1,t0)=>{var lt=ue();wn();Pt();Ko();me();var $c=Hc(),zg=$c.publicKeyValidator,Wg=$c.privateKeyValidator;typeof zc>"u"&&(zc=lt.jsbn.BigInteger);var zc,Go=lt.util.ByteBuffer,xt=typeof Buffer>"u"?Uint8Array:Buffer;lt.pki=lt.pki||{};t0.exports=lt.pki.ed25519=lt.ed25519=lt.ed25519||{};var ce=lt.ed25519;ce.constants={};ce.constants.PUBLIC_KEY_BYTE_LENGTH=32;ce.constants.PRIVATE_KEY_BYTE_LENGTH=64;ce.constants.SEED_BYTE_LENGTH=32;ce.constants.SIGN_BYTE_LENGTH=64;ce.constants.HASH_BYTE_LENGTH=64;ce.generateKeyPair=function(e){e=e||{};var t=e.seed;if(t===void 0)t=lt.random.getBytesSync(ce.constants.SEED_BYTE_LENGTH);else if(typeof t=="string"){if(t.length!==ce.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+ce.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');t=xr({message:t,encoding:"binary"});for(var a=new xt(ce.constants.PUBLIC_KEY_BYTE_LENGTH),r=new xt(ce.constants.PRIVATE_KEY_BYTE_LENGTH),n=0;n<32;++n)r[n]=t[n];return $g(a,r),{publicKey:a,privateKey:r}};ce.privateKeyFromAsn1=function(e){var t={},a=[],r=lt.asn1.validate(e,Wg,t,a);if(!r){var n=new Error("Invalid Key.");throw n.errors=a,n}var i=lt.asn1.derToOid(t.privateKeyOid),s=lt.oids.EdDSA25519;if(i!==s)throw new Error('Invalid OID "'+i+'"; OID must be "'+s+'".');var u=t.privateKey,c=xr({message:lt.asn1.fromDer(u).value,encoding:"binary"});return{privateKeyBytes:c}};ce.publicKeyFromAsn1=function(e){var t={},a=[],r=lt.asn1.validate(e,zg,t,a);if(!r){var n=new Error("Invalid Key.");throw n.errors=a,n}var i=lt.asn1.derToOid(t.publicKeyOid),s=lt.oids.EdDSA25519;if(i!==s)throw new Error('Invalid OID "'+i+'"; OID must be "'+s+'".');var u=t.ed25519PublicKey;if(u.length!==ce.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return xr({message:u,encoding:"binary"})};ce.publicKeyFromPrivateKey=function(e){e=e||{};var t=xr({message:e.privateKey,encoding:"binary"});if(t.length!==ce.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+ce.constants.PRIVATE_KEY_BYTE_LENGTH);for(var a=new xt(ce.constants.PUBLIC_KEY_BYTE_LENGTH),r=0;r<a.length;++r)a[r]=t[32+r];return a};ce.sign=function(e){e=e||{};var t=xr(e),a=xr({message:e.privateKey,encoding:"binary"});if(a.length===ce.constants.SEED_BYTE_LENGTH){var r=ce.generateKeyPair({seed:a});a=r.privateKey}else if(a.length!==ce.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+ce.constants.SEED_BYTE_LENGTH+" or "+ce.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new xt(ce.constants.SIGN_BYTE_LENGTH+t.length);Yg(n,t,t.length,a);for(var i=new xt(ce.constants.SIGN_BYTE_LENGTH),s=0;s<i.length;++s)i[s]=n[s];return i};ce.verify=function(e){e=e||{};var t=xr(e);if(e.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var a=xr({message:e.signature,encoding:"binary"});if(a.length!==ce.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+ce.constants.SIGN_BYTE_LENGTH);var r=xr({message:e.publicKey,encoding:"binary"});if(r.length!==ce.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+ce.constants.PUBLIC_KEY_BYTE_LENGTH);var n=new xt(ce.constants.SIGN_BYTE_LENGTH+t.length),i=new xt(ce.constants.SIGN_BYTE_LENGTH+t.length),s;for(s=0;s<ce.constants.SIGN_BYTE_LENGTH;++s)n[s]=a[s];for(s=0;s<t.length;++s)n[s+ce.constants.SIGN_BYTE_LENGTH]=t[s];return Xg(i,n,n.length,r)>=0};function xr(e){var t=e.message;if(t instanceof Uint8Array||t instanceof xt)return t;var a=e.encoding;if(t===void 0)if(e.md)t=e.md.digest().getBytes(),a="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof t=="string"&&!a)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof t=="string"){if(typeof Buffer<"u")return Buffer.from(t,a);t=new Go(t,a)}else if(!(t instanceof Go))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var r=new xt(t.length()),n=0;n<r.length;++n)r[n]=t.at(n);return r}var Qo=re(),ss=re([1]),Gg=re([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),Qg=re([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),Wc=re([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Gc=re([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),zo=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),jg=re([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function kn(e,t){var a=lt.md.sha512.create(),r=new Go(e);a.update(r.getBytes(t),"binary");var n=a.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(n,"binary");for(var i=new xt(ce.constants.HASH_BYTE_LENGTH),s=0;s<64;++s)i[s]=n.charCodeAt(s);return i}function $g(e,t){var a=[re(),re(),re(),re()],r,n=kn(t,32);for(n[0]&=248,n[31]&=127,n[31]|=64,Xo(a,n),Yo(e,a),r=0;r<32;++r)t[r+32]=e[r];return 0}function Yg(e,t,a,r){var n,i,s=new Float64Array(64),u=[re(),re(),re(),re()],c=kn(r,32);c[0]&=248,c[31]&=127,c[31]|=64;var f=a+64;for(n=0;n<a;++n)e[64+n]=t[n];for(n=0;n<32;++n)e[32+n]=c[32+n];var d=kn(e.subarray(32),a+32);for(jo(d),Xo(u,d),Yo(e,u),n=32;n<64;++n)e[n]=r[n];var h=kn(e,a+64);for(jo(h),n=32;n<64;++n)s[n]=0;for(n=0;n<32;++n)s[n]=d[n];for(n=0;n<32;++n)for(i=0;i<32;i++)s[n+i]+=h[n]*c[i];return Yc(e.subarray(32),s),f}function Xg(e,t,a,r){var n,i,s=new xt(32),u=[re(),re(),re(),re()],c=[re(),re(),re(),re()];if(i=-1,a<64||Zg(c,r))return-1;for(n=0;n<a;++n)e[n]=t[n];for(n=0;n<32;++n)e[n+32]=r[n];var f=kn(e,a);if(jo(f),Jc(u,c,f),Xo(c,t.subarray(32)),$o(u,c),Yo(s,u),a-=64,Xc(t,0,s,0)){for(n=0;n<a;++n)e[n]=0;return-1}for(n=0;n<a;++n)e[n]=t[n+64];return i=a,i}function Yc(e,t){var a,r,n,i;for(r=63;r>=32;--r){for(a=0,n=r-32,i=r-12;n<i;++n)t[n]+=a-16*t[r]*zo[n-(r-32)],a=t[n]+128>>8,t[n]-=a*256;t[n]+=a,t[r]=0}for(a=0,n=0;n<32;++n)t[n]+=a-(t[31]>>4)*zo[n],a=t[n]>>8,t[n]&=255;for(n=0;n<32;++n)t[n]-=a*zo[n];for(r=0;r<32;++r)t[r+1]+=t[r]>>8,e[r]=t[r]&255}function jo(e){for(var t=new Float64Array(64),a=0;a<64;++a)t[a]=e[a],e[a]=0;Yc(e,t)}function $o(e,t){var a=re(),r=re(),n=re(),i=re(),s=re(),u=re(),c=re(),f=re(),d=re();Ma(a,e[1],e[0]),Ma(d,t[1],t[0]),_e(a,a,d),qa(r,e[0],e[1]),qa(d,t[0],t[1]),_e(r,r,d),_e(n,e[3],t[3]),_e(n,n,Qg),_e(i,e[2],t[2]),qa(i,i,i),Ma(s,r,a),Ma(u,i,n),qa(c,i,n),qa(f,r,a),_e(e[0],s,u),_e(e[1],f,c),_e(e[2],c,u),_e(e[3],s,f)}function Qc(e,t,a){for(var r=0;r<4;++r)e0(e[r],t[r],a)}function Yo(e,t){var a=re(),r=re(),n=re();rm(n,t[2]),_e(a,t[0],n),_e(r,t[1],n),os(e,r),e[31]^=Zc(a)<<7}function os(e,t){var a,r,n,i=re(),s=re();for(a=0;a<16;++a)s[a]=t[a];for(Wo(s),Wo(s),Wo(s),r=0;r<2;++r){for(i[0]=s[0]-65517,a=1;a<15;++a)i[a]=s[a]-65535-(i[a-1]>>16&1),i[a-1]&=65535;i[15]=s[15]-32767-(i[14]>>16&1),n=i[15]>>16&1,i[14]&=65535,e0(s,i,1-n)}for(a=0;a<16;a++)e[2*a]=s[a]&255,e[2*a+1]=s[a]>>8}function Zg(e,t){var a=re(),r=re(),n=re(),i=re(),s=re(),u=re(),c=re();return Wr(e[2],ss),Jg(e[1],t),ca(n,e[1]),_e(i,n,Gg),Ma(n,n,e[2]),qa(i,e[2],i),ca(s,i),ca(u,s),_e(c,u,s),_e(a,c,n),_e(a,a,i),em(a,a),_e(a,a,n),_e(a,a,i),_e(a,a,i),_e(e[0],a,i),ca(r,e[0]),_e(r,r,i),jc(r,n)&&_e(e[0],e[0],jg),ca(r,e[0]),_e(r,r,i),jc(r,n)?-1:(Zc(e[0])===t[31]>>7&&Ma(e[0],Qo,e[0]),_e(e[3],e[0],e[1]),0)}function Jg(e,t){var a;for(a=0;a<16;++a)e[a]=t[2*a]+(t[2*a+1]<<8);e[15]&=32767}function em(e,t){var a=re(),r;for(r=0;r<16;++r)a[r]=t[r];for(r=250;r>=0;--r)ca(a,a),r!==1&&_e(a,a,t);for(r=0;r<16;++r)e[r]=a[r]}function jc(e,t){var a=new xt(32),r=new xt(32);return os(a,e),os(r,t),Xc(a,0,r,0)}function Xc(e,t,a,r){return tm(e,t,a,r,32)}function tm(e,t,a,r,n){var i,s=0;for(i=0;i<n;++i)s|=e[t+i]^a[r+i];return(1&s-1>>>8)-1}function Zc(e){var t=new xt(32);return os(t,e),t[0]&1}function Jc(e,t,a){var r,n;for(Wr(e[0],Qo),Wr(e[1],ss),Wr(e[2],ss),Wr(e[3],Qo),n=255;n>=0;--n)r=a[n/8|0]>>(n&7)&1,Qc(e,t,r),$o(t,e),$o(e,e),Qc(e,t,r)}function Xo(e,t){var a=[re(),re(),re(),re()];Wr(a[0],Wc),Wr(a[1],Gc),Wr(a[2],ss),_e(a[3],Wc,Gc),Jc(e,a,t)}function Wr(e,t){var a;for(a=0;a<16;a++)e[a]=t[a]|0}function rm(e,t){var a=re(),r;for(r=0;r<16;++r)a[r]=t[r];for(r=253;r>=0;--r)ca(a,a),r!==2&&r!==4&&_e(a,a,t);for(r=0;r<16;++r)e[r]=a[r]}function Wo(e){var t,a,r=1;for(t=0;t<16;++t)a=e[t]+r+65535,r=Math.floor(a/65536),e[t]=a-r*65536;e[0]+=r-1+37*(r-1)}function e0(e,t,a){for(var r,n=~(a-1),i=0;i<16;++i)r=n&(e[i]^t[i]),e[i]^=r,t[i]^=r}function re(e){var t,a=new Float64Array(16);if(e)for(t=0;t<e.length;++t)a[t]=e[t];return a}function qa(e,t,a){for(var r=0;r<16;++r)e[r]=t[r]+a[r]}function Ma(e,t,a){for(var r=0;r<16;++r)e[r]=t[r]-a[r]}function ca(e,t){_e(e,t,t)}function _e(e,t,a){var r,n,i=0,s=0,u=0,c=0,f=0,d=0,h=0,C=0,E=0,g=0,_=0,S=0,b=0,A=0,w=0,D=0,k=0,R=0,G=0,q=0,Y=0,H=0,ae=0,K=0,xe=0,De=0,Te=0,Ue=0,Z=0,$t=0,fr=0,Ve=a[0],Oe=a[1],qe=a[2],Ge=a[3],Ye=a[4],Xe=a[5],Ie=a[6],Ae=a[7],Ze=a[8],Qe=a[9],Be=a[10],Ke=a[11],He=a[12],je=a[13],Je=a[14],$e=a[15];r=t[0],i+=r*Ve,s+=r*Oe,u+=r*qe,c+=r*Ge,f+=r*Ye,d+=r*Xe,h+=r*Ie,C+=r*Ae,E+=r*Ze,g+=r*Qe,_+=r*Be,S+=r*Ke,b+=r*He,A+=r*je,w+=r*Je,D+=r*$e,r=t[1],s+=r*Ve,u+=r*Oe,c+=r*qe,f+=r*Ge,d+=r*Ye,h+=r*Xe,C+=r*Ie,E+=r*Ae,g+=r*Ze,_+=r*Qe,S+=r*Be,b+=r*Ke,A+=r*He,w+=r*je,D+=r*Je,k+=r*$e,r=t[2],u+=r*Ve,c+=r*Oe,f+=r*qe,d+=r*Ge,h+=r*Ye,C+=r*Xe,E+=r*Ie,g+=r*Ae,_+=r*Ze,S+=r*Qe,b+=r*Be,A+=r*Ke,w+=r*He,D+=r*je,k+=r*Je,R+=r*$e,r=t[3],c+=r*Ve,f+=r*Oe,d+=r*qe,h+=r*Ge,C+=r*Ye,E+=r*Xe,g+=r*Ie,_+=r*Ae,S+=r*Ze,b+=r*Qe,A+=r*Be,w+=r*Ke,D+=r*He,k+=r*je,R+=r*Je,G+=r*$e,r=t[4],f+=r*Ve,d+=r*Oe,h+=r*qe,C+=r*Ge,E+=r*Ye,g+=r*Xe,_+=r*Ie,S+=r*Ae,b+=r*Ze,A+=r*Qe,w+=r*Be,D+=r*Ke,k+=r*He,R+=r*je,G+=r*Je,q+=r*$e,r=t[5],d+=r*Ve,h+=r*Oe,C+=r*qe,E+=r*Ge,g+=r*Ye,_+=r*Xe,S+=r*Ie,b+=r*Ae,A+=r*Ze,w+=r*Qe,D+=r*Be,k+=r*Ke,R+=r*He,G+=r*je,q+=r*Je,Y+=r*$e,r=t[6],h+=r*Ve,C+=r*Oe,E+=r*qe,g+=r*Ge,_+=r*Ye,S+=r*Xe,b+=r*Ie,A+=r*Ae,w+=r*Ze,D+=r*Qe,k+=r*Be,R+=r*Ke,G+=r*He,q+=r*je,Y+=r*Je,H+=r*$e,r=t[7],C+=r*Ve,E+=r*Oe,g+=r*qe,_+=r*Ge,S+=r*Ye,b+=r*Xe,A+=r*Ie,w+=r*Ae,D+=r*Ze,k+=r*Qe,R+=r*Be,G+=r*Ke,q+=r*He,Y+=r*je,H+=r*Je,ae+=r*$e,r=t[8],E+=r*Ve,g+=r*Oe,_+=r*qe,S+=r*Ge,b+=r*Ye,A+=r*Xe,w+=r*Ie,D+=r*Ae,k+=r*Ze,R+=r*Qe,G+=r*Be,q+=r*Ke,Y+=r*He,H+=r*je,ae+=r*Je,K+=r*$e,r=t[9],g+=r*Ve,_+=r*Oe,S+=r*qe,b+=r*Ge,A+=r*Ye,w+=r*Xe,D+=r*Ie,k+=r*Ae,R+=r*Ze,G+=r*Qe,q+=r*Be,Y+=r*Ke,H+=r*He,ae+=r*je,K+=r*Je,xe+=r*$e,r=t[10],_+=r*Ve,S+=r*Oe,b+=r*qe,A+=r*Ge,w+=r*Ye,D+=r*Xe,k+=r*Ie,R+=r*Ae,G+=r*Ze,q+=r*Qe,Y+=r*Be,H+=r*Ke,ae+=r*He,K+=r*je,xe+=r*Je,De+=r*$e,r=t[11],S+=r*Ve,b+=r*Oe,A+=r*qe,w+=r*Ge,D+=r*Ye,k+=r*Xe,R+=r*Ie,G+=r*Ae,q+=r*Ze,Y+=r*Qe,H+=r*Be,ae+=r*Ke,K+=r*He,xe+=r*je,De+=r*Je,Te+=r*$e,r=t[12],b+=r*Ve,A+=r*Oe,w+=r*qe,D+=r*Ge,k+=r*Ye,R+=r*Xe,G+=r*Ie,q+=r*Ae,Y+=r*Ze,H+=r*Qe,ae+=r*Be,K+=r*Ke,xe+=r*He,De+=r*je,Te+=r*Je,Ue+=r*$e,r=t[13],A+=r*Ve,w+=r*Oe,D+=r*qe,k+=r*Ge,R+=r*Ye,G+=r*Xe,q+=r*Ie,Y+=r*Ae,H+=r*Ze,ae+=r*Qe,K+=r*Be,xe+=r*Ke,De+=r*He,Te+=r*je,Ue+=r*Je,Z+=r*$e,r=t[14],w+=r*Ve,D+=r*Oe,k+=r*qe,R+=r*Ge,G+=r*Ye,q+=r*Xe,Y+=r*Ie,H+=r*Ae,ae+=r*Ze,K+=r*Qe,xe+=r*Be,De+=r*Ke,Te+=r*He,Ue+=r*je,Z+=r*Je,$t+=r*$e,r=t[15],D+=r*Ve,k+=r*Oe,R+=r*qe,G+=r*Ge,q+=r*Ye,Y+=r*Xe,H+=r*Ie,ae+=r*Ae,K+=r*Ze,xe+=r*Qe,De+=r*Be,Te+=r*Ke,Ue+=r*He,Z+=r*je,$t+=r*Je,fr+=r*$e,i+=38*k,s+=38*R,u+=38*G,c+=38*q,f+=38*Y,d+=38*H,h+=38*ae,C+=38*K,E+=38*xe,g+=38*De,_+=38*Te,S+=38*Ue,b+=38*Z,A+=38*$t,w+=38*fr,n=1,r=i+n+65535,n=Math.floor(r/65536),i=r-n*65536,r=s+n+65535,n=Math.floor(r/65536),s=r-n*65536,r=u+n+65535,n=Math.floor(r/65536),u=r-n*65536,r=c+n+65535,n=Math.floor(r/65536),c=r-n*65536,r=f+n+65535,n=Math.floor(r/65536),f=r-n*65536,r=d+n+65535,n=Math.floor(r/65536),d=r-n*65536,r=h+n+65535,n=Math.floor(r/65536),h=r-n*65536,r=C+n+65535,n=Math.floor(r/65536),C=r-n*65536,r=E+n+65535,n=Math.floor(r/65536),E=r-n*65536,r=g+n+65535,n=Math.floor(r/65536),g=r-n*65536,r=_+n+65535,n=Math.floor(r/65536),_=r-n*65536,r=S+n+65535,n=Math.floor(r/65536),S=r-n*65536,r=b+n+65535,n=Math.floor(r/65536),b=r-n*65536,r=A+n+65535,n=Math.floor(r/65536),A=r-n*65536,r=w+n+65535,n=Math.floor(r/65536),w=r-n*65536,r=D+n+65535,n=Math.floor(r/65536),D=r-n*65536,i+=n-1+37*(n-1),n=1,r=i+n+65535,n=Math.floor(r/65536),i=r-n*65536,r=s+n+65535,n=Math.floor(r/65536),s=r-n*65536,r=u+n+65535,n=Math.floor(r/65536),u=r-n*65536,r=c+n+65535,n=Math.floor(r/65536),c=r-n*65536,r=f+n+65535,n=Math.floor(r/65536),f=r-n*65536,r=d+n+65535,n=Math.floor(r/65536),d=r-n*65536,r=h+n+65535,n=Math.floor(r/65536),h=r-n*65536,r=C+n+65535,n=Math.floor(r/65536),C=r-n*65536,r=E+n+65535,n=Math.floor(r/65536),E=r-n*65536,r=g+n+65535,n=Math.floor(r/65536),g=r-n*65536,r=_+n+65535,n=Math.floor(r/65536),_=r-n*65536,r=S+n+65535,n=Math.floor(r/65536),S=r-n*65536,r=b+n+65535,n=Math.floor(r/65536),b=r-n*65536,r=A+n+65535,n=Math.floor(r/65536),A=r-n*65536,r=w+n+65535,n=Math.floor(r/65536),w=r-n*65536,r=D+n+65535,n=Math.floor(r/65536),D=r-n*65536,i+=n-1+37*(n-1),e[0]=i,e[1]=s,e[2]=u,e[3]=c,e[4]=f,e[5]=d,e[6]=h,e[7]=C,e[8]=E,e[9]=g,e[10]=_,e[11]=S,e[12]=b,e[13]=A,e[14]=w,e[15]=D}});var s0=ne((E1,i0)=>{var wt=ue();me();Pt();wn();i0.exports=wt.kem=wt.kem||{};var a0=wt.jsbn.BigInteger;wt.kem.rsa={};wt.kem.rsa.create=function(e,t){t=t||{};var a=t.prng||wt.random,r={};return r.encrypt=function(n,i){var s=Math.ceil(n.n.bitLength()/8),u;do u=new a0(wt.util.bytesToHex(a.getBytesSync(s)),16).mod(n.n);while(u.compareTo(a0.ONE)<=0);u=wt.util.hexToBytes(u.toString(16));var c=s-u.length;c>0&&(u=wt.util.fillString(String.fromCharCode(0),c)+u);var f=n.encrypt(u,"NONE"),d=e.generate(u,i);return{encapsulation:f,key:d}},r.decrypt=function(n,i,s){var u=n.decrypt(i,"NONE");return e.generate(u,s)},r};wt.kem.kdf1=function(e,t){n0(this,e,0,t||e.digestLength)};wt.kem.kdf2=function(e,t){n0(this,e,1,t||e.digestLength)};function n0(e,t,a,r){e.generate=function(n,i){for(var s=new wt.util.ByteBuffer,u=Math.ceil(i/r)+a,c=new wt.util.ByteBuffer,f=a;f<u;++f){c.putInt32(f),t.start(),t.update(n+c.getBytes());var d=t.digest();s.putBytes(d.getBytes(r))}return s.truncate(s.length()-i),s.getBytes()}}});var f0=ne((b1,l0)=>{var he=ue();me();l0.exports=he.log=he.log||{};he.log.levels=["none","error","warning","info","debug","verbose","max"];var us={},eu=[],Un=null;he.log.LEVEL_LOCKED=1<<1;he.log.NO_LEVEL_CHECK=1<<2;he.log.INTERPOLATE=1<<3;for(or=0;or<he.log.levels.length;++or)Zo=he.log.levels[or],us[Zo]={index:or,name:Zo.toUpperCase()};var Zo,or;he.log.logMessage=function(e){for(var t=us[e.level].index,a=0;a<eu.length;++a){var r=eu[a];if(r.flags&he.log.NO_LEVEL_CHECK)r.f(e);else{var n=us[r.level].index;t<=n&&r.f(r,e)}}};he.log.prepareStandard=function(e){"standard"in e||(e.standard=us[e.level].name+" ["+e.category+"] "+e.message)};he.log.prepareFull=function(e){if(!("full"in e)){var t=[e.message];t=t.concat([]),e.full=he.util.format.apply(this,t)}};he.log.prepareStandardFull=function(e){"standardFull"in e||(he.log.prepareStandard(e),e.standardFull=e.standard)};for(Jo=["error","warning","info","debug","verbose"],or=0;or<Jo.length;++or)(function(t){he.log[t]=function(a,r){var n=Array.prototype.slice.call(arguments).slice(2),i={timestamp:new Date,level:t,category:a,message:r,arguments:n};he.log.logMessage(i)}})(Jo[or]);var Jo,or;he.log.makeLogger=function(e){var t={flags:0,f:e};return he.log.setLevel(t,"none"),t};he.log.setLevel=function(e,t){var a=!1;if(e&&!(e.flags&he.log.LEVEL_LOCKED))for(var r=0;r<he.log.levels.length;++r){var n=he.log.levels[r];if(t==n){e.level=t,a=!0;break}}return a};he.log.lock=function(e,t){typeof t>"u"||t?e.flags|=he.log.LEVEL_LOCKED:e.flags&=~he.log.LEVEL_LOCKED};he.log.addLogger=function(e){eu.push(e)};typeof console<"u"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(o0={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},On=function(e,t){he.log.prepareStandard(t);var a=o0[t.level],r=[t.standard];r=r.concat(t.arguments.slice()),a.apply(console,r)},Ka=he.log.makeLogger(On)):(On=function(t,a){he.log.prepareStandardFull(a),console.log(a.standardFull)},Ka=he.log.makeLogger(On)),he.log.setLevel(Ka,"debug"),he.log.addLogger(Ka),Un=Ka):console={log:function(){}};var Ka,o0,On;Un!==null&&typeof window<"u"&&window.location&&(Pn=new URL(window.location.href).searchParams,Pn.has("console.level")&&he.log.setLevel(Un,Pn.get("console.level").slice(-1)[0]),Pn.has("console.lock")&&(u0=Pn.get("console.lock").slice(-1)[0],u0=="true"&&he.log.lock(Un)));var Pn,u0;he.log.consoleLogger=Un});var d0=ne((x1,c0)=>{c0.exports=Jt();Mi();Pa();ho();Ko()});var y0=ne((T1,p0)=>{var W=ue();Or();Qt();In();Fr();na();Io();Pt();me();ts();var I=W.asn1,mt=p0.exports=W.pkcs7=W.pkcs7||{};mt.messageFromPem=function(e){var t=W.pem.decode(e)[0];if(t.type!=="PKCS7"){var a=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var r=I.fromDer(t.body);return mt.messageFromAsn1(r)};mt.messageToPem=function(e,t){var a={type:"PKCS7",body:I.toDer(e.toAsn1()).getBytes()};return W.pem.encode(a,{maxline:t})};mt.messageFromAsn1=function(e){var t={},a=[];if(!I.validate(e,mt.asn1.contentInfoValidator,t,a)){var r=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw r.errors=a,r}var n=I.derToOid(t.contentType),i;switch(n){case W.pki.oids.envelopedData:i=mt.createEnvelopedData();break;case W.pki.oids.encryptedData:i=mt.createEncryptedData();break;case W.pki.oids.signedData:i=mt.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+n+" is not (yet) supported.")}return i.fromAsn1(t.content.value[0]),i};mt.createSignedData=function(){var e=null;return e={type:W.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(r){if(ru(e,r,mt.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var n=e.rawCapture.certificates.value,i=0;i<n.length;++i)e.certificates.push(W.pki.certificateFromAsn1(n[i]))},toAsn1:function(){e.contentInfo||e.sign();for(var r=[],n=0;n<e.certificates.length;++n)r.push(W.pki.certificateToAsn1(e.certificates[n]));var i=[],s=I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(e.version).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return r.length>0&&s.value[0].value.push(I.create(I.Class.CONTEXT_SPECIFIC,0,!0,r)),i.length>0&&s.value[0].value.push(I.create(I.Class.CONTEXT_SPECIFIC,1,!0,i)),s.value[0].value.push(I.create(I.Class.UNIVERSAL,I.Type.SET,!0,e.signerInfos)),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.type).getBytes()),s])},addSigner:function(r){var n=r.issuer,i=r.serialNumber;if(r.certificate){var s=r.certificate;typeof s=="string"&&(s=W.pki.certificateFromPem(s)),n=s.issuer.attributes,i=s.serialNumber}var u=r.key;if(!u)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof u=="string"&&(u=W.pki.privateKeyFromPem(u));var c=r.digestAlgorithm||W.pki.oids.sha1;switch(c){case W.pki.oids.sha1:case W.pki.oids.sha256:case W.pki.oids.sha384:case W.pki.oids.sha512:case W.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var f=r.authenticatedAttributes||[];if(f.length>0){for(var d=!1,h=!1,C=0;C<f.length;++C){var E=f[C];if(!d&&E.type===W.pki.oids.contentType){if(d=!0,h)break;continue}if(!h&&E.type===W.pki.oids.messageDigest){if(h=!0,d)break;continue}}if(!d||!h)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:u,version:1,issuer:n,serialNumber:i,digestAlgorithm:c,signatureAlgorithm:W.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:f,unauthenticatedAttributes:[]})},sign:function(r){if(r=r||{},(typeof e.content!="object"||e.contentInfo===null)&&(e.contentInfo=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(W.pki.oids.data).getBytes())]),"content"in e)){var n;e.content instanceof W.util.ByteBuffer?n=e.content.bytes():typeof e.content=="string"&&(n=W.util.encodeUtf8(e.content)),r.detached?e.detachedContent=I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,n):e.contentInfo.value.push(I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,n)]))}if(e.signers.length!==0){var i=t();a(i)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(r){typeof r=="string"&&(r=W.pki.certificateFromPem(r)),e.certificates.push(r)},addCertificateRevokationList:function(r){throw new Error("PKCS#7 CRL support not yet implemented.")}},e;function t(){for(var r={},n=0;n<e.signers.length;++n){var i=e.signers[n],s=i.digestAlgorithm;s in r||(r[s]=W.md[W.pki.oids[s]].create()),i.authenticatedAttributes.length===0?i.md=r[s]:i.md=W.md[W.pki.oids[s]].create()}e.digestAlgorithmIdentifiers=[];for(var s in r)e.digestAlgorithmIdentifiers.push(I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(s).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")]));return r}function a(r){var n;if(e.detachedContent?n=e.detachedContent:(n=e.contentInfo.value[1],n=n.value[0]),!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var i=I.derToOid(e.contentInfo.value[0].value),s=I.toDer(n);s.getByte(),I.getBerValueLength(s),s=s.getBytes();for(var u in r)r[u].start().update(s);for(var c=new Date,f=0;f<e.signers.length;++f){var d=e.signers[f];if(d.authenticatedAttributes.length===0){if(i!==W.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{d.authenticatedAttributesAsn1=I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var h=I.create(I.Class.UNIVERSAL,I.Type.SET,!0,[]),C=0;C<d.authenticatedAttributes.length;++C){var E=d.authenticatedAttributes[C];E.type===W.pki.oids.messageDigest?E.value=r[d.digestAlgorithm].digest():E.type===W.pki.oids.signingTime&&(E.value||(E.value=c)),h.value.push(tu(E)),d.authenticatedAttributesAsn1.value.push(tu(E))}s=I.toDer(h).getBytes(),d.md.start().update(s)}d.signature=d.key.sign(d.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=um(e.signers)}};mt.createEncryptedData=function(){var e=null;return e={type:W.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:W.pki.oids["aes256-CBC"]},fromAsn1:function(t){ru(e,t,mt.asn1.encryptedDataValidator)},decrypt:function(t){t!==void 0&&(e.encryptedContent.key=t),h0(e)}},e};mt.createEnvelopedData=function(){var e=null;return e={type:W.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:W.pki.oids["aes256-CBC"]},fromAsn1:function(t){var a=ru(e,t,mt.asn1.envelopedDataValidator);e.recipients=im(a.recipientInfos.value)},toAsn1:function(){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.type).getBytes()),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(e.version).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SET,!0,sm(e.recipients)),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,lm(e.encryptedContent))])])])},findRecipient:function(t){for(var a=t.issuer.attributes,r=0;r<e.recipients.length;++r){var n=e.recipients[r],i=n.issuer;if(n.serialNumber===t.serialNumber&&i.length===a.length){for(var s=!0,u=0;u<a.length;++u)if(i[u].type!==a[u].type||i[u].value!==a[u].value){s=!1;break}if(s)return n}}return null},decrypt:function(t,a){if(e.encryptedContent.key===void 0&&t!==void 0&&a!==void 0)switch(t.encryptedContent.algorithm){case W.pki.oids.rsaEncryption:case W.pki.oids.desCBC:var r=a.decrypt(t.encryptedContent.content);e.encryptedContent.key=W.util.createBuffer(r);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}h0(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:W.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,a){if(e.encryptedContent.content===void 0){a=a||e.encryptedContent.algorithm,t=t||e.encryptedContent.key;var r,n,i;switch(a){case W.pki.oids["aes128-CBC"]:r=16,n=16,i=W.aes.createEncryptionCipher;break;case W.pki.oids["aes192-CBC"]:r=24,n=16,i=W.aes.createEncryptionCipher;break;case W.pki.oids["aes256-CBC"]:r=32,n=16,i=W.aes.createEncryptionCipher;break;case W.pki.oids["des-EDE3-CBC"]:r=24,n=8,i=W.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+a)}if(t===void 0)t=W.util.createBuffer(W.random.getBytes(r));else if(t.length()!=r)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+r+".");e.encryptedContent.algorithm=a,e.encryptedContent.key=t,e.encryptedContent.parameter=W.util.createBuffer(W.random.getBytes(n));var s=i(t);if(s.start(e.encryptedContent.parameter.copy()),s.update(e.content),!s.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=s.output}for(var u=0;u<e.recipients.length;++u){var c=e.recipients[u];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case W.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},e};function am(e){var t={},a=[];if(!I.validate(e,mt.asn1.recipientInfoValidator,t,a)){var r=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw r.errors=a,r}return{version:t.version.charCodeAt(0),issuer:W.pki.RDNAttributesAsArray(t.issuer),serialNumber:W.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:I.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function nm(e){return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(e.version).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[W.pki.distinguishedNameToAsn1({attributes:e.issuer}),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,W.util.hexToBytes(e.serialNumber))]),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.encryptedContent.algorithm).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")]),I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.encryptedContent.content)])}function im(e){for(var t=[],a=0;a<e.length;++a)t.push(am(e[a]));return t}function sm(e){for(var t=[],a=0;a<e.length;++a)t.push(nm(e[a]));return t}function om(e){var t=I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,I.integerToDer(e.version).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[W.pki.distinguishedNameToAsn1({attributes:e.issuer}),I.create(I.Class.UNIVERSAL,I.Type.INTEGER,!1,W.util.hexToBytes(e.serialNumber))]),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.digestAlgorithm).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.signatureAlgorithm).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.NULL,!1,"")])),t.value.push(I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var a=I.create(I.Class.CONTEXT_SPECIFIC,1,!0,[]),r=0;r<e.unauthenticatedAttributes.length;++r){var n=e.unauthenticatedAttributes[r];a.values.push(tu(n))}t.value.push(a)}return t}function um(e){for(var t=[],a=0;a<e.length;++a)t.push(om(e[a]));return t}function tu(e){var t;if(e.type===W.pki.oids.contentType)t=I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.value).getBytes());else if(e.type===W.pki.oids.messageDigest)t=I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===W.pki.oids.signingTime){var a=new Date("1950-01-01T00:00:00Z"),r=new Date("2050-01-01T00:00:00Z"),n=e.value;if(typeof n=="string"){var i=Date.parse(n);isNaN(i)?n.length===13?n=I.utcTimeToDate(n):n=I.generalizedTimeToDate(n):n=new Date(i)}n>=a&&n<r?t=I.create(I.Class.UNIVERSAL,I.Type.UTCTIME,!1,I.dateToUtcTime(n)):t=I.create(I.Class.UNIVERSAL,I.Type.GENERALIZEDTIME,!1,I.dateToGeneralizedTime(n))}return I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.type).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SET,!0,[t])])}function lm(e){return[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(W.pki.oids.data).getBytes()),I.create(I.Class.UNIVERSAL,I.Type.SEQUENCE,!0,[I.create(I.Class.UNIVERSAL,I.Type.OID,!1,I.oidToDer(e.algorithm).getBytes()),e.parameter?I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.parameter.getBytes()):void 0]),I.create(I.Class.CONTEXT_SPECIFIC,0,!0,[I.create(I.Class.UNIVERSAL,I.Type.OCTETSTRING,!1,e.content.getBytes())])]}function ru(e,t,a){var r={},n=[];if(!I.validate(t,a,r,n)){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw i.errors=i,i}var s=I.derToOid(r.contentType);if(s!==W.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(r.encryptedContent){var u="";if(W.util.isArray(r.encryptedContent))for(var c=0;c<r.encryptedContent.length;++c){if(r.encryptedContent[c].type!==I.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");u+=r.encryptedContent[c].value}else u=r.encryptedContent;e.encryptedContent={algorithm:I.derToOid(r.encAlgorithm),parameter:W.util.createBuffer(r.encParameter.value),content:W.util.createBuffer(u)}}if(r.content){var u="";if(W.util.isArray(r.content))for(var c=0;c<r.content.length;++c){if(r.content[c].type!==I.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");u+=r.content[c].value}else u=r.content;e.content=W.util.createBuffer(u)}return e.version=r.version.charCodeAt(0),e.rawCapture=r,r}function h0(e){if(e.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(e.content===void 0){var t;switch(e.encryptedContent.algorithm){case W.pki.oids["aes128-CBC"]:case W.pki.oids["aes192-CBC"]:case W.pki.oids["aes256-CBC"]:t=W.aes.createDecryptionCipher(e.encryptedContent.key);break;case W.pki.oids.desCBC:case W.pki.oids["des-EDE3-CBC"]:t=W.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}});var m0=ne((A1,g0)=>{var We=ue();Or();Na();Mi();Pa();me();var fs=g0.exports=We.ssh=We.ssh||{};fs.privateKeyToPutty=function(e,t,a){a=a||"",t=t||"";var r="ssh-rsa",n=t===""?"none":"aes256-cbc",i="PuTTY-User-Key-File-2: "+r+`\r
`;i+="Encryption: "+n+`\r
`,i+="Comment: "+a+`\r
`;var s=We.util.createBuffer();Ha(s,r),ur(s,e.e),ur(s,e.n);var u=We.util.encode64(s.bytes(),64),c=Math.floor(u.length/66)+1;i+="Public-Lines: "+c+`\r
`,i+=u;var f=We.util.createBuffer();ur(f,e.d),ur(f,e.p),ur(f,e.q),ur(f,e.qInv);var d;if(!t)d=We.util.encode64(f.bytes(),64);else{var h=f.length()+16-1;h-=h%16;var C=ls(f.bytes());C.truncate(C.length()-h+f.length()),f.putBuffer(C);var E=We.util.createBuffer();E.putBuffer(ls("\0\0\0\0",t)),E.putBuffer(ls("\0\0\0",t));var g=We.aes.createEncryptionCipher(E.truncate(8),"CBC");g.start(We.util.createBuffer().fillWithByte(0,16)),g.update(f.copy()),g.finish();var _=g.output;_.truncate(16),d=We.util.encode64(_.bytes(),64)}c=Math.floor(d.length/66)+1,i+=`\r
Private-Lines: `+c+`\r
`,i+=d;var S=ls("putty-private-key-file-mac-key",t),b=We.util.createBuffer();Ha(b,r),Ha(b,n),Ha(b,a),b.putInt32(s.length()),b.putBuffer(s),b.putInt32(f.length()),b.putBuffer(f);var A=We.hmac.create();return A.start("sha1",S),A.update(b.bytes()),i+=`\r
Private-MAC: `+A.digest().toHex()+`\r
`,i};fs.publicKeyToOpenSSH=function(e,t){var a="ssh-rsa";t=t||"";var r=We.util.createBuffer();return Ha(r,a),ur(r,e.e),ur(r,e.n),a+" "+We.util.encode64(r.bytes())+" "+t};fs.privateKeyToOpenSSH=function(e,t){return t?We.pki.encryptRsaPrivateKey(e,t,{legacy:!0,algorithm:"aes128"}):We.pki.privateKeyToPem(e)};fs.getPublicKeyFingerprint=function(e,t){t=t||{};var a=t.md||We.md.md5.create(),r="ssh-rsa",n=We.util.createBuffer();Ha(n,r),ur(n,e.e),ur(n,e.n),a.start(),a.update(n.getBytes());var i=a.digest();if(t.encoding==="hex"){var s=i.toHex();return t.delimiter?s.match(/.{2}/g).join(t.delimiter):s}else{if(t.encoding==="binary")return i.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return i};function ur(e,t){var a=t.toString(16);a[0]>="8"&&(a="00"+a);var r=We.util.hexToBytes(a);e.putInt32(r.length),e.putBytes(r)}function Ha(e,t){e.putInt32(t.length),e.putString(t)}function ls(){for(var e=We.md.sha1.create(),t=arguments.length,a=0;a<t;++a)e.update(arguments[a]);return e.digest()}});var C0=ne((_1,v0)=>{v0.exports=ue();Or();Fc();Qt();ki();In();r0();Na();s0();f0();d0();Bo();Wi();na();bo();No();y0();Do();To();po();Zi();Pt();mo();m0();Vo();me()});var iu=ne(Wa=>{"use strict";Wa.icondir="icons";var nu={amazon:[],aws:["amazonaws"],authy:[],bitcoin:[],circle:[],cloudflare:[],coinbase:[],dashlane:[],digitalocean:[],discord:[],dropbox:[],ea:[],evernote:[],facebook:[],github:[],gmail:[],google:["google apps"],heroku:[],hootsuite:[],hubspot:[],ifttt:[],kickstarter:[],lastpass:[],linode:[],logmein:[],mailchimp:[],microsoft:[],okta:[],salesforce:[],slack:[],snapchat:[],stripe:[],teamviewer:[],tumblr:[],twitch:[],twitter:[],wordpress:[],npm:[],twilio:[],synology:[],namecheap:[]};Wa.logos=[...Object.keys(nu),...Object.values(nu).flat()];Wa.logoAliases=Object.entries(nu).reduce((e,[t,a])=>{if(a.length)for(let r of a)e[r]=t;return e},{});Wa.genericColors=[{name:"black",value:"#464646"},{name:"blue",value:"#098FCE"},{name:"green",value:"#3DA329"},{name:"orange",value:"#F59E27"},{name:"purple",value:"#7408B4"},{name:"red",value:"#DF1112"}];Wa.icons=["key"]});var Am={};ml(Am,{default:()=>k0});module.exports=ih(Am);var Vn=require("react"),D0=require("@raycast/api");var fn=require("@raycast/api"),Nr="services",Lr="apps",hr="requestId",pr="deviceId",yr="secretSeed",cn="authyId",Zr="recentlyUsed";async function Nt(e){return await fn.LocalStorage.getItem(e)!=null}async function Ct(e){let t=await fn.LocalStorage.getItem(e);if(t!=null)return JSON.parse(t);throw new Error(`${e} not found`)}async function Lt(e,t){return await fn.LocalStorage.setItem(e,JSON.stringify(t))}async function Dt(e){return await fn.LocalStorage.removeItem(e)}var A0=require("react");var Ba=require("url"),Jl=ft(require("crypto")),Zs=ft(require("os"));var Xl=ft(require("node:http"),1),Zl=ft(require("node:https"),1),ra=ft(require("node:zlib"),1),It=ft(require("node:stream"),1),Cn=require("node:buffer");function sh(e){if(!/^data:/i.test(e))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');e=e.replace(/\r?\n/g,"");let t=e.indexOf(",");if(t===-1||t<=4)throw new TypeError("malformed data: URI");let a=e.substring(5,t).split(";"),r="",n=!1,i=a[0]||"text/plain",s=i;for(let d=1;d<a.length;d++)a[d]==="base64"?n=!0:(s+=`;${a[d]}`,a[d].indexOf("charset=")===0&&(r=a[d].substring(8)));!a[0]&&!r.length&&(s+=";charset=US-ASCII",r="US-ASCII");let u=n?"base64":"ascii",c=unescape(e.substring(t+1)),f=Buffer.from(c,u);return f.type=i,f.typeFull=s,f.charset=r,f}var Cl=sh;var kt=ft(require("node:stream"),1),vr=require("node:util"),_t=require("node:buffer");dn();Si();var mr=class extends Error{constructor(t,a){super(t),Error.captureStackTrace(this,this.constructor),this.type=a}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var St=class extends mr{constructor(t,a,r){super(t,a),r&&(this.code=this.errno=r.code,this.erroredSysCall=r.syscall)}};var Ei=Symbol.toStringTag,Gs=e=>typeof e=="object"&&typeof e.append=="function"&&typeof e.delete=="function"&&typeof e.get=="function"&&typeof e.getAll=="function"&&typeof e.has=="function"&&typeof e.set=="function"&&typeof e.sort=="function"&&e[Ei]==="URLSearchParams",pn=e=>e&&typeof e=="object"&&typeof e.arrayBuffer=="function"&&typeof e.type=="string"&&typeof e.stream=="function"&&typeof e.constructor=="function"&&/^(Blob|File)$/.test(e[Ei]),Bl=e=>typeof e=="object"&&(e[Ei]==="AbortSignal"||e[Ei]==="EventTarget"),wl=(e,t)=>{let a=new URL(t).hostname,r=new URL(e).hostname;return a===r||a.endsWith(`.${r}`)},Rl=(e,t)=>{let a=new URL(t).protocol,r=new URL(e).protocol;return a===r};var Eh=(0,vr.promisify)(kt.default.pipeline),Et=Symbol("Body internals"),Zt=class{constructor(t,{size:a=0}={}){let r=null;t===null?t=null:Gs(t)?t=_t.Buffer.from(t.toString()):pn(t)||_t.Buffer.isBuffer(t)||(vr.types.isAnyArrayBuffer(t)?t=_t.Buffer.from(t):ArrayBuffer.isView(t)?t=_t.Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof kt.default||(t instanceof ea?(t=Il(t),r=t.type.split("=")[1]):t=_t.Buffer.from(String(t))));let n=t;_t.Buffer.isBuffer(t)?n=kt.default.Readable.from(t):pn(t)&&(n=kt.default.Readable.from(t.stream())),this[Et]={body:t,stream:n,boundary:r,disturbed:!1,error:null},this.size=a,t instanceof kt.default&&t.on("error",i=>{let s=i instanceof mr?i:new St(`Invalid response body while trying to fetch ${this.url}: ${i.message}`,"system",i);this[Et].error=s})}get body(){return this[Et].stream}get bodyUsed(){return this[Et].disturbed}async arrayBuffer(){let{buffer:t,byteOffset:a,byteLength:r}=await $s(this);return t.slice(a,a+r)}async formData(){let t=this.headers.get("content-type");if(t.startsWith("application/x-www-form-urlencoded")){let r=new ea,n=new URLSearchParams(await this.text());for(let[i,s]of n)r.append(i,s);return r}let{toFormData:a}=await Promise.resolve().then(()=>(Ul(),Pl));return a(this.body,t)}async blob(){let t=this.headers&&this.headers.get("content-type")||this[Et].body&&this[Et].body.type||"",a=await this.arrayBuffer();return new gr([a],{type:t})}async json(){let t=await this.text();return JSON.parse(t)}async text(){let t=await $s(this);return new TextDecoder().decode(t)}buffer(){return $s(this)}};Zt.prototype.buffer=(0,vr.deprecate)(Zt.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(Zt.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,vr.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function $s(e){if(e[Et].disturbed)throw new TypeError(`body used already for: ${e.url}`);if(e[Et].disturbed=!0,e[Et].error)throw e[Et].error;let{body:t}=e;if(t===null)return _t.Buffer.alloc(0);if(!(t instanceof kt.default))return _t.Buffer.alloc(0);let a=[],r=0;try{for await(let n of t){if(e.size>0&&r+n.length>e.size){let i=new St(`content size at ${e.url} over limit: ${e.size}`,"max-size");throw t.destroy(i),i}r+=n.length,a.push(n)}}catch(n){throw n instanceof mr?n:new St(`Invalid response body while trying to fetch ${e.url}: ${n.message}`,"system",n)}if(t.readableEnded===!0||t._readableState.ended===!0)try{return a.every(n=>typeof n=="string")?_t.Buffer.from(a.join("")):_t.Buffer.concat(a,r)}catch(n){throw new St(`Could not create Buffer from response body for ${e.url}: ${n.message}`,"system",n)}else throw new St(`Premature close of server response while trying to fetch ${e.url}`)}var _a=(e,t)=>{let a,r,{body:n}=e[Et];if(e.bodyUsed)throw new Error("cannot clone body after it is used");return n instanceof kt.default&&typeof n.getBoundary!="function"&&(a=new kt.PassThrough({highWaterMark:t}),r=new kt.PassThrough({highWaterMark:t}),n.pipe(a),n.pipe(r),e[Et].stream=a,n=r),n},bh=(0,vr.deprecate)(e=>e.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),Ai=(e,t)=>e===null?null:typeof e=="string"?"text/plain;charset=UTF-8":Gs(e)?"application/x-www-form-urlencoded;charset=UTF-8":pn(e)?e.type||null:_t.Buffer.isBuffer(e)||vr.types.isAnyArrayBuffer(e)||ArrayBuffer.isView(e)?null:e instanceof ea?`multipart/form-data; boundary=${t[Et].boundary}`:e&&typeof e.getBoundary=="function"?`multipart/form-data;boundary=${bh(e)}`:e instanceof kt.default?null:"text/plain;charset=UTF-8",Ol=e=>{let{body:t}=e[Et];return t===null?0:pn(t)?t.size:_t.Buffer.isBuffer(t)?t.length:t&&typeof t.getLengthSync=="function"&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null},Fl=async(e,{body:t})=>{t===null?e.end():await Eh(t,e)};var Ys=require("node:util"),mn=ft(require("node:http"),1),_i=typeof mn.default.validateHeaderName=="function"?mn.default.validateHeaderName:e=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){let t=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},Xs=typeof mn.default.validateHeaderValue=="function"?mn.default.validateHeaderValue:(e,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let a=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(a,"code",{value:"ERR_INVALID_CHAR"}),a}},ht=class extends URLSearchParams{constructor(t){let a=[];if(t instanceof ht){let r=t.raw();for(let[n,i]of Object.entries(r))a.push(...i.map(s=>[n,s]))}else if(t!=null)if(typeof t=="object"&&!Ys.types.isBoxedPrimitive(t)){let r=t[Symbol.iterator];if(r==null)a.push(...Object.entries(t));else{if(typeof r!="function")throw new TypeError("Header pairs must be iterable");a=[...t].map(n=>{if(typeof n!="object"||Ys.types.isBoxedPrimitive(n))throw new TypeError("Each header pair must be an iterable object");return[...n]}).map(n=>{if(n.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...n]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return a=a.length>0?a.map(([r,n])=>(_i(r),Xs(r,String(n)),[String(r).toLowerCase(),String(n)])):void 0,super(a),new Proxy(this,{get(r,n,i){switch(n){case"append":case"set":return(s,u)=>(_i(s),Xs(s,String(u)),URLSearchParams.prototype[n].call(r,String(s).toLowerCase(),String(u)));case"delete":case"has":case"getAll":return s=>(_i(s),URLSearchParams.prototype[n].call(r,String(s).toLowerCase()));case"keys":return()=>(r.sort(),new Set(URLSearchParams.prototype.keys.call(r)).keys());default:return Reflect.get(r,n,i)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){let a=this.getAll(t);if(a.length===0)return null;let r=a.join(", ");return/^content-encoding$/i.test(t)&&(r=r.toLowerCase()),r}forEach(t,a=void 0){for(let r of this.keys())Reflect.apply(t,a,[this.get(r),r,this])}*values(){for(let t of this.keys())yield this.get(t)}*entries(){for(let t of this.keys())yield[t,this.get(t)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((t,a)=>(t[a]=this.getAll(a),t),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((t,a)=>{let r=this.getAll(a);return a==="host"?t[a]=r[0]:t[a]=r.length>1?r:r[0],t},{})}};Object.defineProperties(ht.prototype,["get","entries","forEach","values"].reduce((e,t)=>(e[t]={enumerable:!0},e),{}));function Vl(e=[]){return new ht(e.reduce((t,a,r,n)=>(r%2===0&&t.push(n.slice(r,r+2)),t),[]).filter(([t,a])=>{try{return _i(t),Xs(t,String(a)),!0}catch{return!1}}))}var xh=new Set([301,302,303,307,308]),Ii=e=>xh.has(e);var Wt=Symbol("Response internals"),st=class extends Zt{constructor(t=null,a={}){super(t,a);let r=a.status!=null?a.status:200,n=new ht(a.headers);if(t!==null&&!n.has("Content-Type")){let i=Ai(t,this);i&&n.append("Content-Type",i)}this[Wt]={type:"default",url:a.url,status:r,statusText:a.statusText||"",headers:n,counter:a.counter,highWaterMark:a.highWaterMark}}get type(){return this[Wt].type}get url(){return this[Wt].url||""}get status(){return this[Wt].status}get ok(){return this[Wt].status>=200&&this[Wt].status<300}get redirected(){return this[Wt].counter>0}get statusText(){return this[Wt].statusText}get headers(){return this[Wt].headers}get highWaterMark(){return this[Wt].highWaterMark}clone(){return new st(_a(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(t,a=302){if(!Ii(a))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new st(null,{headers:{location:new URL(t).toString()},status:a})}static error(){let t=new st(null,{status:0,statusText:""});return t[Wt].type="error",t}static json(t=void 0,a={}){let r=JSON.stringify(t);if(r===void 0)throw new TypeError("data is not JSON serializable");let n=new ht(a&&a.headers);return n.has("content-type")||n.set("content-type","application/json"),new st(r,{...a,headers:n})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(st.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var jl=require("node:url"),$l=require("node:util");var ql=e=>{if(e.search)return e.search;let t=e.href.length-1,a=e.hash||(e.href[t]==="#"?"#":"");return e.href[t-a.length]==="?"?"?":""};var Kl=require("node:net");function Ml(e,t=!1){return e==null||(e=new URL(e),/^(about|blob|data):$/.test(e.protocol))?"no-referrer":(e.username="",e.password="",e.hash="",t&&(e.pathname="",e.search=""),e)}var Hl=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),zl="strict-origin-when-cross-origin";function Wl(e){if(!Hl.has(e))throw new TypeError(`Invalid referrerPolicy: ${e}`);return e}function Th(e){if(/^(http|ws)s:$/.test(e.protocol))return!0;let t=e.host.replace(/(^\[)|(]$)/g,""),a=(0,Kl.isIP)(t);return a===4&&/^127\./.test(t)||a===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t)?!0:e.host==="localhost"||e.host.endsWith(".localhost")?!1:e.protocol==="file:"}function Ia(e){return/^about:(blank|srcdoc)$/.test(e)||e.protocol==="data:"||/^(blob|filesystem):$/.test(e.protocol)?!0:Th(e)}function Gl(e,{referrerURLCallback:t,referrerOriginCallback:a}={}){if(e.referrer==="no-referrer"||e.referrerPolicy==="")return null;let r=e.referrerPolicy;if(e.referrer==="about:client")return"no-referrer";let n=e.referrer,i=Ml(n),s=Ml(n,!0);i.toString().length>4096&&(i=s),t&&(i=t(i)),a&&(s=a(s));let u=new URL(e.url);switch(r){case"no-referrer":return"no-referrer";case"origin":return s;case"unsafe-url":return i;case"strict-origin":return Ia(i)&&!Ia(u)?"no-referrer":s.toString();case"strict-origin-when-cross-origin":return i.origin===u.origin?i:Ia(i)&&!Ia(u)?"no-referrer":s;case"same-origin":return i.origin===u.origin?i:"no-referrer";case"origin-when-cross-origin":return i.origin===u.origin?i:s;case"no-referrer-when-downgrade":return Ia(i)&&!Ia(u)?"no-referrer":i;default:throw new TypeError(`Invalid referrerPolicy: ${r}`)}}function Ql(e){let t=(e.get("referrer-policy")||"").split(/[,\s]+/),a="";for(let r of t)r&&Hl.has(r)&&(a=r);return a}var et=Symbol("Request internals"),vn=e=>typeof e=="object"&&typeof e[et]=="object",Ah=(0,$l.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),Cr=class extends Zt{constructor(t,a={}){let r;if(vn(t)?r=new URL(t.url):(r=new URL(t),t={}),r.username!==""||r.password!=="")throw new TypeError(`${r} is an url with embedded credentials.`);let n=a.method||t.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(n)&&(n=n.toUpperCase()),!vn(a)&&"data"in a&&Ah(),(a.body!=null||vn(t)&&t.body!==null)&&(n==="GET"||n==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let i=a.body?a.body:vn(t)&&t.body!==null?_a(t):null;super(i,{size:a.size||t.size||0});let s=new ht(a.headers||t.headers||{});if(i!==null&&!s.has("Content-Type")){let f=Ai(i,this);f&&s.set("Content-Type",f)}let u=vn(t)?t.signal:null;if("signal"in a&&(u=a.signal),u!=null&&!Bl(u))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let c=a.referrer==null?t.referrer:a.referrer;if(c==="")c="no-referrer";else if(c){let f=new URL(c);c=/^about:(\/\/)?client$/.test(f)?"client":f}else c=void 0;this[et]={method:n,redirect:a.redirect||t.redirect||"follow",headers:s,parsedURL:r,signal:u,referrer:c},this.follow=a.follow===void 0?t.follow===void 0?20:t.follow:a.follow,this.compress=a.compress===void 0?t.compress===void 0?!0:t.compress:a.compress,this.counter=a.counter||t.counter||0,this.agent=a.agent||t.agent,this.highWaterMark=a.highWaterMark||t.highWaterMark||16384,this.insecureHTTPParser=a.insecureHTTPParser||t.insecureHTTPParser||!1,this.referrerPolicy=a.referrerPolicy||t.referrerPolicy||""}get method(){return this[et].method}get url(){return(0,jl.format)(this[et].parsedURL)}get headers(){return this[et].headers}get redirect(){return this[et].redirect}get signal(){return this[et].signal}get referrer(){if(this[et].referrer==="no-referrer")return"";if(this[et].referrer==="client")return"about:client";if(this[et].referrer)return this[et].referrer.toString()}get referrerPolicy(){return this[et].referrerPolicy}set referrerPolicy(t){this[et].referrerPolicy=Wl(t)}clone(){return new Cr(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Cr.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var Yl=e=>{let{parsedURL:t}=e[et],a=new ht(e[et].headers);a.has("Accept")||a.set("Accept","*/*");let r=null;if(e.body===null&&/^(post|put)$/i.test(e.method)&&(r="0"),e.body!==null){let u=Ol(e);typeof u=="number"&&!Number.isNaN(u)&&(r=String(u))}r&&a.set("Content-Length",r),e.referrerPolicy===""&&(e.referrerPolicy=zl),e.referrer&&e.referrer!=="no-referrer"?e[et].referrer=Gl(e):e[et].referrer="no-referrer",e[et].referrer instanceof URL&&a.set("Referer",e.referrer),a.has("User-Agent")||a.set("User-Agent","node-fetch"),e.compress&&!a.has("Accept-Encoding")&&a.set("Accept-Encoding","gzip, deflate, br");let{agent:n}=e;typeof n=="function"&&(n=n(t)),!a.has("Connection")&&!n&&a.set("Connection","close");let i=ql(t),s={path:t.pathname+i,method:e.method,headers:a[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:e.insecureHTTPParser,agent:n};return{parsedURL:t,options:s}};var Bi=class extends mr{constructor(t,a="aborted"){super(t,a)}};Si();Qs();var _h=new Set(["data:","http:","https:"]);async function kr(e,t){return new Promise((a,r)=>{let n=new Cr(e,t),{parsedURL:i,options:s}=Yl(n);if(!_h.has(i.protocol))throw new TypeError(`node-fetch cannot load ${e}. URL scheme "${i.protocol.replace(/:$/,"")}" is not supported.`);if(i.protocol==="data:"){let g=Cl(n.url),_=new st(g,{headers:{"Content-Type":g.typeFull}});a(_);return}let u=(i.protocol==="https:"?Zl.default:Xl.default).request,{signal:c}=n,f=null,d=()=>{let g=new Bi("The operation was aborted.");r(g),n.body&&n.body instanceof It.default.Readable&&n.body.destroy(g),!(!f||!f.body)&&f.body.emit("error",g)};if(c&&c.aborted){d();return}let h=()=>{d(),E()},C=u(i.toString(),s);c&&c.addEventListener("abort",h);let E=()=>{C.abort(),c&&c.removeEventListener("abort",h)};C.on("error",g=>{r(new St(`request to ${n.url} failed, reason: ${g.message}`,"system",g)),E()}),Ih(C,g=>{f&&f.body&&f.body.destroy(g)}),process.version<"v14"&&C.on("socket",g=>{let _;g.prependListener("end",()=>{_=g._eventsCount}),g.prependListener("close",S=>{if(f&&_<g._eventsCount&&!S){let b=new Error("Premature close");b.code="ERR_STREAM_PREMATURE_CLOSE",f.body.emit("error",b)}})}),C.on("response",g=>{C.setTimeout(0);let _=Vl(g.rawHeaders);if(Ii(g.statusCode)){let D=_.get("Location"),k=null;try{k=D===null?null:new URL(D,n.url)}catch{if(n.redirect!=="manual"){r(new St(`uri requested responds with an invalid redirect URL: ${D}`,"invalid-redirect")),E();return}}switch(n.redirect){case"error":r(new St(`uri requested responds with a redirect, redirect mode is set to error: ${n.url}`,"no-redirect")),E();return;case"manual":break;case"follow":{if(k===null)break;if(n.counter>=n.follow){r(new St(`maximum redirect reached at: ${n.url}`,"max-redirect")),E();return}let R={headers:new ht(n.headers),follow:n.follow,counter:n.counter+1,agent:n.agent,compress:n.compress,method:n.method,body:_a(n),signal:n.signal,size:n.size,referrer:n.referrer,referrerPolicy:n.referrerPolicy};if(!wl(n.url,k)||!Rl(n.url,k))for(let q of["authorization","www-authenticate","cookie","cookie2"])R.headers.delete(q);if(g.statusCode!==303&&n.body&&t.body instanceof It.default.Readable){r(new St("Cannot follow redirect with body being a readable stream","unsupported-redirect")),E();return}(g.statusCode===303||(g.statusCode===301||g.statusCode===302)&&n.method==="POST")&&(R.method="GET",R.body=void 0,R.headers.delete("content-length"));let G=Ql(_);G&&(R.referrerPolicy=G),a(kr(new Cr(k,R))),E();return}default:return r(new TypeError(`Redirect option '${n.redirect}' is not a valid value of RequestRedirect`))}}c&&g.once("end",()=>{c.removeEventListener("abort",h)});let S=(0,It.pipeline)(g,new It.PassThrough,D=>{D&&r(D)});process.version<"v12.10"&&g.on("aborted",h);let b={url:n.url,status:g.statusCode,statusText:g.statusMessage,headers:_,size:n.size,counter:n.counter,highWaterMark:n.highWaterMark},A=_.get("Content-Encoding");if(!n.compress||n.method==="HEAD"||A===null||g.statusCode===204||g.statusCode===304){f=new st(S,b),a(f);return}let w={flush:ra.default.Z_SYNC_FLUSH,finishFlush:ra.default.Z_SYNC_FLUSH};if(A==="gzip"||A==="x-gzip"){S=(0,It.pipeline)(S,ra.default.createGunzip(w),D=>{D&&r(D)}),f=new st(S,b),a(f);return}if(A==="deflate"||A==="x-deflate"){let D=(0,It.pipeline)(g,new It.PassThrough,k=>{k&&r(k)});D.once("data",k=>{(k[0]&15)===8?S=(0,It.pipeline)(S,ra.default.createInflate(),R=>{R&&r(R)}):S=(0,It.pipeline)(S,ra.default.createInflateRaw(),R=>{R&&r(R)}),f=new st(S,b),a(f)}),D.once("end",()=>{f||(f=new st(S,b),a(f))});return}if(A==="br"){S=(0,It.pipeline)(S,ra.default.createBrotliDecompress(),D=>{D&&r(D)}),f=new st(S,b),a(f);return}f=new st(S,b),a(f)}),Fl(C,n).catch(r)})}function Ih(e,t){let a=Cn.Buffer.from(`0\r
\r
`),r=!1,n=!1,i;e.on("response",s=>{let{headers:u}=s;r=u["transfer-encoding"]==="chunked"&&!u["content-length"]}),e.on("socket",s=>{let u=()=>{if(r&&!n){let f=new Error("Premature close");f.code="ERR_STREAM_PREMATURE_CLOSE",t(f)}},c=f=>{n=Cn.Buffer.compare(f.slice(-5),a)===0,!n&&i&&(n=Cn.Buffer.compare(i.slice(-3),a.slice(0,3))===0&&Cn.Buffer.compare(f.slice(-2),a.slice(3))===0),i=f};s.prependListener("close",u),s.on("data",c),e.on("close",()=>{s.removeListener("close",u),s.removeListener("data",c)})})}var Sn="https://api.authy.com/json",En="37b312a3d682b823c439522e1fd31c82",bn=Jl.default.randomBytes(32).toString("hex");async function ef(e){let t=new Ba.URLSearchParams;t.set("api_key",En),t.set("via","push"),t.set("device_app","Raycast Authy Extension"),t.set("device_name",`Raycast Authy Extension on ${Zs.default.hostname()}`),t.set("signature",bn);let a=await kr(`${Sn}/users/${e}/devices/registration/start`,{method:"POST",body:t});if(a.ok)return await a.json();throw new Error((await a.json()).message)}async function tf(e,t){let a=new Ba.URLSearchParams;a.set("api_key",En),a.set("signature",bn),a.set("locale","en-GB");let r=await kr(`${Sn}/users/${e}/devices/registration/${t}/status?`+a,{method:"GET"});if(r.ok)return await r.json();{let n=await r.json();throw new Error(n.message)}}async function rf(e,t){let a=new Ba.URLSearchParams;a.set("pin",t),a.set("api_key",En),a.set("signature",bn),a.set("device_app","Raycast Authy Extension"),a.set("device_name",`Raycast Authy Extension on ${Zs.default.hostname()}`);let r=await kr(`${Sn}/users/${e}/devices/registration/complete`,{method:"POST",body:a});if(r.ok)return await r.json();throw new Error((await r.json()).message)}async function wi(e,t,a){let r=new Ba.URLSearchParams;r.set("api_key",En),r.set("signature",bn),r.set("device_id",`${t}`),r.set("locale","en-GB"),r.set("otp1",`${a[0]}`),r.set("otp2",`${a[1]}`),r.set("otp3",`${a[2]}`);let n=await kr(`${Sn}/users/${e}/devices/${t}/apps/sync`,{method:"POST",body:r});if(n.ok)return await n.json();throw new Error((await n.json()).message)}async function Ri(e,t,a){let r=new Ba.URLSearchParams;r.set("api_key",En),r.set("signature",bn),r.set("device_id",`${t}`),r.set("apps",""),r.set("otp1",`${a[0]}`),r.set("otp2",`${a[1]}`),r.set("otp3",`${a[2]}`);let n=await kr(`${Sn}/users/${e}/authenticator_tokens?`+r);if(n.ok)return await n.json();throw new Error((await n.json()).message)}var Ee=require("@raycast/api");var x0=ft(Li()),lr=ft(C0());var S0=require("crypto"),E0=ft(Li());function fm(e,t){let a=(0,S0.createHmac)("sha1",e),r=Buffer.alloc(8);return r.writeBigInt64BE(t),a.update(r),a.digest()}function cm(e,t){let a=e[e.length-1]&15;return(e.slice(a,a+4).readUInt32BE()&2147483647)%Math.pow(10,t)}function da(e,t){let a=t.timestamp||new Date().getTime();a=Math.floor(a/1e3/t.period);let r=E0.decode.asBytes(e.toUpperCase());return cm(fm(Buffer.from(r),BigInt(a)),t.digits).toString().padStart(t.digits,"0")}function za(e){let t=(0,x0.encode)(Buffer.from(e,"hex")),a=new Date;return[da(t,{digits:7,period:10,timestamp:a.getTime()}),da(t,{digits:7,period:10,timestamp:a.getTime()+10*1e3}),da(t,{digits:7,period:10,timestamp:a.getTime()+10*2*1e3})]}function T0(e,t,a){let r=b0(t,a,e,!1);return(r===null||!dm(r))&&(r=b0(t,a,e,!0)),r}function dm(e){return e.replace(/-|\s/g,"").match(/^[a-zA-Z2-7]+=*$/)!==null}function hm(e,t,a){return a.decodeSalt&&(t=lr.default.util.hexToBytes(t)),a.withoutEncoding?lr.default.pkcs5.pbkdf2(e,t,a.iterations,a.keySize):lr.default.pkcs5.pbkdf2(unescape(encodeURIComponent(e)),t,a.iterations,a.keySize)}function pm(e,t){let a=lr.default.util.createBuffer(lr.default.util.decodeUtf8("\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0")),r=lr.default.util.createBuffer(e),n=lr.default.util.createBuffer(lr.default.util.decode64(t)),i=lr.default.cipher.createDecipher("AES-CBC",r);return i.start({iv:a}),i.update(n),i.finish()?i.output.data:null}function b0(e,t,a,r){let n=hm(t,e,{iterations:1e3,keySize:32,decodeSalt:!1,withoutEncoding:r});return pm(n,a)}var Fn=require("react/jsx-runtime"),ym=`
## Approval request has been sent
To continue approve request at any other device and press \u23CE to continue.

![approve](file://${Ee.environment.assetsPath}/approve.png)

Or press \u2318 + \u23CE to start this process from scratch 
`;async function _0(){let e=await(0,Ee.showToast)({style:Ee.Toast.Style.Animated,title:"Authy",message:"Waiting for Approval"});try{if(!await Nt(hr)){let{authyId:a}=(0,Ee.getPreferenceValues)(),r=await ef(a);await Lt(hr,r.request_id)}}catch(t){if(t instanceof Error)await e.hide(),await(0,Ee.showToast)({style:Ee.Toast.Style.Failure,title:"Authy",message:t.message});else throw t}}async function gm(e){let t=await(0,Ee.showToast)({style:Ee.Toast.Style.Animated,title:"Checking request status"});try{let{authyId:a}=(0,Ee.getPreferenceValues)();if(!await Nt(pr)||!await Nt(yr)){let u=await Ct(hr),c=await tf(a,u);if(c.status=="rejected"&&(await t.hide(),await(0,Ee.showToast)({style:Ee.Toast.Style.Failure,title:"Authy",message:"Seems like you rejected registration request"}),await Dt(hr)),c.status=="pending")return await t.hide(),await(0,Ee.showToast)({style:Ee.Toast.Style.Failure,title:"Authy",message:"Seems like you didn't approve registration request"}),Promise.resolve();let f=await rf(a,c.pin);await Lt(pr,f.device.id),await Lt(yr,f.device.secret_seed)}let r=await Ct(pr),n=await Ct(yr),i=await wi(a,r,za(n));await Lt(Lr,i);let s=await Ri(a,r,za(n));return await Lt(Nr,s),await Lt(cn,a),e(!0),await t.hide(),await(0,Ee.showToast)({style:Ee.Toast.Style.Success,title:"Authy",message:"Success Login"}),Promise.resolve()}catch(a){if(a instanceof Error)await Dt(hr),await t.hide(),await(0,Ee.showToast)({style:Ee.Toast.Style.Failure,title:"Authy",message:a.message});else throw a}}async function mm(){await Dt(hr),await Dt(pr),await Dt(yr),await _0()}function au(e){return(0,A0.useEffect)(()=>{(async()=>await _0())()}),(0,Fn.jsx)(Ee.Detail,{markdown:`${ym}`,actions:(0,Fn.jsxs)(Ee.ActionPanel,{children:[(0,Fn.jsx)(Ee.Action.SubmitForm,{icon:Ee.Icon.Checkmark,title:"Agree",onSubmit:()=>gm(e.setLogin),shortcut:{key:"enter",modifiers:[]}}),(0,Fn.jsx)(Ee.Action,{icon:Ee.Icon.ExclamationMark,title:"Start From Scratch",onAction:mm,shortcut:{key:"enter",modifiers:["cmd"]}})]})})}var ct=require("@raycast/api"),gs=require("react");var R0=ft(Li());var ha=e=>e.trim().toLocaleLowerCase(),cs=(e,t)=>ha(e).localeCompare(ha(t)),I0=(e,t)=>t-e;var ys=require("react");var it=require("@raycast/api"),ou=ft(iu());var Ga=require("@raycast/api"),Mt=ft(iu());var vm=["logo","accountType","name"],Cm=Mt.genericColors.map(e=>`authenticator_${e.name}`);function Sm(e){if(typeof e!="string")return;let t=ha(e);if(Cm.includes(t))return`${Ga.environment.assetsPath}/${Mt.icondir}/${su}.png`;if(Mt.logos.includes(t)){let a=Mt.logoAliases[t]||t;return{source:{light:`${Ga.environment.assetsPath}/${Mt.icondir}/light/brand/${a}.png`,dark:`${Ga.environment.assetsPath}/${Mt.icondir}/dark/brand/${a}.png`}}}}function su(e){if(e===void 0)return`${Ga.environment.assetsPath}/${Mt.icondir}/authenticator_blue.png`;for(let t of vm){let a=Sm(e[t]);if(a)return a}return`${Ga.environment.assetsPath}/${Mt.icondir}/authenticator_blue.png`}var Tt=require("react/jsx-runtime"),{primaryActionIsCopy:B0,recentlyUsedOrder:Em}=(0,it.getPreferenceValues)();async function ds(e,t,a){if(Em){let r=await Nt(Zr)?new Map(await Ct(Zr)):new Map;r.set(e,Date.now()),await Lt(Zr,Array.from(r.entries())),a(n=>(n.unshift(n.splice(t,1)[0]),n))}}function bm({pin:e,id:t,index:a,setOtpList:r}){return B0?(0,Tt.jsx)(it.Action.CopyToClipboard,{title:"Copy OTP",content:e,onCopy:async()=>await ds(t,a,r)}):(0,Tt.jsx)(it.Action.Paste,{title:"Output OTP",content:e,onPaste:async()=>await ds(t,a,r)})}function xm({pin:e,id:t,index:a,setOtpList:r}){return B0?(0,Tt.jsx)(it.Action.Paste,{title:"Output OTP",content:e,onPaste:()=>ds(t,a,r)}):(0,Tt.jsx)(it.Action.CopyToClipboard,{title:"Copy OTP",content:e,onCopy:()=>ds(t,a,r)})}function uu({index:e,item:t,basis:a,timeLeft:r,refresh:n,setOtpList:i}){let s=t.generate(),u=t.issuer||t.accountType||"",c=u.match("authenticator")||!cs(u,t.name)?"":u,f=`pie-${a===30?r:r*3}`;return(0,Tt.jsx)(it.List.Item,{title:t.name,subtitle:c,icon:su(t),keywords:[u],actions:(0,Tt.jsx)(it.ActionPanel,{children:s==lu?(0,Tt.jsx)(it.Action.OpenInBrowser,{title:"Submit Issue",url:"https://github.com/raycast/extensions/issues/new/choose"}):(0,Tt.jsxs)(Tt.Fragment,{children:[(0,Tt.jsx)(bm,{pin:s??"",id:t.id,index:e,setOtpList:i}),(0,Tt.jsx)(xm,{pin:s??"",id:t.id,index:e,setOtpList:i}),(0,Tt.jsx)(it.Action,{title:"Sync",icon:it.Icon.ArrowClockwise,shortcut:{modifiers:["cmd"],key:"r"},onAction:()=>n()})]})}),accessories:[{text:`${s}`,icon:{source:{light:`${it.environment.assetsPath}/${ou.icondir}/light/${f}.png`,dark:`${it.environment.assetsPath}/${ou.icondir}/dark/${f}.png`}}}]})}var ps=require("react/jsx-runtime");function hs(e){return e-new Date().getSeconds()%e}function fu({items:e,refresh:t,setOtpList:a}){let[{timeLeft10:r,timeLeft30:n},i]=(0,ys.useState)({timeLeft10:hs(10),timeLeft30:hs(30)});return(0,ys.useEffect)(()=>{let s=setInterval(()=>new Date().getMilliseconds()<250&&i({timeLeft10:hs(10),timeLeft30:hs(30)}),250);return()=>clearInterval(s)},[]),(0,ps.jsx)(ps.Fragment,{children:e.map((s,u)=>(0,ps.jsx)(uu,{index:u,item:s,basis:s.type==="service"?30:10,timeLeft:s.type==="service"?n:r,refresh:t,setOtpList:a},u))})}var w0=require("react/jsx-runtime"),{preferCustomName:Tm}=(0,ct.getPreferenceValues)(),lu="corrupted";function N0(e){let[t,a]=(0,gs.useState)([]);async function r(){let s=await(0,ct.showToast)({style:ct.Toast.Style.Animated,title:"Authy",message:"Refreshing"});await s.show(),a([]);try{let{authyId:u}=(0,ct.getPreferenceValues)(),c=await Ct(pr),f=await Ct(yr),d=await wi(u,c,za(f));await Lt(Lr,d);let h=await Ri(u,c,za(f));await Lt(Nr,h)}catch(u){if(u instanceof Error){await(0,ct.showToast)({style:ct.Toast.Style.Failure,title:"Authy",message:u.message});return}else throw u}await n(),await s.hide(),await(0,ct.showToast)({style:ct.Toast.Style.Success,title:"Authy",message:"Data has been synced"})}async function n(){try{if(!e.isLogin)return;let s=await Ct(Nr),u=await Ct(Lr),{authyPassword:c,excludeNames:f="",recentlyUsedOrder:d}=(0,ct.getPreferenceValues)(),h=s.authenticator_tokens.map(g=>{let _=T0(g.encrypted_seed,g.salt,c);return{id:g.unique_id,type:"service",name:Tm?g.name||g.original_name:g.original_name||g.name,accountType:g.account_type,issuer:g.issuer,logo:g.logo,digits:g.digits,generate:()=>_?da(_,{digits:g.digits,period:30}):lu}}),E=[...u.apps.map(g=>({id:g._id,type:"app",name:g.name,digits:g.digits,generate:()=>da((0,R0.encode)(Buffer.from(g.secret_seed,"hex")),{digits:g.digits,period:10})})),...h];if(f){let g=f.split(",").map(ha).filter(Boolean),_=({name:S})=>!g.includes(ha(S));E=E.filter(_)}if(E=E.sort((g,_)=>cs(g.name,_.name)),d&&await Nt(Zr)){let g=new Map(await Ct(Zr));E=E.sort((_,S)=>I0(g.get(_.id)??0,g.get(S.id)??0))}a(E)}catch(s){if(s instanceof Error)await(0,ct.showToast)({style:ct.Toast.Style.Failure,title:"Authy",message:s.message});else throw s}}(0,gs.useEffect)(()=>{n()},[e.isLogin]);let i=t.length===0;return(0,w0.jsx)(ct.List,{searchBarPlaceholder:"Search",isLoading:i,children:(0,w0.jsx)(fu,{refresh:r,items:t,setOtpList:a})})}var L0=require("react/jsx-runtime");function k0(){let[e,t]=(0,Vn.useState)();return(0,Vn.useEffect)(()=>{async function a(){let r=await Nt(Nr),n=await Nt(Lr);t(r||n)}a()},[]),(0,Vn.useEffect)(()=>{async function a(){if(await Nt(cn)){let{authyId:n}=(0,D0.getPreferenceValues)(),i=await Ct(cn);n!=i&&(await Dt(yr),await Dt(pr),await Dt(Nr),await Dt(Lr),await Dt(hr),t(!1))}}a()}),e==!1?(0,L0.jsx)(au,{setLogin:t}):(0,L0.jsx)(N0,{isLogin:e,setLogin:t})}0&&(module.exports={});
/*
 * [hi-base32]{@link https://github.com/emn178/hi-base32}
 *
 * @version 0.5.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */
/*! fetch-blob. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> */
/*! formdata-polyfill. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> */
/*! node-domexception. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> */
