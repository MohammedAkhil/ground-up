"use strict";var g=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var T=Object.prototype.hasOwnProperty;var I=(t,e)=>{for(var n in e)g(t,n,{get:e[n],enumerable:!0})},k=(t,e,n,u)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of v(e))!T.call(t,o)&&o!==n&&g(t,o,{get:()=>e[o],enumerable:!(u=C(e,o))||u.enumerable});return t};var L=t=>k(g({},"__esModule",{value:!0}),t);var N={};I(N,{default:()=>w});module.exports=L(N);var i=require("@raycast/api");var a=require("@raycast/api"),c=require("node:child_process");async function p(t,e,n){e&&await(0,a.showHUD)(e),await $({menubar:!1,status:!1}),(0,c.exec)(`/usr/bin/caffeinate ${U(n)} || true`),await S(t,!0)}async function $(t,e){e&&await(0,a.showHUD)(e),(0,c.execSync)("/usr/bin/killall caffeinate || true"),await S(t,!1)}async function S(t,e){t.menubar&&await d("index",{caffeinated:e}),t.status&&await d("status",{caffeinated:e})}async function d(t,e){try{await(0,a.launchCommand)({name:t,type:a.LaunchType.Background,context:e})}catch{}}function U(t){let e=(0,a.getPreferenceValues)(),n=[];return e.preventDisplay&&n.push("d"),e.preventDisk&&n.push("m"),e.preventSystem&&n.push("i"),t&&n.push(` ${t}`),n.length>0?`-${n.join("")}`:""}async function w(t){let{time:e}=t.arguments,n=/^(\d{1,2})(?::(\d\d))? *(am|pm)?$/i;if(!n.test(e)){await(0,i.showToast)(i.Toast.Style.Failure,"Unrecognized time format");return}let[,u,o,f]=n.exec(e)??[],l=Number(u),s=l;f?.toLowerCase()=="pm"&&l<12&&(s+=12),f?.toLowerCase()=="am"&&l==12&&(s=0);let m=o?Number(o):0;if(s<0||s>24||m<0||m>59){await(0,i.showToast)(i.Toast.Style.Failure,"Unrecognized time format");return}let y=new Date,r=new Date;r.setHours(s),r.setMinutes(m),r.setSeconds(0);let D=f||s>12||u.startsWith("0");for(;r<=y;)r.setHours(r.getHours()+(D?24:12));let b=(r.getTime()-y.getTime())/1e3,h=r.toLocaleTimeString([],{timeStyle:"short"}),x=r.getDate()!=y.getDate()?"tomorrow at ":"";await p({menubar:!0,status:!0},`Caffeinating your Mac until ${x}${h}`,`-t ${b}`)}
